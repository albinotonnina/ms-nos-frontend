var requirejs,require,define;!function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var i;for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}}function eachReverse(t,e){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,function(e,r){(i||!hasProp(t,r))&&(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[r]=e:(t[r]||(t[r]={}),mixin(t[r],e,i,n)))}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,i,n){var r=new Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return r.requireType=t,r.requireModules=n,i&&(r.originalError=i),r}function newContext(t){function e(t){var e,i;for(e=0;e<t.length;e++)if(i=t[e],"."===i)t.splice(e,1),e-=1;else if(".."===i){if(0===e||1==e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}function i(t,i,n){var r,o,a,s,h,l,c,u,d,p,f,m,g=i&&i.split("/"),E=b.map,v=E&&E["*"];if(t&&(t=t.split("/"),c=t.length-1,b.nodeIdCompat&&jsSuffixRegExp.test(t[c])&&(t[c]=t[c].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&g&&(m=g.slice(0,g.length-1),t=m.concat(t)),e(t),t=t.join("/")),n&&E&&(g||v)){a=t.split("/");t:for(s=a.length;s>0;s-=1){if(l=a.slice(0,s).join("/"),g)for(h=g.length;h>0;h-=1)if(o=getOwn(E,g.slice(0,h).join("/")),o&&(o=getOwn(o,l))){u=o,d=s;break t}!p&&v&&getOwn(v,l)&&(p=getOwn(v,l),f=s)}!u&&p&&(u=p,d=f),u&&(a.splice(0,d,u),t=a.join("/"))}return r=getOwn(b.pkgs,t),r?r:t}function n(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===_.contextName?(e.parentNode.removeChild(e),!0):void 0})}function r(t){var e=getOwn(b.paths,t);return e&&isArray(e)&&e.length>1?(e.shift(),_.require.undef(t),_.makeRequire(null,{skipMap:!0})([t]),!0):void 0}function o(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function a(t,e,n,r){var a,s,h,l,c=null,u=e?e.name:null,d=t,p=!0,f="";return t||(p=!1,t="_@r"+(A+=1)),l=o(t),c=l[0],t=l[1],c&&(c=i(c,u,r),s=getOwn(S,c)),t&&(c?f=s&&s.normalize?s.normalize(t,function(t){return i(t,u,r)}):-1===t.indexOf("!")?i(t,u,r):t:(f=i(t,u,r),l=o(f),c=l[0],f=l[1],n=!0,a=_.nameToUrl(f))),h=!c||s||n?"":"_unnormalized"+(P+=1),{prefix:c,name:f,parentMap:e,unnormalized:!!h,url:a,originalName:d,isDefine:p,id:(c?c+"!"+f:f)+h}}function s(t){var e=t.id,i=getOwn(R,e);return i||(i=R[e]=new _.Module(t)),i}function h(t,e,i){var n=t.id,r=getOwn(R,n);!hasProp(S,n)||r&&!r.defineEmitComplete?(r=s(t),r.error&&"error"===e?i(r.error):r.on(e,i)):"defined"===e&&i(S[n])}function l(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,function(e){var i=getOwn(R,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))}),n||req.onError(t))}function c(){globalDefQueue.length&&(apsp.apply(M,[M.length,0].concat(globalDefQueue)),globalDefQueue=[])}function u(t){delete R[t],delete w[t]}function d(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,r){var o=n.id,a=getOwn(R,o);!a||t.depMatched[r]||i[o]||(getOwn(e,o)?(t.defineDep(r,S[o]),t.check()):d(a,e,i))}),i[n]=!0)}function p(){var t,e,i=1e3*b.waitSeconds,o=i&&_.startTime+i<(new Date).getTime(),a=[],s=[],h=!1,c=!0;if(!v){if(v=!0,eachProp(w,function(t){var i=t.map,l=i.id;if(t.enabled&&(i.isDefine||s.push(t),!t.error))if(!t.inited&&o)r(l)?(e=!0,h=!0):(a.push(l),n(l));else if(!t.inited&&t.fetched&&i.isDefine&&(h=!0,!i.prefix))return c=!1}),o&&a.length)return t=makeError("timeout","Load timeout for modules: "+a,null,a),t.contextName=_.contextName,l(t);c&&each(s,function(t){d(t,{},{})}),o&&!e||!h||!isBrowser&&!isWebWorker||x||(x=setTimeout(function(){x=0,p()},50)),v=!1}}function f(t){hasProp(S,t[0])||s(a(t[0],null,!0)).init(t[1],t[2])}function m(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function g(t){var e=t.currentTarget||t.srcElement;return m(e,_.onScriptLoad,"load","onreadystatechange"),m(e,_.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function E(){var t;for(c();M.length;){if(t=M.shift(),null===t[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var v,y,_,T,x,b={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},R={},w={},H={},M=[],S={},C={},L={},A=1,P=1;return T={require:function(t){return t.require?t.require:t.require=_.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?S[t.map.id]=t.exports:t.exports=S[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(b.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},y=function(t){this.events=getOwn(H,t.id)||{},this.map=t,this.shim=getOwn(b.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,_.startTime=(new Date).getTime();var t=this.map;return this.shim?void _.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;C[t]||(C[t]=!0,_.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,n=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=_.execCb(i,o,n,r)}catch(a){t=a}else r=_.execCb(i,o,n,r);if(this.map.isDefine&&void 0===r&&(e=this.module,e?r=e.exports:this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",l(this.error=t)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(S[i]=r,req.onResourceLoad&&req.onResourceLoad(_,this.map,this.depMaps)),u(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=a(t.prefix);this.depMaps.push(n),h(n,"defined",bind(this,function(n){var r,o,c,d=getOwn(L,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,m=_.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(t){return i(t,f,!0)})||""),o=a(t.prefix+"!"+p,this.map.parentMap),h(o,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),c=getOwn(R,o.id),void(c&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(t){this.emit("error",t)})),c.enable()))):d?(this.map.url=_.nameToUrl(d),void this.load()):(r=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),r.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(R,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&u(t.map.id)}),l(t)}),r.fromText=bind(this,function(i,n){var o=t.name,h=a(o),c=useInteractive;n&&(i=n),c&&(useInteractive=!1),s(h),hasProp(b.config,e)&&(b.config[o]=b.config[e]);try{req.exec(i)}catch(u){return l(makeError("fromtexteval","fromText eval for "+e+" failed: "+u,u,[e]))}c&&(useInteractive=!0),this.depMaps.push(h),_.completeLoad(o),m([o],r)}),void n.load(t.name,m,r,b))})),_.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){w[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var i,n,r;if("string"==typeof t){if(t=a(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,r=getOwn(T,t.id))return void(this.depExports[e]=r(this));this.depCount+=1,h(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&h(t,"error",bind(this,this.errback))}i=t.id,n=R[i],hasProp(T,i)||!n||n.enabled||_.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(R,t.id);e&&!e.enabled&&_.enable(t,this)})),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},_={config:b,contextName:t,registry:R,defined:S,urlFetched:C,defQueue:M,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:l,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=b.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,function(t,e){i[e]?(b[e]||(b[e]={}),mixin(b[e],t,!0,!0)):b[e]=t}),t.bundles&&eachProp(t.bundles,function(t,e){each(t,function(t){t!==e&&(L[t]=e)})}),t.shim&&(eachProp(t.shim,function(t,i){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=_.makeShimExports(t)),e[i]=t}),b.shim=e),t.packages&&each(t.packages,function(t){var e,i;t="string"==typeof t?{name:t}:t,i=t.name,e=t.location,e&&(b.paths[i]=t.location),b.pkgs[i]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(R,function(t,e){t.inited||t.map.unnormalized||(t.map=a(e))}),(t.deps||t.callback)&&_.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,r){function o(i,n,h){var c,u,d;return r.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),h):e&&hasProp(T,i)?T[i](R[e.id]):req.get?req.get(_,i,e,o):(u=a(i,e,!1,!0),c=u.id,hasProp(S,c)?S[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(E(),_.nextTick(function(){E(),d=s(a(null,e)),d.skipMap=r.skipMap,d.init(i,n,h,{enabled:!0}),p()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(t){var n,r=t.lastIndexOf("."),o=t.split("/")[0],a="."===o||".."===o;return-1!==r&&(!a||r>1)&&(n=t.substring(r,t.length),t=t.substring(0,r)),_.nameToUrl(i(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(S,a(t,e,!1,!0).id)},specified:function(t){return t=a(t,e,!1,!0).id,hasProp(S,t)||hasProp(R,t)}}),e||(o.undef=function(t){c();var i=a(t,e,!0),r=getOwn(R,t);n(t),delete S[t],delete C[i.url],delete H[t],eachReverse(M,function(e,i){e[0]===t&&M.splice(i,1)}),r&&(r.events.defined&&(H[t]=r.events),u(t))}),o},enable:function(t){var e=getOwn(R,t.id);e&&s(t).enable()},completeLoad:function(t){var e,i,n,o=getOwn(b.shim,t)||{},a=o.exports;for(c();M.length;){if(i=M.shift(),null===i[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);f(i)}if(n=getOwn(R,t),!e&&!hasProp(S,t)&&n&&!n.inited){if(!(!b.enforceDefine||a&&getGlobal(a)))return r(t)?void 0:l(makeError("nodefine","No define call for "+t,null,[t]));f([t,o.deps||[],o.exportsFn])}p()},nameToUrl:function(t,e,i){var n,r,o,a,s,h,l,c=getOwn(b.pkgs,t);if(c&&(t=c),l=getOwn(L,t))return _.nameToUrl(l,e,i);if(req.jsExtRegExp.test(t))s=t+(e||"");else{for(n=b.paths,r=t.split("/"),o=r.length;o>0;o-=1)if(a=r.slice(0,o).join("/"),h=getOwn(n,a)){isArray(h)&&(h=h[0]),r.splice(0,o,h);break}s=r.join("/"),s+=e||(/^data\:|\?/.test(s)||i?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":b.baseUrl)+s}return b.urlArgs?s+((-1===s.indexOf("?")?"?":"&")+b.urlArgs):s},load:function(t,e){req.load(_,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=g(t);_.completeLoad(e.id)}},onScriptError:function(t){var e=g(t);return r(e.id)?void 0:l(makeError("scripterror","Script error for: "+e.id,t,[e.id]))}},_.require=_.makeRequire(),_}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.14",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var r,o,a=defContextName;return isArray(t)||"string"==typeof t||(o=t,isArray(e)?(t=e,e=i,i=n):t=[]),o&&o.context&&(a=o.context),r=getOwn(contexts,a),r||(r=contexts[a]=req.s.newContext(a)),o&&r.configure(o),r.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t){var e=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return e.type=t.scriptType||"text/javascript",e.charset="utf-8",e.async=!0,e},req.load=function(t,e,i){var n,r=t&&t.config||{};if(isBrowser)return n=req.createNode(r,e,i),n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(i),t.completeLoad(e)}catch(o){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,o,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(t,e,i){var n,r;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,i){e.push(i)}),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(t||(t=n.getAttribute("data-requiremodule")),r=contexts[n.getAttribute("data-requirecontext")])),(r?r.defQueue:globalDefQueue).push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("../bower_components/requirejs/require",function(){}),function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,o=Function.prototype,a=n.push,s=n.slice,h=n.concat,l=r.toString,c=r.hasOwnProperty,u=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,E=n.some,v=n.indexOf,y=n.lastIndexOf,_=Array.isArray,T=Object.keys,x=o.bind,b=function(t){return t instanceof b?t:this instanceof b?void(this._wrapped=t):new b(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports._=b):t._=b,b.VERSION="1.6.0";var R=b.each=b.forEach=function(t,e,n){if(null==t)return t;if(u&&t.forEach===u)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,o=t.length;o>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var a=b.keys(t),r=0,o=a.length;o>r;r++)if(e.call(n,t[a[r]],a[r],t)===i)return;return t};b.map=b.collect=function(t,e,i){var n=[];return null==t?n:d&&t.map===d?t.map(e,i):(R(t,function(t,r,o){n.push(e.call(i,t,r,o))}),n)};var w="Reduce of empty array with no initial value";b.reduce=b.foldl=b.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return n&&(e=b.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(R(t,function(t,o,a){r?i=e.call(n,i,t,o,a):(i=t,r=!0)}),!r)throw new TypeError(w);return i},b.reduceRight=b.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=b.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var o=t.length;if(o!==+o){var a=b.keys(t);o=a.length}if(R(t,function(s,h,l){h=a?a[--o]:--o,r?i=e.call(n,i,t[h],h,l):(i=t[h],r=!0)}),!r)throw new TypeError(w);return i},b.find=b.detect=function(t,e,i){var n;return H(t,function(t,r,o){return e.call(i,t,r,o)?(n=t,!0):void 0}),n},b.filter=b.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(R(t,function(t,r,o){e.call(i,t,r,o)&&n.push(t)}),n)},b.reject=function(t,e,i){return b.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},b.every=b.all=function(t,e,n){e||(e=b.identity);var r=!0;return null==t?r:g&&t.every===g?t.every(e,n):(R(t,function(t,o,a){return(r=r&&e.call(n,t,o,a))?void 0:i}),!!r)};var H=b.some=b.any=function(t,e,n){e||(e=b.identity);var r=!1;return null==t?r:E&&t.some===E?t.some(e,n):(R(t,function(t,o,a){return r||(r=e.call(n,t,o,a))?i:void 0}),!!r)};b.contains=b.include=function(t,e){return null==t?!1:v&&t.indexOf===v?-1!=t.indexOf(e):H(t,function(t){return t===e})},b.invoke=function(t,e){var i=s.call(arguments,2),n=b.isFunction(e);return b.map(t,function(t){return(n?e:t[e]).apply(t,i)})},b.pluck=function(t,e){return b.map(t,b.property(e))},b.where=function(t,e){return b.filter(t,b.matches(e))},b.findWhere=function(t,e){return b.find(t,b.matches(e))},b.max=function(t,e,i){if(!e&&b.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var n=-1/0,r=-1/0;return R(t,function(t,o,a){var s=e?e.call(i,t,o,a):t;s>r&&(n=t,r=s)}),n},b.min=function(t,e,i){if(!e&&b.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var n=1/0,r=1/0;return R(t,function(t,o,a){var s=e?e.call(i,t,o,a):t;r>s&&(n=t,r=s)}),n},b.shuffle=function(t){var e,i=0,n=[];return R(t,function(t){e=b.random(i++),n[i-1]=n[e],n[e]=t}),n},b.sample=function(t,e,i){return null==e||i?(t.length!==+t.length&&(t=b.values(t)),t[b.random(t.length-1)]):b.shuffle(t).slice(0,Math.max(0,e))};var M=function(t){return null==t?b.identity:b.isFunction(t)?t:b.property(t)};b.sortBy=function(t,e,i){return e=M(e),b.pluck(b.map(t,function(t,n,r){return{value:t,index:n,criteria:e.call(i,t,n,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var S=function(t){return function(e,i,n){var r={};return i=M(i),R(e,function(o,a){var s=i.call(n,o,a,e);t(r,s,o)}),r}};b.groupBy=S(function(t,e,i){b.has(t,e)?t[e].push(i):t[e]=[i]}),b.indexBy=S(function(t,e,i){t[e]=i}),b.countBy=S(function(t,e){b.has(t,e)?t[e]++:t[e]=1}),b.sortedIndex=function(t,e,i,n){i=M(i);for(var r=i.call(n,e),o=0,a=t.length;a>o;){var s=o+a>>>1;i.call(n,t[s])<r?o=s+1:a=s}return o},b.toArray=function(t){return t?b.isArray(t)?s.call(t):t.length===+t.length?b.map(t,b.identity):b.values(t):[]},b.size=function(t){return null==t?0:t.length===+t.length?t.length:b.keys(t).length},b.first=b.head=b.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:0>e?[]:s.call(t,0,e)},b.initial=function(t,e,i){return s.call(t,0,t.length-(null==e||i?1:e))},b.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},b.rest=b.tail=b.drop=function(t,e,i){return s.call(t,null==e||i?1:e)},b.compact=function(t){return b.filter(t,b.identity)};var C=function(t,e,i){return e&&b.every(t,b.isArray)?h.apply(i,t):(R(t,function(t){b.isArray(t)||b.isArguments(t)?e?a.apply(i,t):C(t,e,i):i.push(t)}),i)};b.flatten=function(t,e){return C(t,e,[])},b.without=function(t){return b.difference(t,s.call(arguments,1))},b.partition=function(t,e){var i=[],n=[];return R(t,function(t){(e(t)?i:n).push(t)}),[i,n]},b.uniq=b.unique=function(t,e,i,n){b.isFunction(e)&&(n=i,i=e,e=!1);var r=i?b.map(t,i,n):t,o=[],a=[];return R(r,function(i,n){(e?n&&a[a.length-1]===i:b.contains(a,i))||(a.push(i),o.push(t[n]))}),o},b.union=function(){return b.uniq(b.flatten(arguments,!0))},b.intersection=function(t){var e=s.call(arguments,1);return b.filter(b.uniq(t),function(t){return b.every(e,function(e){return b.contains(e,t)})})},b.difference=function(t){var e=h.apply(n,s.call(arguments,1));return b.filter(t,function(t){return!b.contains(e,t)})},b.zip=function(){for(var t=b.max(b.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=b.pluck(arguments,""+i);return e},b.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},b.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=b.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(v&&t.indexOf===v)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},b.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(y&&t.lastIndexOf===y)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},b.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,o=new Array(n);n>r;)o[r++]=t,t+=i;return o};var L=function(){};b.bind=function(t,e){var i,n;if(x&&t.bind===x)return x.apply(t,s.call(arguments,1));if(!b.isFunction(t))throw new TypeError;return i=s.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(s.call(arguments)));L.prototype=t.prototype;var r=new L;L.prototype=null;var o=t.apply(r,i.concat(s.call(arguments)));return Object(o)===o?o:r}},b.partial=function(t){var e=s.call(arguments,1);return function(){for(var i=0,n=e.slice(),r=0,o=n.length;o>r;r++)n[r]===b&&(n[r]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return t.apply(this,n)}},b.bindAll=function(t){var e=s.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return R(e,function(e){t[e]=b.bind(t[e],t)}),t},b.memoize=function(t,e){var i={};return e||(e=b.identity),function(){var n=e.apply(this,arguments);return b.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},b.delay=function(t,e){var i=s.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},b.defer=function(t){return b.delay.apply(b,[t,1].concat(s.call(arguments,1)))},b.throttle=function(t,e,i){var n,r,o,a=null,s=0;i||(i={});var h=function(){s=i.leading===!1?0:b.now(),a=null,o=t.apply(n,r),n=r=null};return function(){var l=b.now();s||i.leading!==!1||(s=l);var c=e-(l-s);return n=this,r=arguments,0>=c?(clearTimeout(a),a=null,s=l,o=t.apply(n,r),n=r=null):a||i.trailing===!1||(a=setTimeout(h,c)),o}},b.debounce=function(t,e,i){var n,r,o,a,s,h=function(){var l=b.now()-a;e>l?n=setTimeout(h,e-l):(n=null,i||(s=t.apply(o,r),o=r=null))};return function(){o=this,r=arguments,a=b.now();var l=i&&!n;return n||(n=setTimeout(h,e)),l&&(s=t.apply(o,r),o=r=null),s}},b.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},b.wrap=function(t,e){return b.partial(e,t)},b.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},b.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},b.keys=function(t){if(!b.isObject(t))return[];if(T)return T(t);var e=[];for(var i in t)b.has(t,i)&&e.push(i);return e},b.values=function(t){for(var e=b.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},b.pairs=function(t){for(var e=b.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},b.invert=function(t){for(var e={},i=b.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},b.functions=b.methods=function(t){var e=[];for(var i in t)b.isFunction(t[i])&&e.push(i);return e.sort()},b.extend=function(t){return R(s.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},b.pick=function(t){var e={},i=h.apply(n,s.call(arguments,1));return R(i,function(i){i in t&&(e[i]=t[i])}),e},b.omit=function(t){var e={},i=h.apply(n,s.call(arguments,1));for(var r in t)b.contains(i,r)||(e[r]=t[r]);return e},b.defaults=function(t){return R(s.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},b.clone=function(t){return b.isObject(t)?b.isArray(t)?t.slice():b.extend({},t):t},b.tap=function(t,e){return e(t),t};var A=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof b&&(t=t._wrapped),e instanceof b&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=i.length;o--;)if(i[o]==t)return n[o]==e;var a=t.constructor,s=e.constructor;if(a!==s&&!(b.isFunction(a)&&a instanceof a&&b.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1;i.push(t),n.push(e);var h=0,c=!0;if("[object Array]"==r){if(h=t.length,c=h==e.length)for(;h--&&(c=A(t[h],e[h],i,n)););}else{for(var u in t)if(b.has(t,u)&&(h++,!(c=b.has(e,u)&&A(t[u],e[u],i,n))))break;if(c){for(u in e)if(b.has(e,u)&&!h--)break;c=!h}}return i.pop(),n.pop(),c};b.isEqual=function(t,e){return A(t,e,[],[])},b.isEmpty=function(t){if(null==t)return!0;if(b.isArray(t)||b.isString(t))return 0===t.length;for(var e in t)if(b.has(t,e))return!1;return!0},b.isElement=function(t){return!(!t||1!==t.nodeType)},b.isArray=_||function(t){return"[object Array]"==l.call(t)},b.isObject=function(t){return t===Object(t)},R(["Arguments","Function","String","Number","Date","RegExp"],function(t){b["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),b.isArguments(arguments)||(b.isArguments=function(t){return!(!t||!b.has(t,"callee"))}),"function"!=typeof/./&&(b.isFunction=function(t){return"function"==typeof t}),b.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},b.isNaN=function(t){return b.isNumber(t)&&t!=+t},b.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},b.isNull=function(t){return null===t},b.isUndefined=function(t){return void 0===t},b.has=function(t,e){return c.call(t,e)},b.noConflict=function(){return t._=e,this},b.identity=function(t){return t},b.constant=function(t){return function(){return t}},b.property=function(t){return function(e){return e[t]}},b.matches=function(t){return function(e){if(e===t)return!0;for(var i in t)if(t[i]!==e[i])return!1;return!0}},b.times=function(t,e,i){for(var n=Array(Math.max(0,t)),r=0;t>r;r++)n[r]=e.call(i,r);return n},b.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},b.now=Date.now||function(){return(new Date).getTime()};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=b.invert(P.escape);var k={escape:new RegExp("["+b.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+b.keys(P.unescape).join("|")+")","g")};b.each(["escape","unescape"],function(t){b[t]=function(e){return null==e?"":(""+e).replace(k[t],function(e){return P[t][e]})}}),b.result=function(t,e){if(null==t)return void 0;var i=t[e];return b.isFunction(i)?i.call(t):i},b.mixin=function(t){R(b.functions(t),function(e){var i=b[e]=t[e];b.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),U.call(this,i.apply(b,t))}})};var D=0;b.uniqueId=function(t){var e=++D+"";return t?t+e:e},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;b.template=function(t,e,i){var n;i=b.defaults({},i,b.templateSettings);var r=new RegExp([(i.escape||O).source,(i.interpolate||O).source,(i.evaluate||O).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,function(e,i,n,r,s){return a+=t.slice(o,s).replace(N,function(t){return"\\"+B[t]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),o=s+e.length,e}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(e)return n(e,b);var h=function(t){return n.call(this,t,b)};return h.source="function("+(i.variable||"obj")+"){\n"+a+"}",h},b.chain=function(t){return b(t).chain()};var U=function(t){return this._chain?b(t).chain():t};b.mixin(b),R(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];b.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],U.call(this,i)}}),R(["concat","join","slice"],function(t){var e=n[t];b.prototype[t]=function(){return U.call(this,e.apply(this._wrapped,arguments))}}),b.extend(b.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return b})}.call(this),function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=oe.type(t);return"function"===i||oe.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function n(t,e,i){if(oe.isFunction(e))return oe.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return oe.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(pe.test(e))return oe.filter(e,t,i);e=oe.filter(e,t)}return oe.grep(t,function(t){return oe.inArray(t,e)>=0!==i
})}function r(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function o(t){var e=Te[t]={};return oe.each(t.match(_e)||[],function(t,i){e[i]=!0}),e}function a(){me.addEventListener?(me.removeEventListener("DOMContentLoaded",s,!1),t.removeEventListener("load",s,!1)):(me.detachEvent("onreadystatechange",s),t.detachEvent("onload",s))}function s(){(me.addEventListener||"load"===event.type||"complete"===me.readyState)&&(a(),oe.ready())}function h(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(He,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:we.test(i)?oe.parseJSON(i):i}catch(r){}oe.data(t,e,i)}else i=void 0}return i}function l(t){var e;for(e in t)if(("data"!==e||!oe.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function c(t,e,i,n){if(oe.acceptData(t)){var r,o,a=oe.expando,s=t.nodeType,h=s?oe.cache:t,l=s?t[a]:t[a]&&a;if(l&&h[l]&&(n||h[l].data)||void 0!==i||"string"!=typeof e)return l||(l=s?t[a]=Y.pop()||oe.guid++:a),h[l]||(h[l]=s?{}:{toJSON:oe.noop}),("object"==typeof e||"function"==typeof e)&&(n?h[l]=oe.extend(h[l],e):h[l].data=oe.extend(h[l].data,e)),o=h[l],n||(o.data||(o.data={}),o=o.data),void 0!==i&&(o[oe.camelCase(e)]=i),"string"==typeof e?(r=o[e],null==r&&(r=o[oe.camelCase(e)])):r=o,r}}function u(t,e,i){if(oe.acceptData(t)){var n,r,o=t.nodeType,a=o?oe.cache:t,s=o?t[oe.expando]:oe.expando;if(a[s]){if(e&&(n=i?a[s]:a[s].data)){oe.isArray(e)?e=e.concat(oe.map(e,oe.camelCase)):e in n?e=[e]:(e=oe.camelCase(e),e=e in n?[e]:e.split(" ")),r=e.length;for(;r--;)delete n[e[r]];if(i?!l(n):!oe.isEmptyObject(n))return}(i||(delete a[s].data,l(a[s])))&&(o?oe.cleanData([t],!0):ne.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function d(){return!0}function p(){return!1}function f(){try{return me.activeElement}catch(t){}}function m(t){var e=Ne.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function g(t,e){var i,n,r=0,o=typeof t.getElementsByTagName!==Re?t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!==Re?t.querySelectorAll(e||"*"):void 0;if(!o)for(o=[],i=t.childNodes||t;null!=(n=i[r]);r++)!e||oe.nodeName(n,e)?o.push(n):oe.merge(o,g(n,e));return void 0===e||e&&oe.nodeName(t,e)?oe.merge([t],o):o}function E(t){Ae.test(t.type)&&(t.defaultChecked=t.checked)}function v(t,e){return oe.nodeName(t,"table")&&oe.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function y(t){return t.type=(null!==oe.find.attr(t,"type"))+"/"+t.type,t}function _(t){var e=Ye.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function T(t,e){for(var i,n=0;null!=(i=t[n]);n++)oe._data(i,"globalEval",!e||oe._data(e[n],"globalEval"))}function x(t,e){if(1===e.nodeType&&oe.hasData(t)){var i,n,r,o=oe._data(t),a=oe._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(i in s)for(n=0,r=s[i].length;r>n;n++)oe.event.add(e,i,s[i][n])}a.data&&(a.data=oe.extend({},a.data))}}function b(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ne.noCloneEvent&&e[oe.expando]){r=oe._data(e);for(n in r.events)oe.removeEvent(e,n,r.handle);e.removeAttribute(oe.expando)}"script"===i&&e.text!==t.text?(y(e).text=t.text,_(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ne.html5Clone&&t.innerHTML&&!oe.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&Ae.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function R(e,i){var n=oe(i.createElement(e)).appendTo(i.body),r=t.getDefaultComputedStyle?t.getDefaultComputedStyle(n[0]).display:oe.css(n[0],"display");return n.detach(),r}function w(t){var e=me,i=ti[t];return i||(i=R(t,e),"none"!==i&&i||(Qe=(Qe||oe("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(Qe[0].contentWindow||Qe[0].contentDocument).document,e.write(),e.close(),i=R(t,e),Qe.detach()),ti[t]=i),i}function H(t,e){return{get:function(){var i=t();if(null!=i)return i?void delete this.get:(this.get=e).apply(this,arguments)}}}function M(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=pi.length;r--;)if(e=pi[r]+i,e in t)return e;return n}function S(t,e){for(var i,n,r,o=[],a=0,s=t.length;s>a;a++)n=t[a],n.style&&(o[a]=oe._data(n,"olddisplay"),i=n.style.display,e?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ce(n)&&(o[a]=oe._data(n,"olddisplay",w(n.nodeName)))):o[a]||(r=Ce(n),(i&&"none"!==i||!r)&&oe._data(n,"olddisplay",r?i:oe.css(n,"display"))));for(a=0;s>a;a++)n=t[a],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[a]||"":"none"));return t}function C(t,e,i){var n=li.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function L(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=oe.css(t,i+Se[o],!0,r)),n?("content"===i&&(a-=oe.css(t,"padding"+Se[o],!0,r)),"margin"!==i&&(a-=oe.css(t,"border"+Se[o]+"Width",!0,r))):(a+=oe.css(t,"padding"+Se[o],!0,r),"padding"!==i&&(a+=oe.css(t,"border"+Se[o]+"Width",!0,r)));return a}function A(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=ei(t),a=ne.boxSizing()&&"border-box"===oe.css(t,"boxSizing",!1,o);if(0>=r||null==r){if(r=ii(t,e,o),(0>r||null==r)&&(r=t.style[e]),ri.test(r))return r;n=a&&(ne.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+L(t,e,i||(a?"border":"content"),n,o)+"px"}function P(t,e,i,n,r){return new P.prototype.init(t,e,i,n,r)}function k(){return setTimeout(function(){fi=void 0}),fi=oe.now()}function D(t,e){var i,n={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)i=Se[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function O(t,e,i){for(var n,r=(_i[e]||[]).concat(_i["*"]),o=0,a=r.length;a>o;o++)if(n=r[o].call(i,e,t))return n}function B(t,e,i){var n,r,o,a,s,h,l,c,u=this,d={},p=t.style,f=t.nodeType&&Ce(t),m=oe._data(t,"fxshow");i.queue||(s=oe._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,h=s.empty.fire,s.empty.fire=function(){s.unqueued||h()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,oe.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],l=oe.css(t,"display"),c=w(t.nodeName),"none"===l&&(l=c),"inline"===l&&"none"===oe.css(t,"float")&&(ne.inlineBlockNeedsLayout&&"inline"!==c?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",ne.shrinkWrapBlocks()||u.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],gi.exec(r)){if(delete e[n],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;f=!0}d[n]=m&&m[n]||oe.style(t,n)}if(!oe.isEmptyObject(d)){m?"hidden"in m&&(f=m.hidden):m=oe._data(t,"fxshow",{}),o&&(m.hidden=!f),f?oe(t).show():u.done(function(){oe(t).hide()}),u.done(function(){var e;oe._removeData(t,"fxshow");for(e in d)oe.style(t,e,d[e])});for(n in d)a=O(f?m[n]:0,n,u),n in m||(m[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function N(t,e){var i,n,r,o,a;for(i in t)if(n=oe.camelCase(i),r=e[n],o=t[i],oe.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),a=oe.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function U(t,e,i){var n,r,o=0,a=yi.length,s=oe.Deferred().always(function(){delete h.elem}),h=function(){if(r)return!1;for(var e=fi||k(),i=Math.max(0,l.startTime+l.duration-e),n=i/l.duration||0,o=1-n,a=0,h=l.tweens.length;h>a;a++)l.tweens[a].run(o);return s.notifyWith(t,[l,o,i]),1>o&&h?i:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:oe.extend({},e),opts:oe.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:fi||k(),duration:i.duration,tweens:[],createTween:function(e,i){var n=oe.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)l.tweens[i].run(1);return e?s.resolveWith(t,[l,e]):s.rejectWith(t,[l,e]),this}}),c=l.props;for(N(c,l.opts.specialEasing);a>o;o++)if(n=yi[o].call(l,t,c,l.opts))return n;return oe.map(c,O,l),oe.isFunction(l.opts.start)&&l.opts.start.call(t,l),oe.fx.timer(oe.extend(h,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function F(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(_e)||[];if(oe.isFunction(i))for(;n=o[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function V(t,e,i,n){function r(s){var h;return o[s]=!0,oe.each(t[s]||[],function(t,s){var l=s(e,i,n);return"string"!=typeof l||a||o[l]?a?!(h=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),h}var o={},a=t===Gi;return r(e.dataTypes[0])||!o["*"]&&r("*")}function z(t,e){var i,n,r=oe.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&oe.extend(!0,t,i),t}function I(t,e,i){for(var n,r,o,a,s=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){h.unshift(a);break}if(h[0]in i)o=h[0];else{for(a in i){if(!h[0]||t.converters[a+" "+h[0]]){o=a;break}n||(n=a)}o=o||n}return o?(o!==h[0]&&h.unshift(o),i[o]):void 0}function j(t,e,i,n){var r,o,a,s,h,l={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!h&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=o,o=c.shift())if("*"===o)o=h;else if("*"!==h&&h!==o){if(a=l[h+" "+o]||l["* "+o],!a)for(r in l)if(s=r.split(" "),s[1]===o&&(a=l[h+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[r]:l[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+h+" to "+o}}}return{state:"success",data:e}}function G(t,e,i,n){var r;if(oe.isArray(e))oe.each(e,function(e,r){i||Yi.test(t)?n(t,r):G(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==oe.type(e))n(t,e);else for(r in e)G(t+"["+r+"]",e[r],i,n)}function W(){try{return new t.XMLHttpRequest}catch(e){}}function q(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function X(t){return oe.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var Y=[],$=Y.slice,Z=Y.concat,K=Y.push,J=Y.indexOf,Q={},te=Q.toString,ee=Q.hasOwnProperty,ie="".trim,ne={},re="1.11.0",oe=function(t,e){return new oe.fn.init(t,e)},ae=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,se=/^-ms-/,he=/-([\da-z])/gi,le=function(t,e){return e.toUpperCase()};oe.fn=oe.prototype={jquery:re,constructor:oe,selector:"",length:0,toArray:function(){return $.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:$.call(this)},pushStack:function(t){var e=oe.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return oe.each(this,t,e)},map:function(t){return this.pushStack(oe.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack($.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:Y.sort,splice:Y.splice},oe.extend=oe.fn.extend=function(){var t,e,i,n,r,o,a=arguments[0]||{},s=1,h=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||oe.isFunction(a)||(a={}),s===h&&(a=this,s--);h>s;s++)if(null!=(r=arguments[s]))for(n in r)t=a[n],i=r[n],a!==i&&(l&&i&&(oe.isPlainObject(i)||(e=oe.isArray(i)))?(e?(e=!1,o=t&&oe.isArray(t)?t:[]):o=t&&oe.isPlainObject(t)?t:{},a[n]=oe.extend(l,o,i)):void 0!==i&&(a[n]=i));return a},oe.extend({expando:"jQuery"+(re+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===oe.type(t)},isArray:Array.isArray||function(t){return"array"===oe.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return t-parseFloat(t)>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==oe.type(t)||t.nodeType||oe.isWindow(t))return!1;try{if(t.constructor&&!ee.call(t,"constructor")&&!ee.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ne.ownLast)for(e in t)return ee.call(t,e);for(e in t);return void 0===e||ee.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Q[te.call(t)]||"object":typeof t},globalEval:function(e){e&&oe.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(se,"ms-").replace(he,le)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r,o=0,a=t.length,s=i(t);if(n){if(s)for(;a>o&&(r=e.apply(t[o],n),r!==!1);o++);else for(o in t)if(r=e.apply(t[o],n),r===!1)break}else if(s)for(;a>o&&(r=e.call(t[o],o,t[o]),r!==!1);o++);else for(o in t)if(r=e.call(t[o],o,t[o]),r===!1)break;return t},trim:ie&&!ie.call("﻿ ")?function(t){return null==t?"":ie.call(t)}:function(t){return null==t?"":(t+"").replace(ae,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?oe.merge(n,"string"==typeof t?[t]:t):K.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(J)return J.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;i>n;)t[r++]=e[n++];if(i!==i)for(;void 0!==e[n];)t[r++]=e[n++];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],o=0,a=t.length,s=!i;a>o;o++)n=!e(t[o],o),n!==s&&r.push(t[o]);return r},map:function(t,e,n){var r,o=0,a=t.length,s=i(t),h=[];if(s)for(;a>o;o++)r=e(t[o],o,n),null!=r&&h.push(r);else for(o in t)r=e(t[o],o,n),null!=r&&h.push(r);return Z.apply([],h)},guid:1,proxy:function(t,e){var i,n,r;return"string"==typeof e&&(r=t[e],e=t,t=r),oe.isFunction(t)?(i=$.call(arguments,2),n=function(){return t.apply(e||this,i.concat($.call(arguments)))},n.guid=t.guid=t.guid||oe.guid++,n):void 0},now:function(){return+new Date},support:ne}),oe.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Q["[object "+e+"]"]=e.toLowerCase()});var ce=function(t){function e(t,e,i,n){var r,o,a,s,h,l,u,f,m,g;if((e?e.ownerDocument||e:V)!==P&&A(e),e=e||P,i=i||[],!t||"string"!=typeof t)return i;if(1!==(s=e.nodeType)&&9!==s)return[];if(D&&!n){if(r=ve.exec(t))if(a=r[1]){if(9===s){if(o=e.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&U(e,o)&&o.id===a)return i.push(o),i}else{if(r[2])return Q.apply(i,e.getElementsByTagName(t)),i;if((a=r[3])&&b.getElementsByClassName&&e.getElementsByClassName)return Q.apply(i,e.getElementsByClassName(a)),i}if(b.qsa&&(!O||!O.test(t))){if(f=u=F,m=e,g=9===s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(l=d(t),(u=e.getAttribute("id"))?f=u.replace(_e,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",h=l.length;h--;)l[h]=f+p(l[h]);m=ye.test(t)&&c(e.parentNode)||e,g=l.join(",")}if(g)try{return Q.apply(i,m.querySelectorAll(g)),i}catch(E){}finally{u||e.removeAttribute("id")}}}return T(t.replace(he,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>R.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[F]=!0,t}function r(t){var e=P.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)R.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function s(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function h(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}function c(t){return t&&typeof t.getElementsByTagName!==X&&t}function u(){}function d(t,i){var n,r,o,a,s,h,l,c=G[t+" "];if(c)return i?0:c.slice(0);for(s=t,h=[],l=R.preFilter;s;){(!n||(r=le.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),h.push(o=[])),n=!1,(r=ce.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(he," ")}),s=s.slice(n.length));for(a in R.filter)!(r=fe[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return i?s.length:s?e.error(t):G(t,h).slice(0)}function p(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,r=i&&"parentNode"===n,o=I++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o)}:function(e,i,a){var s,h,l=[z,o];if(a){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(h=e[F]||(e[F]={}),(s=h[n])&&s[0]===z&&s[1]===o)return l[2]=s[2];if(h[n]=l,l[2]=t(e,i,a))return!0}}}function m(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function g(t,e,i,n,r){for(var o,a=[],s=0,h=t.length,l=null!=e;h>s;s++)(o=t[s])&&(!i||i(o,n,r))&&(a.push(o),l&&e.push(s));return a}function E(t,e,i,r,o,a){return r&&!r[F]&&(r=E(r)),o&&!o[F]&&(o=E(o,a)),n(function(n,a,s,h){var l,c,u,d=[],p=[],f=a.length,m=n||_(e||"*",s.nodeType?[s]:s,[]),E=!t||!n&&e?m:g(m,d,t,s,h),v=i?o||(n?t:f||r)?[]:a:E;if(i&&i(E,v,s,h),r)for(l=g(v,p),r(l,[],s,h),c=l.length;c--;)(u=l[c])&&(v[p[c]]=!(E[p[c]]=u));if(n){if(o||t){if(o){for(l=[],c=v.length;c--;)(u=v[c])&&l.push(E[c]=u);o(null,v=[],l,h)}for(c=v.length;c--;)(u=v[c])&&(l=o?ee.call(n,u):d[c])>-1&&(n[l]=!(a[l]=u))}}else v=g(v===a?v.splice(f,v.length):v),o?o(null,a,v,h):Q.apply(a,v)})}function v(t){for(var e,i,n,r=t.length,o=R.relative[t[0].type],a=o||R.relative[" "],s=o?1:0,h=f(function(t){return t===e},a,!0),l=f(function(t){return ee.call(e,t)>-1},a,!0),c=[function(t,i,n){return!o&&(n||i!==S)||((e=i).nodeType?h(t,i,n):l(t,i,n))}];r>s;s++)if(i=R.relative[t[s].type])c=[f(m(c),i)];else{if(i=R.filter[t[s].type].apply(null,t[s].matches),i[F]){for(n=++s;r>n&&!R.relative[t[n].type];n++);return E(s>1&&m(c),s>1&&p(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(he,"$1"),i,n>s&&v(t.slice(s,n)),r>n&&v(t=t.slice(n)),r>n&&p(t))}c.push(i)}return m(c)}function y(t,i){var r=i.length>0,o=t.length>0,a=function(n,a,s,h,l){var c,u,d,p=0,f="0",m=n&&[],E=[],v=S,y=n||o&&R.find.TAG("*",l),_=z+=null==v?1:Math.random()||.1,T=y.length;for(l&&(S=a!==P&&a);f!==T&&null!=(c=y[f]);f++){if(o&&c){for(u=0;d=t[u++];)if(d(c,a,s)){h.push(c);break}l&&(z=_)}r&&((c=!d&&c)&&p--,n&&m.push(c))}if(p+=f,r&&f!==p){for(u=0;d=i[u++];)d(m,E,a,s);if(n){if(p>0)for(;f--;)m[f]||E[f]||(E[f]=K.call(h));E=g(E)}Q.apply(h,E),l&&!n&&E.length>0&&p+i.length>1&&e.uniqueSort(h)}return l&&(z=_,S=v),m};return r?n(a):a}function _(t,i,n){for(var r=0,o=i.length;o>r;r++)e(t,i[r],n);return n}function T(t,e,i,n){var r,o,a,s,h,l=d(t);if(!n&&1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&b.getById&&9===e.nodeType&&D&&R.relative[o[1].type]){if(e=(R.find.ID(a.matches[0].replace(Te,xe),e)||[])[0],!e)return i;t=t.slice(o.shift().value.length)}for(r=fe.needsContext.test(t)?0:o.length;r--&&(a=o[r],!R.relative[s=a.type]);)if((h=R.find[s])&&(n=h(a.matches[0].replace(Te,xe),ye.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(r,1),t=n.length&&p(o),!t)return Q.apply(i,n),i;break}}return M(t,l)(n,e,!D,i,ye.test(t)&&c(e.parentNode)||e),i}var x,b,R,w,H,M,S,C,L,A,P,k,D,O,B,N,U,F="sizzle"+-new Date,V=t.document,z=0,I=0,j=i(),G=i(),W=i(),q=function(t,e){return t===e&&(L=!0),0},X="undefined",Y=1<<31,$={}.hasOwnProperty,Z=[],K=Z.pop,J=Z.push,Q=Z.push,te=Z.slice,ee=Z.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=re.replace("w","w#"),ae="\\["+ne+"*("+re+")"+ne+"*(?:([*^$|!~]?=)"+ne+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+oe+")|)|)"+ne+"*\\]",se=":("+re+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ae.replace(3,8)+")*)|.*)\\)|)",he=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),le=new RegExp("^"+ne+"*,"+ne+"*"),ce=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ue=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),de=new RegExp(se),pe=new RegExp("^"+oe+"$"),fe={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,Ee=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,_e=/'|\\/g,Te=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),xe=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Q.apply(Z=te.call(V.childNodes),V.childNodes),Z[V.childNodes.length].nodeType}catch(be){Q={apply:Z.length?function(t,e){J.apply(t,te.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}b=e.support={},H=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},A=e.setDocument=function(t){var e,i=t?t.ownerDocument||t:V,n=i.defaultView;return i!==P&&9===i.nodeType&&i.documentElement?(P=i,k=i.documentElement,D=!H(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){A()},!1):n.attachEvent&&n.attachEvent("onunload",function(){A()})),b.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),b.getElementsByTagName=r(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),b.getElementsByClassName=Ee.test(i.getElementsByClassName)&&r(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),b.getById=r(function(t){return k.appendChild(t).id=F,!i.getElementsByName||!i.getElementsByName(F).length}),b.getById?(R.find.ID=function(t,e){if(typeof e.getElementById!==X&&D){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},R.filter.ID=function(t){var e=t.replace(Te,xe);return function(t){return t.getAttribute("id")===e}}):(delete R.find.ID,R.filter.ID=function(t){var e=t.replace(Te,xe);return function(t){var i=typeof t.getAttributeNode!==X&&t.getAttributeNode("id");return i&&i.value===e}}),R.find.TAG=b.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==X?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},R.find.CLASS=b.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==X&&D?e.getElementsByClassName(t):void 0},B=[],O=[],(b.qsa=Ee.test(i.querySelectorAll))&&(r(function(t){t.innerHTML="<select t=''><option selected=''></option></select>",t.querySelectorAll("[t^='']").length&&O.push("[*^$]="+ne+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||O.push("\\["+ne+"*(?:value|"+ie+")"),t.querySelectorAll(":checked").length||O.push(":checked")}),r(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&O.push("name"+ne+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),O.push(",.*:")})),(b.matchesSelector=Ee.test(N=k.webkitMatchesSelector||k.mozMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&r(function(t){b.disconnectedMatch=N.call(t,"div"),N.call(t,"[s!='']:x"),B.push("!=",se)}),O=O.length&&new RegExp(O.join("|")),B=B.length&&new RegExp(B.join("|")),e=Ee.test(k.compareDocumentPosition),U=e||Ee.test(k.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},q=e?function(t,e){if(t===e)return L=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!b.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===V&&U(V,t)?-1:e===i||e.ownerDocument===V&&U(V,e)?1:C?ee.call(C,t)-ee.call(C,e):0:4&n?-1:1)}:function(t,e){if(t===e)return L=!0,0;var n,r=0,o=t.parentNode,s=e.parentNode,h=[t],l=[e];if(!o||!s)return t===i?-1:e===i?1:o?-1:s?1:C?ee.call(C,t)-ee.call(C,e):0;if(o===s)return a(t,e);for(n=t;n=n.parentNode;)h.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;h[r]===l[r];)r++;return r?a(h[r],l[r]):h[r]===V?-1:l[r]===V?1:0},i):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&A(t),i=i.replace(ue,"='$1']"),!(!b.matchesSelector||!D||B&&B.test(i)||O&&O.test(i)))try{var n=N.call(t,i);if(n||b.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&A(t),U(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&A(t);var i=R.attrHandle[e.toLowerCase()],n=i&&$.call(R.attrHandle,e.toLowerCase())?i(t,e,!D):void 0;return void 0!==n?n:b.attributes||!D?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(L=!b.detectDuplicates,C=!b.sortStable&&t.slice(0),t.sort(q),L){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return C=null,t},w=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=w(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=w(e);return i},R=e.selectors={cacheLength:50,createPseudo:n,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Te,xe),t[3]=(t[4]||t[5]||"").replace(Te,xe),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return fe.CHILD.test(t[0])?null:(t[3]&&void 0!==t[4]?t[2]=t[4]:i&&de.test(i)&&(e=d(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Te,xe).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+ne+")"+t+"("+ne+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==X&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,h){var l,c,u,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,E=s&&e.nodeName.toLowerCase(),v=!h&&!s;if(g){if(o){for(;m;){for(u=e;u=u[m];)if(s?u.nodeName.toLowerCase()===E:1===u.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&v){for(c=g[F]||(g[F]={}),l=c[t]||[],p=l[0]===z&&l[1],d=l[0]===z&&l[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();)if(1===u.nodeType&&++d&&u===e){c[t]=[z,p,d];break}}else if(v&&(l=(e[F]||(e[F]={}))[t])&&l[0]===z)d=l[1];else for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((s?u.nodeName.toLowerCase()!==E:1!==u.nodeType)||!++d||(v&&((u[F]||(u[F]={}))[t]=[z,d]),u!==e)););return d-=r,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var r,o=R.pseudos[t]||R.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[F]?o(i):o.length>1?(r=[t,t,"",i],R.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),a=r.length;a--;)n=ee.call(t,r[a]),t[n]=!(e[n]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=M(t.replace(he,"$1"));return r[F]?n(function(t,e,i,n){for(var o,a=r(t,null,n,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||w(e)).indexOf(t)>-1}}),lang:n(function(t){return pe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(Te,xe).toLowerCase(),function(e){var i;do if(i=D?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===k},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!R.pseudos.empty(t)},header:function(t){return ge.test(t.nodeName)},input:function(t){return me.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[0>i?i+e:i]}),even:l(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},R.pseudos.nth=R.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})R.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})R.pseudos[x]=h(x);return u.prototype=R.filters=R.pseudos,R.setFilters=new u,M=e.compile=function(t,e){var i,n=[],r=[],o=W[t+" "];if(!o){for(e||(e=d(t)),i=e.length;i--;)o=v(e[i]),o[F]?n.push(o):r.push(o);o=W(t,y(r,n))}return o},b.sortStable=F.split("").sort(q).join("")===F,b.detectDuplicates=!!L,A(),b.sortDetached=r(function(t){return 1&t.compareDocumentPosition(P.createElement("div"))
}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),b.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(ie,function(t,e,i){var n;return i?void 0:t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);oe.find=ce,oe.expr=ce.selectors,oe.expr[":"]=oe.expr.pseudos,oe.unique=ce.uniqueSort,oe.text=ce.getText,oe.isXMLDoc=ce.isXML,oe.contains=ce.contains;var ue=oe.expr.match.needsContext,de=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,pe=/^.[^:#\[\.,]*$/;oe.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?oe.find.matchesSelector(n,t)?[n]:[]:oe.find.matches(t,oe.grep(e,function(t){return 1===t.nodeType}))},oe.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(oe(t).filter(function(){for(e=0;r>e;e++)if(oe.contains(n[e],this))return!0}));for(e=0;r>e;e++)oe.find(t,n[e],i);return i=this.pushStack(r>1?oe.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&ue.test(t)?oe(t):t||[],!1).length}});var fe,me=t.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Ee=oe.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ge.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||fe).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof oe?e[0]:e,oe.merge(this,oe.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:me,!0)),de.test(i[1])&&oe.isPlainObject(e))for(i in e)oe.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if(n=me.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return fe.find(t);this.length=1,this[0]=n}return this.context=me,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):oe.isFunction(t)?"undefined"!=typeof fe.ready?fe.ready(t):t(oe):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),oe.makeArray(t,this))};Ee.prototype=oe.fn,fe=oe(me);var ve=/^(?:parents|prev(?:Until|All))/,ye={children:!0,contents:!0,next:!0,prev:!0};oe.extend({dir:function(t,e,i){for(var n=[],r=t[e];r&&9!==r.nodeType&&(void 0===i||1!==r.nodeType||!oe(r).is(i));)1===r.nodeType&&n.push(r),r=r[e];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),oe.fn.extend({has:function(t){var e,i=oe(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(oe.contains(this,i[e]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,o=[],a=ue.test(t)||"string"!=typeof t?oe(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&oe.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?oe.unique(o):o)},index:function(t){return t?"string"==typeof t?oe.inArray(this[0],oe(t)):oe.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(oe.unique(oe.merge(this.get(),oe(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),oe.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return oe.dir(t,"parentNode")},parentsUntil:function(t,e,i){return oe.dir(t,"parentNode",i)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return oe.dir(t,"nextSibling")},prevAll:function(t){return oe.dir(t,"previousSibling")},nextUntil:function(t,e,i){return oe.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return oe.dir(t,"previousSibling",i)},siblings:function(t){return oe.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return oe.sibling(t.firstChild)},contents:function(t){return oe.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:oe.merge([],t.childNodes)}},function(t,e){oe.fn[t]=function(i,n){var r=oe.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=oe.filter(n,r)),this.length>1&&(ye[t]||(r=oe.unique(r)),ve.test(t)&&(r=r.reverse())),this.pushStack(r)}});var _e=/\S+/g,Te={};oe.Callbacks=function(t){t="string"==typeof t?Te[t]||o(t):oe.extend({},t);var e,i,n,r,a,s,h=[],l=!t.once&&[],c=function(o){for(i=t.memory&&o,n=!0,a=s||0,s=0,r=h.length,e=!0;h&&r>a;a++)if(h[a].apply(o[0],o[1])===!1&&t.stopOnFalse){i=!1;break}e=!1,h&&(l?l.length&&c(l.shift()):i?h=[]:u.disable())},u={add:function(){if(h){var n=h.length;!function o(e){oe.each(e,function(e,i){var n=oe.type(i);"function"===n?t.unique&&u.has(i)||h.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),e?r=h.length:i&&(s=n,c(i))}return this},remove:function(){return h&&oe.each(arguments,function(t,i){for(var n;(n=oe.inArray(i,h,n))>-1;)h.splice(n,1),e&&(r>=n&&r--,a>=n&&a--)}),this},has:function(t){return t?oe.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],r=0,this},disable:function(){return h=l=i=void 0,this},disabled:function(){return!h},lock:function(){return l=void 0,i||u.disable(),this},locked:function(){return!l},fireWith:function(t,i){return!h||n&&!l||(i=i||[],i=[t,i.slice?i.slice():i],e?l.push(i):c(i)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},oe.extend({Deferred:function(t){var e=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return oe.Deferred(function(i){oe.each(e,function(e,o){var a=oe.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&oe.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?oe.extend(t,n):n}},r={};return n.pipe=n.then,oe.each(e,function(t,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,o=$.call(arguments),a=o.length,s=1!==a||t&&oe.isFunction(t.promise)?a:0,h=1===s?t:oe.Deferred(),l=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?$.call(arguments):r,n===e?h.notifyWith(i,n):--s||h.resolveWith(i,n)}};if(a>1)for(e=new Array(a),i=new Array(a),n=new Array(a);a>r;r++)o[r]&&oe.isFunction(o[r].promise)?o[r].promise().done(l(r,n,o)).fail(h.reject).progress(l(r,i,e)):--s;return s||h.resolveWith(n,o),h.promise()}});var xe;oe.fn.ready=function(t){return oe.ready.promise().done(t),this},oe.extend({isReady:!1,readyWait:1,holdReady:function(t){t?oe.readyWait++:oe.ready(!0)},ready:function(t){if(t===!0?!--oe.readyWait:!oe.isReady){if(!me.body)return setTimeout(oe.ready);oe.isReady=!0,t!==!0&&--oe.readyWait>0||(xe.resolveWith(me,[oe]),oe.fn.trigger&&oe(me).trigger("ready").off("ready"))}}}),oe.ready.promise=function(e){if(!xe)if(xe=oe.Deferred(),"complete"===me.readyState)setTimeout(oe.ready);else if(me.addEventListener)me.addEventListener("DOMContentLoaded",s,!1),t.addEventListener("load",s,!1);else{me.attachEvent("onreadystatechange",s),t.attachEvent("onload",s);var i=!1;try{i=null==t.frameElement&&me.documentElement}catch(n){}i&&i.doScroll&&!function r(){if(!oe.isReady){try{i.doScroll("left")}catch(t){return setTimeout(r,50)}a(),oe.ready()}}()}return xe.promise(e)};var be,Re="undefined";for(be in oe(ne))break;ne.ownLast="0"!==be,ne.inlineBlockNeedsLayout=!1,oe(function(){var t,e,i=me.getElementsByTagName("body")[0];i&&(t=me.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",e=me.createElement("div"),i.appendChild(t).appendChild(e),typeof e.style.zoom!==Re&&(e.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(ne.inlineBlockNeedsLayout=3===e.offsetWidth)&&(i.style.zoom=1)),i.removeChild(t),t=e=null)}),function(){var t=me.createElement("div");if(null==ne.deleteExpando){ne.deleteExpando=!0;try{delete t.test}catch(e){ne.deleteExpando=!1}}t=null}(),oe.acceptData=function(t){var e=oe.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return 1!==i&&9!==i?!1:!e||e!==!0&&t.getAttribute("classid")===e};var we=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,He=/([A-Z])/g;oe.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?oe.cache[t[oe.expando]]:t[oe.expando],!!t&&!l(t)},data:function(t,e,i){return c(t,e,i)},removeData:function(t,e){return u(t,e)},_data:function(t,e,i){return c(t,e,i,!0)},_removeData:function(t,e){return u(t,e,!0)}}),oe.fn.extend({data:function(t,e){var i,n,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=oe.data(o),1===o.nodeType&&!oe._data(o,"parsedAttrs"))){for(i=a.length;i--;)n=a[i].name,0===n.indexOf("data-")&&(n=oe.camelCase(n.slice(5)),h(o,n,r[n]));oe._data(o,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){oe.data(this,t)}):arguments.length>1?this.each(function(){oe.data(this,t,e)}):o?h(o,t,oe.data(o,t)):void 0},removeData:function(t){return this.each(function(){oe.removeData(this,t)})}}),oe.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=oe._data(t,e),i&&(!n||oe.isArray(i)?n=oe._data(t,e,oe.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=oe.queue(t,e),n=i.length,r=i.shift(),o=oe._queueHooks(t,e),a=function(){oe.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return oe._data(t,i)||oe._data(t,i,{empty:oe.Callbacks("once memory").add(function(){oe._removeData(t,e+"queue"),oe._removeData(t,i)})})}}),oe.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?oe.queue(this[0],t):void 0===e?this:this.each(function(){var i=oe.queue(this,t,e);oe._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&oe.dequeue(this,t)})},dequeue:function(t){return this.each(function(){oe.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=oe.Deferred(),o=this,a=this.length,s=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)i=oe._data(o[a],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(s));return s(),r.promise(e)}});var Me=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Se=["Top","Right","Bottom","Left"],Ce=function(t,e){return t=e||t,"none"===oe.css(t,"display")||!oe.contains(t.ownerDocument,t)},Le=oe.access=function(t,e,i,n,r,o,a){var s=0,h=t.length,l=null==i;if("object"===oe.type(i)){r=!0;for(s in i)oe.access(t,e,s,i[s],!0,o,a)}else if(void 0!==n&&(r=!0,oe.isFunction(n)||(a=!0),l&&(a?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(oe(t),i)})),e))for(;h>s;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return r?t:l?e.call(t):h?e(t[0],i):o},Ae=/^(?:checkbox|radio)$/i;!function(){var t=me.createDocumentFragment(),e=me.createElement("div"),i=me.createElement("input");if(e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a>",ne.leadingWhitespace=3===e.firstChild.nodeType,ne.tbody=!e.getElementsByTagName("tbody").length,ne.htmlSerialize=!!e.getElementsByTagName("link").length,ne.html5Clone="<:nav></:nav>"!==me.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,t.appendChild(i),ne.appendChecked=i.checked,e.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),e.innerHTML="<input type='radio' checked='checked' name='t'/>",ne.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ne.noCloneEvent=!0,e.attachEvent&&(e.attachEvent("onclick",function(){ne.noCloneEvent=!1}),e.cloneNode(!0).click()),null==ne.deleteExpando){ne.deleteExpando=!0;try{delete e.test}catch(n){ne.deleteExpando=!1}}t=e=i=null}(),function(){var e,i,n=me.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})i="on"+e,(ne[e+"Bubbles"]=i in t)||(n.setAttribute(i,"t"),ne[e+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var Pe=/^(?:input|select|textarea)$/i,ke=/^key/,De=/^(?:mouse|contextmenu)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,Be=/^([^.]*)(?:\.(.+)|)$/;oe.event={global:{},add:function(t,e,i,n,r){var o,a,s,h,l,c,u,d,p,f,m,g=oe._data(t);if(g){for(i.handler&&(h=i,i=h.handler,r=h.selector),i.guid||(i.guid=oe.guid++),(a=g.events)||(a=g.events={}),(c=g.handle)||(c=g.handle=function(t){return typeof oe===Re||t&&oe.event.triggered===t.type?void 0:oe.event.dispatch.apply(c.elem,arguments)},c.elem=t),e=(e||"").match(_e)||[""],s=e.length;s--;)o=Be.exec(e[s])||[],p=m=o[1],f=(o[2]||"").split(".").sort(),p&&(l=oe.event.special[p]||{},p=(r?l.delegateType:l.bindType)||p,l=oe.event.special[p]||{},u=oe.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&oe.expr.match.needsContext.test(r),namespace:f.join(".")},h),(d=a[p])||(d=a[p]=[],d.delegateCount=0,l.setup&&l.setup.call(t,n,f,c)!==!1||(t.addEventListener?t.addEventListener(p,c,!1):t.attachEvent&&t.attachEvent("on"+p,c))),l.add&&(l.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),oe.event.global[p]=!0);t=null}},remove:function(t,e,i,n,r){var o,a,s,h,l,c,u,d,p,f,m,g=oe.hasData(t)&&oe._data(t);if(g&&(c=g.events)){for(e=(e||"").match(_e)||[""],l=e.length;l--;)if(s=Be.exec(e[l])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p){for(u=oe.event.special[p]||{},p=(n?u.delegateType:u.bindType)||p,d=c[p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),h=o=d.length;o--;)a=d[o],!r&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,u.remove&&u.remove.call(t,a));h&&!d.length&&(u.teardown&&u.teardown.call(t,f,g.handle)!==!1||oe.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)oe.event.remove(t,p+e[l],i,n,!0);oe.isEmptyObject(c)&&(delete g.handle,oe._removeData(t,"events"))}},trigger:function(e,i,n,r){var o,a,s,h,l,c,u,d=[n||me],p=ee.call(e,"type")?e.type:e,f=ee.call(e,"namespace")?e.namespace.split("."):[];if(s=c=n=n||me,3!==n.nodeType&&8!==n.nodeType&&!Oe.test(p+oe.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),a=p.indexOf(":")<0&&"on"+p,e=e[oe.expando]?e:new oe.Event(p,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:oe.makeArray(i,[e]),l=oe.event.special[p]||{},r||!l.trigger||l.trigger.apply(n,i)!==!1)){if(!r&&!l.noBubble&&!oe.isWindow(n)){for(h=l.delegateType||p,Oe.test(h+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),c=s;c===(n.ownerDocument||me)&&d.push(c.defaultView||c.parentWindow||t)}for(u=0;(s=d[u++])&&!e.isPropagationStopped();)e.type=u>1?h:l.bindType||p,o=(oe._data(s,"events")||{})[e.type]&&oe._data(s,"handle"),o&&o.apply(s,i),o=a&&s[a],o&&o.apply&&oe.acceptData(s)&&(e.result=o.apply(s,i),e.result===!1&&e.preventDefault());if(e.type=p,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),i)===!1)&&oe.acceptData(n)&&a&&n[p]&&!oe.isWindow(n)){c=n[a],c&&(n[a]=null),oe.event.triggered=p;try{n[p]()}catch(m){}oe.event.triggered=void 0,c&&(n[a]=c)}return e.result}},dispatch:function(t){t=oe.event.fix(t);var e,i,n,r,o,a=[],s=$.call(arguments),h=(oe._data(this,"events")||{})[t.type]||[],l=oe.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(a=oe.event.handlers.call(this,t,h),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,o=0;(n=r.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,i=((oe.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,s),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,o,a=[],s=e.delegateCount,h=t.target;if(s&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==t.type)){for(r=[],o=0;s>o;o++)n=e[o],i=n.selector+" ",void 0===r[i]&&(r[i]=n.needsContext?oe(i,this).index(h)>=0:oe.find(i,this,null,[h]).length),r[i]&&r.push(n);r.length&&a.push({elem:h,handlers:r})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},fix:function(t){if(t[oe.expando])return t;var e,i,n,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=De.test(r)?this.mouseHooks:ke.test(r)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new oe.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=o.srcElement||me),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,o=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||me,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return oe.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return oe.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=oe.extend(new oe.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?oe.event.trigger(r,null,e):oe.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},oe.removeEvent=me.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===Re&&(t[n]=null),t.detachEvent(n,i))},oe.Event=function(t,e){return this instanceof oe.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&(t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault())?d:p):this.type=t,e&&oe.extend(this,e),this.timeStamp=t&&t.timeStamp||oe.now(),void(this[oe.expando]=!0)):new oe.Event(t,e)},oe.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=d,this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){oe.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return(!r||r!==n&&!oe.contains(n,r))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),ne.submitBubbles||(oe.event.special.submit={setup:function(){return oe.nodeName(this,"form")?!1:void oe.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=oe.nodeName(e,"input")||oe.nodeName(e,"button")?e.form:void 0;i&&!oe._data(i,"submitBubbles")&&(oe.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),oe._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&oe.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return oe.nodeName(this,"form")?!1:void oe.event.remove(this,"._submit")}}),ne.changeBubbles||(oe.event.special.change={setup:function(){return Pe.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(oe.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),oe.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),oe.event.simulate("change",this,t,!0)})),!1):void oe.event.add(this,"beforeactivate._change",function(t){var e=t.target;Pe.test(e.nodeName)&&!oe._data(e,"changeBubbles")&&(oe.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||oe.event.simulate("change",this.parentNode,t,!0)}),oe._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return oe.event.remove(this,"._change"),!Pe.test(this.nodeName)}}),ne.focusinBubbles||oe.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){oe.event.simulate(e,t.target,oe.event.fix(t),!0)};oe.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=oe._data(n,e);r||n.addEventListener(t,i,!0),oe._data(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=oe._data(n,e)-1;r?oe._data(n,e,r):(n.removeEventListener(t,i,!0),oe._removeData(n,e))}}}),oe.fn.extend({on:function(t,e,i,n,r){var o,a;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(o in t)this.on(o,e,i,t[o],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=p;else if(!n)return this;return 1===r&&(a=n,n=function(t){return oe().off(t),a.apply(this,arguments)},n.guid=a.guid||(a.guid=oe.guid++)),this.each(function(){oe.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,oe(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=p),this.each(function(){oe.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){oe.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?oe.event.trigger(t,e,i,!0):void 0}});var Ne="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ue=/ jQuery\d+="(?:null|\d+)"/g,Fe=new RegExp("<(?:"+Ne+")[\\s/>]","i"),Ve=/^\s+/,ze=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ie=/<([\w:]+)/,je=/<tbody/i,Ge=/<|&#?\w+;/,We=/<(?:script|style|link)/i,qe=/checked\s*(?:[^=]|=\s*.checked.)/i,Xe=/^$|\/(?:java|ecma)script/i,Ye=/^true\/(.*)/,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ze={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ne.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ke=m(me),Je=Ke.appendChild(me.createElement("div"));Ze.optgroup=Ze.option,Ze.tbody=Ze.tfoot=Ze.colgroup=Ze.caption=Ze.thead,Ze.th=Ze.td,oe.extend({clone:function(t,e,i){var n,r,o,a,s,h=oe.contains(t.ownerDocument,t);if(ne.html5Clone||oe.isXMLDoc(t)||!Fe.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(Je.innerHTML=t.outerHTML,Je.removeChild(o=Je.firstChild)),!(ne.noCloneEvent&&ne.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||oe.isXMLDoc(t)))for(n=g(o),s=g(t),a=0;null!=(r=s[a]);++a)n[a]&&b(r,n[a]);if(e)if(i)for(s=s||g(t),n=n||g(o),a=0;null!=(r=s[a]);a++)x(r,n[a]);else x(t,o);return n=g(o,"script"),n.length>0&&T(n,!h&&g(t,"script")),n=s=r=null,o},buildFragment:function(t,e,i,n){for(var r,o,a,s,h,l,c,u=t.length,d=m(e),p=[],f=0;u>f;f++)if(o=t[f],o||0===o)if("object"===oe.type(o))oe.merge(p,o.nodeType?[o]:o);else if(Ge.test(o)){for(s=s||d.appendChild(e.createElement("div")),h=(Ie.exec(o)||["",""])[1].toLowerCase(),c=Ze[h]||Ze._default,s.innerHTML=c[1]+o.replace(ze,"<$1></$2>")+c[2],r=c[0];r--;)s=s.lastChild;if(!ne.leadingWhitespace&&Ve.test(o)&&p.push(e.createTextNode(Ve.exec(o)[0])),!ne.tbody)for(o="table"!==h||je.test(o)?"<table>"!==c[1]||je.test(o)?0:s:s.firstChild,r=o&&o.childNodes.length;r--;)oe.nodeName(l=o.childNodes[r],"tbody")&&!l.childNodes.length&&o.removeChild(l);for(oe.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=d.lastChild}else p.push(e.createTextNode(o));for(s&&d.removeChild(s),ne.appendChecked||oe.grep(g(p,"input"),E),f=0;o=p[f++];)if((!n||-1===oe.inArray(o,n))&&(a=oe.contains(o.ownerDocument,o),s=g(d.appendChild(o),"script"),a&&T(s),i))for(r=0;o=s[r++];)Xe.test(o.type||"")&&i.push(o);return s=null,d},cleanData:function(t,e){for(var i,n,r,o,a=0,s=oe.expando,h=oe.cache,l=ne.deleteExpando,c=oe.event.special;null!=(i=t[a]);a++)if((e||oe.acceptData(i))&&(r=i[s],o=r&&h[r])){if(o.events)for(n in o.events)c[n]?oe.event.remove(i,n):oe.removeEvent(i,n,o.handle);h[r]&&(delete h[r],l?delete i[s]:typeof i.removeAttribute!==Re?i.removeAttribute(s):i[s]=null,Y.push(r))}}}),oe.fn.extend({text:function(t){return Le(this,function(t){return void 0===t?oe.text(this):this.empty().append((this[0]&&this[0].ownerDocument||me).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=v(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=v(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?oe.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||oe.cleanData(g(i)),i.parentNode&&(e&&oe.contains(i.ownerDocument,i)&&T(g(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&oe.cleanData(g(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&oe.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return oe.clone(this,t,e)})},html:function(t){return Le(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(Ue,""):void 0;if(!("string"!=typeof t||We.test(t)||!ne.htmlSerialize&&Fe.test(t)||!ne.leadingWhitespace&&Ve.test(t)||Ze[(Ie.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(ze,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(oe.cleanData(g(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,oe.cleanData(g(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=Z.apply([],t);var i,n,r,o,a,s,h=0,l=this.length,c=this,u=l-1,d=t[0],p=oe.isFunction(d);if(p||l>1&&"string"==typeof d&&!ne.checkClone&&qe.test(d))return this.each(function(i){var n=c.eq(i);p&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(l&&(s=oe.buildFragment(t,this[0].ownerDocument,!1,this),i=s.firstChild,1===s.childNodes.length&&(s=i),i)){for(o=oe.map(g(s,"script"),y),r=o.length;l>h;h++)n=s,h!==u&&(n=oe.clone(n,!0,!0),r&&oe.merge(o,g(n,"script"))),e.call(this[h],n,h);if(r)for(a=o[o.length-1].ownerDocument,oe.map(o,_),h=0;r>h;h++)n=o[h],Xe.test(n.type||"")&&!oe._data(n,"globalEval")&&oe.contains(a,n)&&(n.src?oe._evalUrl&&oe._evalUrl(n.src):oe.globalEval((n.text||n.textContent||n.innerHTML||"").replace($e,"")));s=i=null}return this}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){oe.fn[t]=function(t){for(var i,n=0,r=[],o=oe(t),a=o.length-1;a>=n;n++)i=n===a?this:this.clone(!0),oe(o[n])[e](i),K.apply(r,i.get());return this.pushStack(r)}});var Qe,ti={};!function(){var t,e,i=me.createElement("div"),n="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=i.getElementsByTagName("a")[0],t.style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(t.style.opacity),ne.cssFloat=!!t.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===i.style.backgroundClip,t=i=null,ne.shrinkWrapBlocks=function(){var t,i,r,o;if(null==e){if(t=me.getElementsByTagName("body")[0],!t)return;o="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",i=me.createElement("div"),r=me.createElement("div"),t.appendChild(i).appendChild(r),e=!1,typeof r.style.zoom!==Re&&(r.style.cssText=n+";width:1px;padding:1px;zoom:1",r.innerHTML="<div></div>",r.firstChild.style.width="5px",e=3!==r.offsetWidth),t.removeChild(i),t=i=r=null}return e}}();var ei,ii,ni=/^margin/,ri=new RegExp("^("+Me+")(?!px)[a-z%]+$","i"),oi=/^(top|right|bottom|left)$/;t.getComputedStyle?(ei=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)},ii=function(t,e,i){var n,r,o,a,s=t.style;return i=i||ei(t),a=i?i.getPropertyValue(e)||i[e]:void 0,i&&(""!==a||oe.contains(t.ownerDocument,t)||(a=oe.style(t,e)),ri.test(a)&&ni.test(e)&&(n=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=r,s.maxWidth=o)),void 0===a?a:a+""}):me.documentElement.currentStyle&&(ei=function(t){return t.currentStyle},ii=function(t,e,i){var n,r,o,a,s=t.style;return i=i||ei(t),a=i?i[e]:void 0,null==a&&s&&s[e]&&(a=s[e]),ri.test(a)&&!oi.test(e)&&(n=s.left,r=t.runtimeStyle,o=r&&r.left,o&&(r.left=t.currentStyle.left),s.left="fontSize"===e?"1em":a,a=s.pixelLeft+"px",s.left=n,o&&(r.left=o)),void 0===a?a:a+""||"auto"}),function(){function e(){var e,i,n=me.getElementsByTagName("body")[0];n&&(e=me.createElement("div"),i=me.createElement("div"),e.style.cssText=l,n.appendChild(e).appendChild(i),i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",oe.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){r=4===i.offsetWidth
}),o=!0,a=!1,s=!0,t.getComputedStyle&&(a="1%"!==(t.getComputedStyle(i,null)||{}).top,o="4px"===(t.getComputedStyle(i,null)||{width:"4px"}).width),n.removeChild(e),i=n=null)}var i,n,r,o,a,s,h=me.createElement("div"),l="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("a")[0],i.style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(i.style.opacity),ne.cssFloat=!!i.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===h.style.backgroundClip,i=h=null,oe.extend(ne,{reliableHiddenOffsets:function(){if(null!=n)return n;var t,e,i,r=me.createElement("div"),o=me.getElementsByTagName("body")[0];if(o)return r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=me.createElement("div"),t.style.cssText=l,o.appendChild(t).appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=r.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",i=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",n=i&&0===e[0].offsetHeight,o.removeChild(t),r=o=null,n},boxSizing:function(){return null==r&&e(),r},boxSizingReliable:function(){return null==o&&e(),o},pixelPosition:function(){return null==a&&e(),a},reliableMarginRight:function(){var e,i,n,r;if(null==s&&t.getComputedStyle){if(e=me.getElementsByTagName("body")[0],!e)return;i=me.createElement("div"),n=me.createElement("div"),i.style.cssText=l,e.appendChild(i).appendChild(n),r=n.appendChild(me.createElement("div")),r.style.cssText=n.style.cssText=c,r.style.marginRight=r.style.width="0",n.style.width="1px",s=!parseFloat((t.getComputedStyle(r,null)||{}).marginRight),e.removeChild(i)}return s}})}(),oe.swap=function(t,e,i,n){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=a[o];return r};var ai=/alpha\([^)]*\)/i,si=/opacity\s*=\s*([^)]*)/,hi=/^(none|table(?!-c[ea]).+)/,li=new RegExp("^("+Me+")(.*)$","i"),ci=new RegExp("^([+-])=("+Me+")","i"),ui={position:"absolute",visibility:"hidden",display:"block"},di={letterSpacing:0,fontWeight:400},pi=["Webkit","O","Moz","ms"];oe.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ii(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ne.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=oe.camelCase(e),h=t.style;if(e=oe.cssProps[s]||(oe.cssProps[s]=M(h,s)),a=oe.cssHooks[e]||oe.cssHooks[s],void 0===i)return a&&"get"in a&&void 0!==(r=a.get(t,!1,n))?r:h[e];if(o=typeof i,"string"===o&&(r=ci.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(oe.css(t,e)),o="number"),null!=i&&i===i&&("number"!==o||oe.cssNumber[s]||(i+="px"),ne.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),!(a&&"set"in a&&void 0===(i=a.set(t,i,n)))))try{h[e]="",h[e]=i}catch(l){}}},css:function(t,e,i,n){var r,o,a,s=oe.camelCase(e);return e=oe.cssProps[s]||(oe.cssProps[s]=M(t.style,s)),a=oe.cssHooks[e]||oe.cssHooks[s],a&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=ii(t,e,n)),"normal"===o&&e in di&&(o=di[e]),""===i||i?(r=parseFloat(o),i===!0||oe.isNumeric(r)?r||0:o):o}}),oe.each(["height","width"],function(t,e){oe.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&hi.test(oe.css(t,"display"))?oe.swap(t,ui,function(){return A(t,e,n)}):A(t,e,n):void 0},set:function(t,i,n){var r=n&&ei(t);return C(t,i,n?L(t,e,n,ne.boxSizing()&&"border-box"===oe.css(t,"boxSizing",!1,r),r):0)}}}),ne.opacity||(oe.cssHooks.opacity={get:function(t,e){return si.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=oe.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===oe.trim(o.replace(ai,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=ai.test(o)?o.replace(ai,r):o+" "+r)}}),oe.cssHooks.marginRight=H(ne.reliableMarginRight,function(t,e){return e?oe.swap(t,{display:"inline-block"},ii,[t,"marginRight"]):void 0}),oe.each({margin:"",padding:"",border:"Width"},function(t,e){oe.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+Se[n]+e]=o[n]||o[n-2]||o[0];return r}},ni.test(t)||(oe.cssHooks[t+e].set=C)}),oe.fn.extend({css:function(t,e){return Le(this,function(t,e,i){var n,r,o={},a=0;if(oe.isArray(e)){for(n=ei(t),r=e.length;r>a;a++)o[e[a]]=oe.css(t,e[a],!1,n);return o}return void 0!==i?oe.style(t,e,i):oe.css(t,e)},t,e,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ce(this)?oe(this).show():oe(this).hide()})}}),oe.Tween=P,P.prototype={constructor:P,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(oe.cssNumber[i]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,i=P.propHooks[this.prop];return this.pos=e=this.options.duration?oe.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=oe.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){oe.fx.step[t.prop]?oe.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[oe.cssProps[t.prop]]||oe.cssHooks[t.prop])?oe.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},oe.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},oe.fx=P.prototype.init,oe.fx.step={};var fi,mi,gi=/^(?:toggle|show|hide)$/,Ei=new RegExp("^(?:([+-])=|)("+Me+")([a-z%]*)$","i"),vi=/queueHooks$/,yi=[B],_i={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=Ei.exec(e),o=r&&r[3]||(oe.cssNumber[t]?"":"px"),a=(oe.cssNumber[t]||"px"!==o&&+n)&&Ei.exec(oe.css(i.elem,t)),s=1,h=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+n||1;do s=s||".5",a/=s,oe.style(i.elem,t,a+o);while(s!==(s=i.cur()/n)&&1!==s&&--h)}return r&&(a=i.start=+a||+n||0,i.unit=o,i.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),i}]};oe.Animation=oe.extend(U,{tweener:function(t,e){oe.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],_i[i]=_i[i]||[],_i[i].unshift(e)},prefilter:function(t,e){e?yi.unshift(t):yi.push(t)}}),oe.speed=function(t,e,i){var n=t&&"object"==typeof t?oe.extend({},t):{complete:i||!i&&e||oe.isFunction(t)&&t,duration:t,easing:i&&e||e&&!oe.isFunction(e)&&e};return n.duration=oe.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in oe.fx.speeds?oe.fx.speeds[n.duration]:oe.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){oe.isFunction(n.old)&&n.old.call(this),n.queue&&oe.dequeue(this,n.queue)},n},oe.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Ce).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=oe.isEmptyObject(t),o=oe.speed(e,i,n),a=function(){var e=U(this,oe.extend({},t),o);(r||oe._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=oe.timers,a=oe._data(this);if(r)a[r]&&a[r].stop&&n(a[r]);else for(r in a)a[r]&&a[r].stop&&vi.test(r)&&n(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));(e||!i)&&oe.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=oe._data(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=oe.timers,a=n?n.length:0;for(i.finish=!0,oe.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),oe.each(["toggle","show","hide"],function(t,e){var i=oe.fn[e];oe.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(D(e,!0),t,n,r)}}),oe.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){oe.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),oe.timers=[],oe.fx.tick=function(){var t,e=oe.timers,i=0;for(fi=oe.now();i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||oe.fx.stop(),fi=void 0},oe.fx.timer=function(t){oe.timers.push(t),t()?oe.fx.start():oe.timers.pop()},oe.fx.interval=13,oe.fx.start=function(){mi||(mi=setInterval(oe.fx.tick,oe.fx.interval))},oe.fx.stop=function(){clearInterval(mi),mi=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fn.delay=function(t,e){return t=oe.fx?oe.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t,e,i,n,r=me.createElement("div");r.setAttribute("className","t"),r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=r.getElementsByTagName("a")[0],i=me.createElement("select"),n=i.appendChild(me.createElement("option")),e=r.getElementsByTagName("input")[0],t.style.cssText="top:1px",ne.getSetAttribute="t"!==r.className,ne.style=/top/.test(t.getAttribute("style")),ne.hrefNormalized="/a"===t.getAttribute("href"),ne.checkOn=!!e.value,ne.optSelected=n.selected,ne.enctype=!!me.createElement("form").enctype,i.disabled=!0,ne.optDisabled=!n.disabled,e=me.createElement("input"),e.setAttribute("value",""),ne.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),ne.radioValue="t"===e.value,t=e=i=n=r=null}();var Ti=/\r/g;oe.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=oe.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,oe(this).val()):t,null==r?r="":"number"==typeof r?r+="":oe.isArray(r)&&(r=oe.map(r,function(t){return null==t?"":t+""})),e=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return e=oe.valHooks[r.type]||oe.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(Ti,""):null==i?"":i)}}}),oe.extend({valHooks:{option:{get:function(t){var e=oe.find.attr(t,"value");return null!=e?e:oe.text(t)}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||0>r,a=o?null:[],s=o?r+1:n.length,h=0>r?s:o?r:0;s>h;h++)if(i=n[h],!(!i.selected&&h!==r||(ne.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&oe.nodeName(i.parentNode,"optgroup"))){if(e=oe(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,o=oe.makeArray(e),a=r.length;a--;)if(n=r[a],oe.inArray(oe.valHooks.option.get(n),o)>=0)try{n.selected=i=!0}catch(s){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),r}}}}),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(t,e){return oe.isArray(e)?t.checked=oe.inArray(oe(t).val(),e)>=0:void 0}},ne.checkOn||(oe.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var xi,bi,Ri=oe.expr.attrHandle,wi=/^(?:checked|selected)$/i,Hi=ne.getSetAttribute,Mi=ne.input;oe.fn.extend({attr:function(t,e){return Le(this,oe.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){oe.removeAttr(this,t)})}}),oe.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===Re?oe.prop(t,e,i):(1===o&&oe.isXMLDoc(t)||(e=e.toLowerCase(),n=oe.attrHooks[e]||(oe.expr.match.bool.test(e)?bi:xi)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=oe.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):void oe.removeAttr(t,e))},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(_e);if(o&&1===t.nodeType)for(;i=o[r++];)n=oe.propFix[i]||i,oe.expr.match.bool.test(i)?Mi&&Hi||!wi.test(i)?t[n]=!1:t[oe.camelCase("default-"+i)]=t[n]=!1:oe.attr(t,i,""),t.removeAttribute(Hi?i:n)},attrHooks:{type:{set:function(t,e){if(!ne.radioValue&&"radio"===e&&oe.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),bi={set:function(t,e,i){return e===!1?oe.removeAttr(t,i):Mi&&Hi||!wi.test(i)?t.setAttribute(!Hi&&oe.propFix[i]||i,i):t[oe.camelCase("default-"+i)]=t[i]=!0,i}},oe.each(oe.expr.match.bool.source.match(/\w+/g),function(t,e){var i=Ri[e]||oe.find.attr;Ri[e]=Mi&&Hi||!wi.test(e)?function(t,e,n){var r,o;return n||(o=Ri[e],Ri[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,Ri[e]=o),r}:function(t,e,i){return i?void 0:t[oe.camelCase("default-"+e)]?e.toLowerCase():null}}),Mi&&Hi||(oe.attrHooks.value={set:function(t,e,i){return oe.nodeName(t,"input")?void(t.defaultValue=e):xi&&xi.set(t,e,i)}}),Hi||(xi={set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:void 0}},Ri.id=Ri.name=Ri.coords=function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},oe.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:void 0},set:xi.set},oe.attrHooks.contenteditable={set:function(t,e,i){xi.set(t,""===e?!1:e,i)}},oe.each(["width","height"],function(t,e){oe.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ne.style||(oe.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Si=/^(?:input|select|textarea|button|object)$/i,Ci=/^(?:a|area)$/i;oe.fn.extend({prop:function(t,e){return Le(this,oe.prop,t,e,arguments.length>1)},removeProp:function(t){return t=oe.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),oe.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return o=1!==a||!oe.isXMLDoc(t),o&&(e=oe.propFix[e]||e,r=oe.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=oe.find.attr(t,"tabindex");return e?parseInt(e,10):Si.test(t.nodeName)||Ci.test(t.nodeName)&&t.href?0:-1}}}}),ne.hrefNormalized||oe.each(["href","src"],function(t,e){oe.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ne.optSelected||(oe.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),oe.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){oe.propFix[this.toLowerCase()]=this}),ne.enctype||(oe.propFix.enctype="encoding");var Li=/[\t\r\n\f]/g;oe.fn.extend({addClass:function(t){var e,i,n,r,o,a,s=0,h=this.length,l="string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(_e)||[];h>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Li," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");a=oe.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,r,o,a,s=0,h=this.length,l=0===arguments.length||"string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(_e)||[];h>s;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Li," "):"")){for(o=0;r=e[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");a=t?oe.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(oe.isFunction(t)?function(i){oe(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,r=oe(this),o=t.match(_e)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===Re||"boolean"===i)&&(this.className&&oe._data(this,"__className__",this.className),this.className=this.className||t===!1?"":oe._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Li," ").indexOf(e)>=0)return!0;return!1}}),oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){oe.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),oe.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ai=oe.now(),Pi=/\?/,ki=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;oe.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var i,n=null,r=oe.trim(e+"");return r&&!oe.trim(r.replace(ki,function(t,e,r,o){return i&&e&&(n=0),0===n?t:(i=r||e,n+=!o-!r,"")}))?Function("return "+r)():oe.error("Invalid JSON: "+e)},oe.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(n=new DOMParser,i=n.parseFromString(e,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e))}catch(r){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||oe.error("Invalid XML: "+e),i};var Di,Oi,Bi=/#.*$/,Ni=/([?&])_=[^&]*/,Ui=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Fi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Vi=/^(?:GET|HEAD)$/,zi=/^\/\//,Ii=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ji={},Gi={},Wi="*/".concat("*");try{Oi=location.href}catch(qi){Oi=me.createElement("a"),Oi.href="",Oi=Oi.href}Di=Ii.exec(Oi.toLowerCase())||[],oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Oi,type:"GET",isLocal:Fi.test(Di[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?z(z(t,oe.ajaxSettings),e):z(oe.ajaxSettings,t)},ajaxPrefilter:F(ji),ajaxTransport:F(Gi),ajax:function(t,e){function i(t,e,i,n){var r,c,E,v,_,x=e;2!==y&&(y=2,s&&clearTimeout(s),l=void 0,a=n||"",T.readyState=t>0?4:0,r=t>=200&&300>t||304===t,i&&(v=I(u,T,i)),v=j(u,v,T,r),r?(u.ifModified&&(_=T.getResponseHeader("Last-Modified"),_&&(oe.lastModified[o]=_),_=T.getResponseHeader("etag"),_&&(oe.etag[o]=_)),204===t||"HEAD"===u.type?x="nocontent":304===t?x="notmodified":(x=v.state,c=v.data,E=v.error,r=!E)):(E=x,(t||!x)&&(x="error",0>t&&(t=0))),T.status=t,T.statusText=(e||x)+"",r?f.resolveWith(d,[c,x,T]):f.rejectWith(d,[T,x,E]),T.statusCode(g),g=void 0,h&&p.trigger(r?"ajaxSuccess":"ajaxError",[T,u,r?c:E]),m.fireWith(d,[T,x]),h&&(p.trigger("ajaxComplete",[T,u]),--oe.active||oe.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,o,a,s,h,l,c,u=oe.ajaxSetup({},e),d=u.context||u,p=u.context&&(d.nodeType||d.jquery)?oe(d):oe.event,f=oe.Deferred(),m=oe.Callbacks("once memory"),g=u.statusCode||{},E={},v={},y=0,_="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!c)for(c={};e=Ui.exec(a);)c[e[1].toLowerCase()]=e[2];e=c[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return y||(t=v[i]=v[i]||t,E[t]=e),this},overrideMimeType:function(t){return y||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>y)for(e in t)g[e]=[g[e],t[e]];else T.always(t[T.status]);return this},abort:function(t){var e=t||_;return l&&l.abort(e),i(0,e),this}};if(f.promise(T).complete=m.add,T.success=T.done,T.error=T.fail,u.url=((t||u.url||Oi)+"").replace(Bi,"").replace(zi,Di[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=oe.trim(u.dataType||"*").toLowerCase().match(_e)||[""],null==u.crossDomain&&(n=Ii.exec(u.url.toLowerCase()),u.crossDomain=!(!n||n[1]===Di[1]&&n[2]===Di[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Di[3]||("http:"===Di[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=oe.param(u.data,u.traditional)),V(ji,u,e,T),2===y)return T;h=u.global,h&&0===oe.active++&&oe.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Vi.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(Pi.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=Ni.test(o)?o.replace(Ni,"$1_="+Ai++):o+(Pi.test(o)?"&":"?")+"_="+Ai++)),u.ifModified&&(oe.lastModified[o]&&T.setRequestHeader("If-Modified-Since",oe.lastModified[o]),oe.etag[o]&&T.setRequestHeader("If-None-Match",oe.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&T.setRequestHeader("Content-Type",u.contentType),T.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Wi+"; q=0.01":""):u.accepts["*"]);for(r in u.headers)T.setRequestHeader(r,u.headers[r]);if(u.beforeSend&&(u.beforeSend.call(d,T,u)===!1||2===y))return T.abort();_="abort";for(r in{success:1,error:1,complete:1})T[r](u[r]);if(l=V(Gi,u,e,T)){T.readyState=1,h&&p.trigger("ajaxSend",[T,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},u.timeout));try{y=1,l.send(E,i)}catch(x){if(!(2>y))throw x;i(-1,x)}}else i(-1,"No Transport");return T},getJSON:function(t,e,i){return oe.get(t,e,i,"json")},getScript:function(t,e){return oe.get(t,void 0,e,"script")}}),oe.each(["get","post"],function(t,e){oe[e]=function(t,i,n,r){return oe.isFunction(i)&&(r=r||n,n=i,i=void 0),oe.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),oe.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){oe.fn[e]=function(t){return this.on(e,t)}}),oe._evalUrl=function(t){return oe.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},oe.fn.extend({wrapAll:function(t){if(oe.isFunction(t))return this.each(function(e){oe(this).wrapAll(t.call(this,e))});if(this[0]){var e=oe(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return this.each(oe.isFunction(t)?function(e){oe(this).wrapInner(t.call(this,e))}:function(){var e=oe(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=oe.isFunction(t);return this.each(function(i){oe(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}}),oe.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ne.reliableHiddenOffsets()&&"none"===(t.style&&t.style.display||oe.css(t,"display"))},oe.expr.filters.visible=function(t){return!oe.expr.filters.hidden(t)};var Xi=/%20/g,Yi=/\[\]$/,$i=/\r?\n/g,Zi=/^(?:submit|button|image|reset|file)$/i,Ki=/^(?:input|select|textarea|keygen)/i;oe.param=function(t,e){var i,n=[],r=function(t,e){e=oe.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(t)||t.jquery&&!oe.isPlainObject(t))oe.each(t,function(){r(this.name,this.value)});else for(i in t)G(i,t[i],e,r);return n.join("&").replace(Xi,"+")},oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=oe.prop(this,"elements");return t?oe.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!oe(this).is(":disabled")&&Ki.test(this.nodeName)&&!Zi.test(t)&&(this.checked||!Ae.test(t))}).map(function(t,e){var i=oe(this).val();return null==i?null:oe.isArray(i)?oe.map(i,function(t){return{name:e.name,value:t.replace($i,"\r\n")}}):{name:e.name,value:i.replace($i,"\r\n")}}).get()}}),oe.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&W()||q()}:W;var Ji=0,Qi={},tn=oe.ajaxSettings.xhr();t.ActiveXObject&&oe(t).on("unload",function(){for(var t in Qi)Qi[t](void 0,!0)}),ne.cors=!!tn&&"withCredentials"in tn,tn=ne.ajax=!!tn,tn&&oe.ajaxTransport(function(t){if(!t.crossDomain||ne.cors){var e;return{send:function(i,n){var r,o=t.xhr(),a=++Ji;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&o.setRequestHeader(r,i[r]+"");o.send(t.hasContent&&t.data||null),e=function(i,r){var s,h,l;if(e&&(r||4===o.readyState))if(delete Qi[a],e=void 0,o.onreadystatechange=oe.noop,r)4!==o.readyState&&o.abort();else{l={},s=o.status,"string"==typeof o.responseText&&(l.text=o.responseText);try{h=o.statusText}catch(c){h=""}s||!t.isLocal||t.crossDomain?1223===s&&(s=204):s=l.text?200:404}l&&n(s,h,l,o.getAllResponseHeaders())},t.async?4===o.readyState?setTimeout(e):o.onreadystatechange=Qi[a]=e:e()},abort:function(){e&&e(void 0,!0)}}}}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return oe.globalEval(t),t}}}),oe.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),oe.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=me.head||oe("head")[0]||me.documentElement;return{send:function(n,r){e=me.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||r(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var en=[],nn=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=en.pop()||oe.expando+"_"+Ai++;return this[t]=!0,t}}),oe.ajaxPrefilter("json jsonp",function(e,i,n){var r,o,a,s=e.jsonp!==!1&&(nn.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=oe.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(nn,"$1"+r):e.jsonp!==!1&&(e.url+=(Pi.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||oe.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},n.always(function(){t[r]=o,e[r]&&(e.jsonpCallback=i.jsonpCallback,en.push(r)),a&&oe.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),oe.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||me;var n=de.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=oe.buildFragment([t],e,r),r&&r.length&&oe(r).remove(),oe.merge([],n.childNodes))};var rn=oe.fn.load;oe.fn.load=function(t,e,i){if("string"!=typeof t&&rn)return rn.apply(this,arguments);var n,r,o,a=this,s=t.indexOf(" ");return s>=0&&(n=t.slice(s,t.length),t=t.slice(0,s)),oe.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&oe.ajax({url:t,type:o,dataType:"html",data:e}).done(function(t){r=arguments,a.html(n?oe("<div>").append(oe.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){a.each(i,r||[t.responseText,e,t])}),this},oe.expr.filters.animated=function(t){return oe.grep(oe.timers,function(e){return t===e.elem}).length};var on=t.document.documentElement;oe.offset={setOffset:function(t,e,i){var n,r,o,a,s,h,l,c=oe.css(t,"position"),u=oe(t),d={};"static"===c&&(t.style.position="relative"),s=u.offset(),o=oe.css(t,"top"),h=oe.css(t,"left"),l=("absolute"===c||"fixed"===c)&&oe.inArray("auto",[o,h])>-1,l?(n=u.position(),a=n.top,r=n.left):(a=parseFloat(o)||0,r=parseFloat(h)||0),oe.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(d.top=e.top-s.top+a),null!=e.left&&(d.left=e.left-s.left+r),"using"in e?e.using.call(t,d):u.css(d)}},oe.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){oe.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return e=o.documentElement,oe.contains(e,r)?(typeof r.getBoundingClientRect!==Re&&(n=r.getBoundingClientRect()),i=X(o),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===oe.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),oe.nodeName(t[0],"html")||(i=t.offset()),i.top+=oe.css(t[0],"borderTopWidth",!0),i.left+=oe.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-oe.css(n,"marginTop",!0),left:e.left-i.left-oe.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||on;t&&!oe.nodeName(t,"html")&&"static"===oe.css(t,"position");)t=t.offsetParent;return t||on})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);oe.fn[t]=function(n){return Le(this,function(t,n,r){var o=X(t);return void 0===r?o?e in o?o[e]:o.document.documentElement[n]:t[n]:void(o?o.scrollTo(i?oe(o).scrollLeft():r,i?r:oe(o).scrollTop()):t[n]=r)},t,n,arguments.length,null)}}),oe.each(["top","left"],function(t,e){oe.cssHooks[e]=H(ne.pixelPosition,function(t,i){return i?(i=ii(t,e),ri.test(i)?oe(t).position()[e]+"px":i):void 0})}),oe.each({Height:"height",Width:"width"},function(t,e){oe.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){oe.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||r===!0?"margin":"border");return Le(this,function(e,i,n){var r;return oe.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?oe.css(e,i,a):oe.style(e,i,n,a)},e,o?n:void 0,o,null)}})}),oe.fn.size=function(){return this.length},oe.fn.andSelf=oe.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return oe
});var an=t.jQuery,sn=t.$;return oe.noConflict=function(e){return t.$===oe&&(t.$=sn),e&&t.jQuery===oe&&(t.jQuery=an),oe},typeof e===Re&&(t.jQuery=t.$=oe),oe}),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,n,r){t.Backbone=e(t,r,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");e(t,exports,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,i,n){{var r=t.Backbone,o=[],a=(o.push,o.slice);o.splice}e.VERSION="1.1.2",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=e.Events={on:function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!l(this,"once",t,[e,n])||!e)return this;var r=this,o=i.once(function(){r.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,n)},off:function(t,e,n){var r,o,a,s,h,c,u,d;if(!this._events||!l(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(s=t?[t]:i.keys(this._events),h=0,c=s.length;c>h;h++)if(t=s[h],a=this._events[t]){if(this._events[t]=r=[],e||n)for(u=0,d=a.length;d>u;u++)o=a[u],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var o=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t._listenId]=t);for(var a in r)t=r[a],t.off(e,n,this),(o||i.isEmpty(t._events))&&delete this._listeningTo[a];return this}},h=/\s+/,l=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(h.test(i)){for(var o=i.split(h),a=0,s=o.length;s>a;a++)t[e].apply(t,[o[a]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,a);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,o,a,s);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}},u={listenTo:"on",listenToOnce:"once"};i.each(u,function(t,e){s[e]=function(e,n,r){var o=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=i.uniqueId("l"));return o[a]=e,r||"object"!=typeof n||(r=this),e[t](n,r,this),this}}),s.bind=s.on,s.unbind=s.off,i.extend(e,s);var d=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,s,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,o,a,s,h,l,c,u;if(null==t)return this;if("object"==typeof t?(o=t,n=e):(o={})[t]=e,n||(n={}),!this._validate(o,n))return!1;a=n.unset,h=n.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={}),u=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)e=o[r],i.isEqual(u[r],e)||s.push(r),i.isEqual(c[r],e)?delete this.changed[r]:this.changed[r]=e,a?delete u[r]:u[r]=e;if(!h){s.length&&(this._pending=n);for(var d=0,p=s.length;p>d;d++)this.trigger("change:"+s[d],this,u[s[d]],n)}if(l)return this;if(!h)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in t)i.isEqual(r[o],e=t[o])||((n||(n={}))[o]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},N(this,t),this.sync("read",this,t)},save:function(t,e,n){var r,o,a,s=this.attributes;if(null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},s,r)),void 0===n.parse&&(n.parse=!0);var h=this,l=n.success;return n.success=function(t){h.attributes=s;var e=h.parse(t,n);return n.wait&&(e=i.extend(r||{},e)),i.isObject(e)&&!h.set(e,n)?!1:(l&&l(h,t,n),void h.trigger("sync",h,t,n))},N(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=r),a=this.sync(o,this,n),r&&n.wait&&(this.attributes=s),a},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&r(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;N(this,t);var o=this.sync("delete",this,t);return t.wait||r(),o},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||B();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(t){d.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,s,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,g))},remove:function(t,e){var n=!i.isArray(t);t=n?[t]:i.clone(t),e||(e={});var r,o,a,s;for(r=0,o=t.length;o>r;r++)s=t[r]=this.get(t[r]),s&&(delete this._byId[s.id],delete this._byId[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,e.silent||(e.index=a,s.trigger("remove",s,this,e)),this._removeReference(s,e));return n?t[0]:t},set:function(t,e){e=i.defaults({},e,m),e.parse&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?t?[t]:[]:i.clone(t);var r,o,a,s,h,l,c,u=e.at,p=this.model,f=this.comparator&&null==u&&e.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,E=[],v=[],y={},_=e.add,T=e.merge,x=e.remove,b=!f&&_&&x?[]:!1;for(r=0,o=t.length;o>r;r++){if(h=t[r]||{},a=h instanceof d?s=h:h[p.prototype.idAttribute||"id"],l=this.get(a))x&&(y[l.cid]=!0),T&&(h=h===s?s.attributes:h,e.parse&&(h=l.parse(h,e)),l.set(h,e),f&&!c&&l.hasChanged(g)&&(c=!0)),t[r]=l;else if(_){if(s=t[r]=this._prepareModel(h,e),!s)continue;E.push(s),this._addReference(s,e)}s=l||s,!b||!s.isNew()&&y[s.id]||b.push(s),y[s.id]=!0}if(x){for(r=0,o=this.length;o>r;++r)y[(s=this.models[r]).cid]||v.push(s);v.length&&this.remove(v,e)}if(E.length||b&&b.length)if(f&&(c=!0),this.length+=E.length,null!=u)for(r=0,o=E.length;o>r;r++)this.models.splice(u+r,0,E[r]);else{b&&(this.models.length=0);var R=b||E;for(r=0,o=R.length;o>r;r++)this.models.push(R[r])}if(c&&this.sort({silent:!0}),!e.silent){for(r=0,o=E.length;o>r;r++)(s=E[r]).trigger("add",s,this,e);(c||b&&b.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},N(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(t,i){e.wait&&n.add(t,e),r&&r(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var E=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(E,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var v=["groupBy","countBy","sortBy","indexBy"];i.each(v,function(t){f.prototype[t]=function(e,n){var r=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,r,n)}});var y=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,T)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},_=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];i.extend(y.prototype,s,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var r=e.match(_),o=r[1],a=r[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,n):this.$el.on(o,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,r){var o=b[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:o,dataType:"json"};if(r.url||(a.url=i.result(n,"url")||B()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",r.emulateJSON&&(a.data._method=o);var s=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&x&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var h=r.xhr=e.ajax(i.extend(a,r));return n.trigger("request",n,h,r),h};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),b={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var R=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},w=/\((.*?)\)/g,H=/(\(\?)?:\w+/g,M=/\*\w+/g,S=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(R.prototype,s,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return e.history.route(t,function(i){var a=o._extractParameters(t,i);o.execute(r,a),o.trigger.apply(o,["route:"+n].concat(a)),o.trigger("route",n,a),e.history.trigger("route",o,n,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(S,"\\$&").replace(w,"(?:$1)?").replace(H,function(t,e){return e?t:"([^/?]+)"}).replace(M,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var C=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,P=/msie [\w.]+/,k=/\/$/,D=/#.*$/;C.started=!1,i.extend(C.prototype,s,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(k,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace(L,"")},start:function(t){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,o=P.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(A,"/"),o&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&s.hash&&(this.fragment=this.getHash().replace(L,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),C.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!C.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(D,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new C;var O=function(t,e){var n,r=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e);var o=function(){this.constructor=n};return o.prototype=r.prototype,n.prototype=new o,t&&i.extend(n.prototype,t),n.__super__=r.prototype,n};d.extend=f.extend=R.extend=y.extend=C.extend=O;var B=function(){throw new Error('A "url" property or function must be specified')},N=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};return e}),function(t,e){if("function"==typeof define&&define.amd)define("marionette",["backbone","underscore"],function(i,n){return t.Marionette=t.Mn=e(t,i,n)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=e(t,i,n)}else t.Marionette=t.Mn=e(t,t.Backbone,t._)}(this,function(t,e,i){"use strict";!function(t,e){var i=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var i=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(i.prototype,{add:function(t,e){var i=t.cid;return this._views[i]=t,t.model&&(this._indexByModel[t.model.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var i=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){return t===i?(delete this._indexByCustom[e],!0):void 0},this),delete this._views[i],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,i){e.each(this._views,function(n){e.isFunction(n[t])&&n[t].apply(n,i||[])})},_updateLength:function(){this.length=e.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return e.each(n,function(t){i.prototype[t]=function(){var i=e.values(this._views),n=[i].concat(e.toArray(arguments));return e[t].apply(e,n)}}),i}(t,e),t.ChildViewContainer.VERSION="0.1.6",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=i,this},t.ChildViewContainer}(e,i),function(t,e){var i=t.Wreqr,n=t.Wreqr={};return t.Wreqr.VERSION="1.3.1",t.Wreqr.noConflict=function(){return t.Wreqr=i,this},n.Handlers=function(t,e){var i=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events,{setHandlers:function(t){e.each(t,function(t,i){var n=null;e.isObject(t)&&!e.isFunction(t)&&(n=t.context,t=t.callback),this.setHandler(i,t,n)},this)},setHandler:function(t,e,i){var n={callback:e,context:i};this._wreqrHandlers[t]=n,this.trigger("handler:add",t,e,i)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){var t=Array.prototype.slice.apply(arguments);return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(t,e),n.CommandStorage=function(){var i=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(i.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var i=this.getCommands(t);i.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),i}(),n.Commands=function(t){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);t.Handlers.prototype.constructor.apply(this,i)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,i,n){var r=this.storage.getCommands(t);e.each(r.instances,function(t){i.apply(n,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var i,n=t.storageType||this.storageType;i=e.isFunction(n)?new n:n,this.storage=i}})}(n),n.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.hasHandler(t)?this.getHandler(t).apply(this,e):void 0}})}(n),n.EventAggregator=function(t,e){var i=function(){};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events),i}(t,e),n.Channel=function(){var i=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,i,n){if(i){n=n||this;var r="vent"===t?"on":"setHandler";e.each(i,function(i,o){this[t][r](o,e.bind(i,n))},this)}}}),i}(n),n.radio=function(t){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(i.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var i=this._channels[e];return i||(i=new t.Channel(e),this._channels[e]=i),i},_proxyMethods:function(){e.each(["vent","commands","reqres"],function(t){e.each(n[t],function(e){this[t][e]=r(this,t,e)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(t,e,i){return function(n){var r=t._getChannel(n)[e],o=Array.prototype.slice.call(arguments,1);return r[i].apply(r,o)}};return new i}(n),t.Wreqr}(e,i);var n=t.Marionette,r=t.Mn,o=e.Marionette={};o.VERSION="2.4.1",o.noConflict=function(){return t.Marionette=n,t.Mn=r,this},e.Marionette=o,o.Deferred=e.$.Deferred,o.extend=e.Model.extend,o.isNodeAttached=function(t){return e.$.contains(document.documentElement,t)},o.mergeOptions=function(t,e){t&&i.extend(this,i.pick(t,e))},o.getOption=function(t,e){return t&&e?t.options&&void 0!==t.options[e]?t.options[e]:t[e]:void 0},o.proxyGetOption=function(t){return o.getOption(this,t)},o._getValue=function(t,e,n){return i.isFunction(t)&&(t=n?t.apply(e,n):t.call(e)),t},o.normalizeMethods=function(t){return i.reduce(t,function(t,e,n){return i.isFunction(e)||(e=this[e]),e&&(t[n]=e),t},{},this)},o.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(t){return e[t.slice(4)]})},o.normalizeUIKeys=function(t,e){return i.reduce(t,function(t,i,n){var r=o.normalizeUIString(n,e);return t[r]=i,t},{})},o.normalizeUIValues=function(t,e,n){return i.each(t,function(r,a){i.isString(r)?t[a]=o.normalizeUIString(r,e):i.isObject(r)&&i.isArray(n)&&(i.extend(r,o.normalizeUIValues(i.pick(r,n),e)),i.each(n,function(t){var n=r[t];i.isString(n)&&(r[t]=o.normalizeUIString(n,e))}))}),t},o.actAsCollection=function(t,e){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];i.each(n,function(n){t[n]=function(){var t=i.values(i.result(this,e)),r=[t].concat(i.toArray(arguments));return i[n].apply(i,r)}})};var a=o.deprecate=function(t,e){i.isObject(t)&&(t=t.prev+" is going to be removed in the future. Please use "+t.next+" instead."+(t.url?" See: "+t.url:"")),void 0!==e&&e||a._cache[t]||(a._warn("Deprecation warning: "+t),a._cache[t]=!0)};a._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},a._cache={},o._triggerMethod=function(){function t(t,e,i){return i.toUpperCase()}var e=/(^|:)(\w)/gi;return function(n,r,o){var a=arguments.length<3;a&&(o=r,r=o[0]);var s,h="on"+r.replace(e,t),l=n[h];return i.isFunction(l)&&(s=l.apply(n,a?i.rest(o):o)),i.isFunction(n.trigger)&&(a+o.length>1?n.trigger.apply(n,a?o:[r].concat(i.drop(o,0))):n.trigger(r)),s}}(),o.triggerMethod=function(){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(t){var e=i.isFunction(t.triggerMethod)?t.triggerMethod:o.triggerMethod;return e.apply(t,i.rest(arguments))},o.MonitorDOMRefresh=function(t){function e(){t._isShown=!0,r()}function n(){t._isRendered=!0,r()}function r(){t._isShown&&t._isRendered&&o.isNodeAttached(t.el)&&i.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}t.on({show:e,render:n})},function(t){function e(e,n,r,o){var a=o.split(/\s+/);i.each(a,function(i){var o=e[i];if(!o)throw new t.Error('Method "'+i+'" was configured as an event handler, but does not exist.');e.listenTo(n,r,o)})}function n(t,e,i,n){t.listenTo(e,i,n)}function r(t,e,n,r){var o=r.split(/\s+/);i.each(o,function(i){var r=t[i];t.stopListening(e,n,r)})}function o(t,e,i,n){t.stopListening(e,i,n)}function a(e,n,r,o,a){if(n&&r){if(!i.isObject(r))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=t._getValue(r,e),i.each(r,function(t,r){i.isFunction(t)?o(e,n,r,t):a(e,n,r,t)})}}t.bindEntityEvents=function(t,i,r){a(t,i,r,n,e)},t.unbindEntityEvents=function(t,e,i){a(t,e,i,o,r)},t.proxyBindEntityEvents=function(e,i){return t.bindEntityEvents(this,e,i)},t.proxyUnbindEntityEvents=function(e,i){return t.unbindEntityEvents(this,e,i)}}(o);var s=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(t,e){i.isObject(t)?(e=t,t=e.message):e||(e={});var n=Error.call(this,t);i.extend(this,i.pick(n,s),i.pick(e,s)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},i.extend(o.Callbacks.prototype,{add:function(t,e){var n=i.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),n.then(function(i){e&&(i.context=e),t.call(i.context,i.options)})},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],i.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.options=t||{},i.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,i.extend(o.Controller.prototype,e.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(t){this.options=i.extend({},i.result(this,"options"),t),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,i.extend(o.Object.prototype,e.Events,{initialize:function(){},destroy:function(){return this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,t)},show:function(t,e){if(this._ensureElement()){this._ensureViewIsIntact(t);var i=e||{},n=t!==this.currentView,r=!!i.preventDestroy,a=!!i.forceShow,s=!!this.currentView,h=n&&!r,l=n||a;if(s&&this.triggerMethod("before:swapOut",this.currentView,this,e),this.currentView&&delete this.currentView._parent,h?this.empty():s&&l&&this.currentView.off("destroy",this.empty,this),l){t.once("destroy",this.empty,this),t.render(),t._parent=this,s&&this.triggerMethod("before:swap",t,this,e),this.triggerMethod("before:show",t,this,e),o.triggerMethodOn(t,"before:show",t,this,e),s&&this.triggerMethod("swapOut",this.currentView,this,e);var c=o.isNodeAttached(this.el),u=[],d=i.triggerBeforeAttach||this.triggerBeforeAttach,p=i.triggerAttach||this.triggerAttach;return c&&d&&(u=this._displayedViews(t),this._triggerAttach(u,"before:")),this.attachHtml(t),this.currentView=t,c&&p&&(u=this._displayedViews(t),this._triggerAttach(u)),s&&this.triggerMethod("swap",t,this,e),this.triggerMethod("show",t,this,e),o.triggerMethodOn(t,"show",t,this,e),this
}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(t,e){var n=(e||"")+"attach";i.each(t,function(t){o.triggerMethodOn(t,n,t,this)},this)},_displayedViews:function(t){return i.union([t],i.result(t,"_getNestedViews")||[])},_ensureElement:function(){if(i.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(t){if(!t)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t,o._getValue(this.options.parentEl,this))},attachHtml:function(t){this.$el.contents().detach(),this.el.appendChild(t.el)},empty:function(t){var e=this.currentView,i=o._getValue(t,"preventDestroy",this);return e?(e.off("destroy",this.empty,this),this.triggerMethod("before:empty",e),i||this._destroyView(),this.triggerMethod("empty",e),delete this.currentView,i&&this.$el.contents().detach(),this):void 0},_destroyView:function(){var t=this.currentView;t.destroy&&!t.isDestroyed?t.destroy():t.remove&&(t.remove(),t.isDestroyed=!0)},attachView:function(t){return this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(t,e){if(i.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(i.isFunction(t))return this._buildRegionFromRegionClass(t);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,e){var n=t.regionClass||e,r=i.omit(t,"selector","regionClass");return t.selector&&!r.el&&(r.el=t.selector),new n(r)},_buildRegionFromRegionClass:function(t){return new t}}),o.RegionManager=o.Controller.extend({constructor:function(t){this._regions={},this.length=0,o.Controller.call(this,t),this.addRegions(this.getOption("regions"))},addRegions:function(t,e){return t=o._getValue(t,this,arguments),i.reduce(t,function(t,n,r){return i.isString(n)&&(n={selector:n}),n.selector&&(n=i.defaults({},n,e)),t[r]=this.addRegion(r,n),t},{},this)},addRegion:function(t,e){var i;return i=e instanceof o.Region?e:o.Region.buildRegion(e,o.Region),this.triggerMethod("before:add:region",t,i),i._parent=this,this._store(t,i),this.triggerMethod("add:region",t,i),i},get:function(t){return this._regions[t]},getRegions:function(){return i.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return i.each(this._regions,function(t,e){this._remove(e,t)},this),t},emptyRegions:function(){var t=this.getRegions();return i.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]||this.length++,this._regions[t]=e},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete e._parent,delete this._regions[t],this.length--,this.triggerMethod("remove:region",t,e)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(t){this.templateId=t},i.extend(o.TemplateCache,{templateCaches:{},get:function(t,e){var i=this.templateCaches[t];return i||(i=new o.TemplateCache(t),this.templateCaches[t]=i),i.load(e)},clear:function(){var t,e=i.toArray(arguments),n=e.length;if(n>0)for(t=0;n>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),i.extend(o.TemplateCache.prototype,{load:function(t){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId,t);return this.compiledTemplate=this.compileTemplate(e,t),this.compiledTemplate},loadTemplate:function(t){var i=e.$(t).html();if(!i||0===i.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return i},compileTemplate:function(t,e){return i.template(t,e)}}),o.Renderer={render:function(t,e){if(!t)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n=i.isFunction(t)?t:o.TemplateCache.get(t);return n(e)}},o.View=e.View.extend({isDestroyed:!1,constructor:function(t){i.bindAll(this,"render"),t=o._getValue(t,this),this.options=i.extend({},i.result(this,"options"),t),this._behaviors=o.Behaviors(this),e.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,i.rest(arguments))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return e=o._getValue(e,this),i.extend(t,e)},normalizeUIKeys:function(t){var e=i.result(this,"_uiBindings");return o.normalizeUIKeys(t,e||i.result(this,"ui"))},normalizeUIValues:function(t,e){var n=i.result(this,"ui"),r=i.result(this,"_uiBindings");return o.normalizeUIValues(t,r||n,e)},configureTriggers:function(){if(this.triggers){var t=this.normalizeUIKeys(i.result(this,"triggers"));return i.reduce(t,function(t,e,i){return t[i]=this._buildViewTrigger(e),t},{},this)}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var n=o._getValue(t||this.events,this);n=this.normalizeUIKeys(n),i.isUndefined(t)&&(this.events=n);var r={},a=i.result(this,"behaviorEvents")||{},s=this.configureTriggers(),h=i.result(this,"behaviorTriggers")||{};i.extend(r,a,n,s,h),e.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return e.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),i.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var t=i.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.isRendered=!1,this.remove(),i.invoke(this._behaviors,"destroy",t),this},bindUIElements:function(){this._bindUIElements(),i.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=i.result(this,"_uiBindings");this.ui={},i.each(t,function(t,e){this.ui[e]=this.$(t)},this)}},unbindUIElements:function(){this._unbindUIElements(),i.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=i.isObject(t),n=i.defaults({},e?t:{},{preventDefault:!0,stopPropagation:!0}),r=e?n.event:t;return function(t){t&&(t.preventDefault&&n.preventDefault&&t.preventDefault(),t.stopPropagation&&n.stopPropagation&&t.stopPropagation());var e={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,e)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return i.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],i.rest(arguments)),t},_triggerEventOnBehaviors:function(t){for(var e=o._triggerMethod,i=this._behaviors,n=0,r=i&&i.length;r>n;n++)e(i[n],t)},_triggerEventOnParentLayout:function(t,e){var n=this._parentLayoutView();if(n){var r=o.getOption(n,"childViewEventPrefix"),a=r+":"+t;o._triggerMethod(n,[a,this].concat(e));var s=o.getOption(n,"childEvents"),h=n.normalizeMethods(s);h&&i.isFunction(h[t])&&h[t].apply(n,[this].concat(e))}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var t=this._getImmediateChildren();return t.length?i.reduce(t,function(t,e){return e._getNestedViews?t.concat(e._getNestedViews()):t},t):t},_getAncestors:function(){for(var t=[],e=this._parent;e;)t.push(e),e=e._parent;return t},_parentLayoutView:function(){var t=this._getAncestors();return i.find(t,function(t){return t instanceof o.LayoutView})},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var t=[this.model||this.collection];return arguments.length&&t.push.apply(t,arguments),this.model?this.serializeModel.apply(this,t):{items:this.serializeCollection.apply(this,t)}},serializeCollection:function(t){return t.toJSON.apply(t,i.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(t!==!1){if(!t)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.mixinTemplateHelpers(this.serializeData()),i=o.Renderer.render(t,e,this);return this.attachElContent(i),this}},attachElContent:function(t){return this.$el.html(t),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on("show",this._onShowCalled),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&i.each(this._bufferedChildren,i.partial(this._triggerMethodOnChild,"before:show"))},_triggerShowBufferedChildren:function(){this._isShown&&(i.each(this._bufferedChildren,i.partial(this._triggerMethodOnChild,"show")),this._bufferedChildren=[])},_triggerMethodOnChild:function(t,e){o.triggerMethodOn(e,t)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t,e,n){var r;if(r=void 0!==n.at?n.at:i.indexOf(this._filteredSortedModels(),t),this._shouldAddChild(t,r)){this.destroyEmptyView();var o=this.getChildView(t);this.addChild(t,o,r)}},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},_onShowCalled:function(){this.children.each(i.partial(this._triggerMethodOnChild,"show"))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var t=this.children,e=this._filteredSortedModels(),n=i.find(e,function(e){return!t.findByModel(e)});if(n)this.render();else{var r=i.map(e,function(e){return t.findByModel(e).el});this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var t=this._filteredSortedModels(),e=i.find(t,function(t,e){var i=this.children.findByModel(t);return!i||i._index!==e},this);e&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(t){this.$el.append(t)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.showEmptyView())},showCollection:function(){var t,e=this._filteredSortedModels();i.each(e,function(e,i){t=this.getChildView(e),this.addChild(e,t,i)},this)},_filteredSortedModels:function(){var t,e=this.getViewComparator();return t=e?i.isString(e)||1===e.length?this.collection.sortBy(e,this):i.clone(this.collection.models).sort(i.bind(e,this)):this.collection.models,this.getOption("filter")&&(t=i.filter(t,function(t,e){return this._shouldAddChild(t,e)},this)),t},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var i=new e.Model;this.addEmptyView(i,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var n=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");i.isFunction(n)&&(n=n.call(this,t,this._emptyViewIndex));var r=this.buildChildView(t,e,n);r._parent=this,this.proxyChildEvents(r),this._isShown&&o.triggerMethodOn(r,"before:show"),this.children.add(r),this.renderChildView(r,this._emptyViewIndex),this._isShown&&o.triggerMethodOn(r,"show")},getChildView:function(){var t=this.getOption("childView");if(!t)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(t,e,i){var n=this.getOption("childViewOptions");n=o._getValue(n,this,[t,i]);var r=this.buildChildView(t,e,n);return this._updateIndices(r,!0,i),this._addChildView(r,i),r._parent=this,r},_updateIndices:function(t,e,i){this.getOption("sort")&&(e&&(t._index=i),this.children.each(function(i){i._index>=t._index&&(i._index+=e?1:-1)}))},_addChildView:function(t,e){this.proxyChildEvents(t),this.triggerMethod("before:add:child",t),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"before:show"),this.children.add(t),this.renderChildView(t,e),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"show"),this.triggerMethod("add:child",t)},renderChildView:function(t,e){return t.render(),this.attachHtml(this,t,e),t},buildChildView:function(t,e,n){var r=i.extend({model:t},n);return new e(r)},removeChildView:function(t){return t&&(this.triggerMethod("before:remove:child",t),t.destroy?t.destroy():t.remove&&t.remove(),delete t._parent,this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1)),t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t){t.$el.append(this._createBuffer(t))},_createBuffer:function(t){var e=document.createDocumentFragment();return i.each(t._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(t,e,i){t.isBuffering?t._bufferedChildren.splice(i,0,e):t._insertBefore(e,i)||t._insertAfter(e)},_insertBefore:function(t,e){var i,n=this.getOption("sort")&&e<this.children.length-1;return n&&(i=this.children.find(function(t){return t._index===e+1})),i?(i.$el.before(t.el),!0):!1},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(){var t=this.children.map(i.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),t},_shouldAddChild:function(t,e){var n=this.getOption("filter");return!i.isFunction(n)||n.call(this,t,e,this.collection)},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",function(){var n=i.toArray(arguments),r=n[0],o=this.normalizeMethods(i.result(this,"childEvents"));n[0]=e+":"+r,n.splice(1,0,t),"undefined"!=typeof o&&i.isFunction(o[r])&&o[r].apply(this,n.slice(1)),this.triggerMethod.apply(this,n)})},_getImmediateChildren:function(){return i.values(this.children._views)},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var t={};return this.model&&(t=i.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),i=o.Renderer.render(e,t,this);this.attachElContent(i),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t){var e=this.getChildViewContainer(t);e.append(this._createBuffer(t))},_insertAfter:function(t){var e=this.getChildViewContainer(this,t);e.append(t.el)},_appendReorderedChildren:function(t){var e=this.getChildViewContainer(this);e.append(t)},getChildViewContainer:function(t){if("$childViewContainer"in t)return t.$childViewContainer;var e,i=o.getOption(t,"childViewContainer");if(i){var n=o._getValue(i,t);if(e="@"===n.charAt(0)&&t.ui?t.ui[n.substr(4)]:t.$(n),e.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else e=t.$el;return t.$childViewContainer=e,e},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(t,e){return this.getRegion(t).show(e)},getChildView:function(t){return this.getRegion(t).currentView},addRegion:function(t,e){var i={};return i[t]=e,this._buildRegions(i)[t]},addRegions:function(t){return this.regions=i.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e={regionClass:this.getOption("regionClass"),parentEl:i.partial(i.result,this,"el")};return this.regionManager.addRegions(t,e)},_initializeRegions:function(t){var e;this._initRegionManager(),e=o._getValue(this.regions,this,[t])||{};var n=this.getOption.call(t,"regions");n=o._getValue(n,this,[t]),i.extend(e,n),e=this.normalizeUIValues(e,["selector","el"]),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this.regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this.regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this.regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})},_getImmediateChildren:function(){return i.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(t,e){this.view=e,this.defaults=i.result(this,"defaults")||{},this.options=i.extend({},this.defaults,t),this.ui=i.extend({},i.result(e,"ui"),i.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el}}),o.Behaviors=function(t,e){function i(t,n){return e.isObject(t.behaviors)?(n=i.parseBehaviors(t,n||e.result(t,"behaviors")),i.wrap(t,n,e.keys(a)),n):{}}function n(t,e){this._view=t,this._behaviors=e,this._triggers={}}function r(t){return t._uiBindings||t.ui}var o=/^(\S+)\s*(.*)$/,a={behaviorTriggers:function(t,e){var i=new n(this,e);return i.buildBehaviorTriggers()},behaviorEvents:function(i,n){var a={};return e.each(n,function(i,n){var s={},h=e.clone(e.result(i,"events"))||{};h=t.normalizeUIKeys(h,r(i));var l=0;e.each(h,function(t,r){var a=r.match(o),h=a[1]+"."+[this.cid,n,l++," "].join(""),c=a[2],u=h+c,d=e.isFunction(t)?t:i[t];s[u]=e.bind(d,i)},this),a=e.extend(a,s)},this),a}};return e.extend(i,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(e,n){return e.behaviorClass?e.behaviorClass:t._getValue(i.behaviorsLookup,this,[e,n])[n]},parseBehaviors:function(t,n){return e.chain(n).map(function(n,r){var o=i.getBehaviorClass(n,r),a=new o(n,t),s=i.parseBehaviors(t,e.result(a,"behaviors"));return[a].concat(s)}).flatten().value()},wrap:function(t,i,n){e.each(n,function(n){t[n]=e.partial(a[n],t[n],i)})}}),e.extend(n.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(i,n){var o=e.clone(e.result(i,"triggers"))||{};o=t.normalizeUIKeys(o,r(i)),e.each(o,e.bind(this._setHandlerForBehavior,this,i,n))},_setHandlerForBehavior:function(t,e,i,n){var r=n.replace(/^\S+/,function(t){return t+".behaviortriggers"+e});this._triggers[r]=this._view._buildViewTrigger(i)}}),i}(o,i),o.AppRouter=e.Router.extend({constructor:function(t){this.options=t||{},e.Router.apply(this,arguments);var i=this.getOption("appRoutes"),n=this._getController();this.processAppRoutes(n,i),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var i=this._getController();this._addAppRoute(i,t,e)},_processOnRoute:function(t,e){if(i.isFunction(this.onRoute)){var n=i.invert(this.getOption("appRoutes"))[t];this.onRoute(t,n,e)}},processAppRoutes:function(t,e){if(e){var n=i.keys(e).reverse();i.each(n,function(i){this._addAppRoute(t,i,e[i])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,n){var r=t[n];if(!r)throw new o.Error('Method "'+n+'" was not found on the controller');this.route(e,n,i.bind(r,t))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(t){this._initializeRegions(t),this._initCallbacks=new o.Callbacks,this.submodules={},i.extend(this,t),this._initChannel(),o.Object.call(this,t)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var n=o.Module.getClass(e),r=i.toArray(arguments);return r.unshift(this),n.create.apply(n,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(t){var e=i.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var n=o.getOption(t,"regions");return i.isFunction(n)&&(n=n.call(this,t)),i.extend(e,n),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(t,e){this[t]=e,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(t){delete this[t],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=i.result(this,"channelName")||"global",this.channel=i.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=i.result(this,"vent")||this.channel.vent,this.commands=i.result(this,"commands")||this.channel.commands,this.reqres=i.result(this,"reqres")||this.channel.reqres}}),o.Module=function(t,e,n){this.moduleName=t,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,i.isFunction(this.initialize)&&this.initialize(t,e,this.options)},o.Module.extend=o.extend,i.extend(o.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(i.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),i.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,n){if(t){var r=i.flatten([this,this.app,e,o,e.$,i,n]);t.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),i.extend(o.Module,{create:function(t,e,n){var r=t,o=i.drop(arguments,3);e=e.split(".");var a=e.length,s=[];return s[a-1]=n,i.each(e,function(e,i){var a=r;r=this._getModule(a,e,t,n),this._addModuleDefinition(a,r,s[i],o)},this),r},_getModule:function(t,e,n,r){var o=i.extend({},r),a=this.getClass(r),s=t[e];return s||(s=new a(e,n,o),t[e]=s,t.submodules[e]=s),s},getClass:function(t){var e=o.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,i,n){var r=this._getDefine(i),o=this._getStartWithParent(i,e);r&&e.addDefinition(r,n),this._addStartWithParent(t,e,o)},_getStartWithParent:function(t,e){var n;return i.isFunction(t)&&t.prototype instanceof o.Module?(n=e.constructor.prototype.startWithParent,i.isUndefined(n)?!0:n):i.isObject(t)?(n=t.startWithParent,i.isUndefined(n)?!0:n):!0},_getDefine:function(t){return!i.isFunction(t)||t.prototype instanceof o.Module?i.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,i){e.startWithParent=e.startWithParent&&i,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o}),function(t,e){"function"==typeof define&&define.amd?define("handlebars",[],e):"object"==typeof exports?module.exports=e():t.Handlebars=t.Handlebars||e()}(this,function(){var t=function(){"use strict";function t(t){this.string=t}var e;return t.prototype.toString=function(){return""+this.string},e=t}(),e=function(t){"use strict";function e(t){return h[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var i in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],i)&&(t[i]=arguments[e][i]);return t}function n(t){return t instanceof s?t.toString():null==t?"":t?(t=""+t,c.test(t)?t.replace(l,e):t):t+""}function r(t){return t||0===t?p(t)&&0===t.length?!0:!1:!0}function o(t,e){return(t?t+".":"")+e}var a={},s=t,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/;a.extend=i;var u=Object.prototype.toString;a.toString=u;var d=function(t){return"function"==typeof t};d(/x/)&&(d=function(t){return"function"==typeof t&&"[object Function]"===u.call(t)});var d;a.isFunction=d;var p=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===u.call(t):!1};return a.isArray=p,a.escapeExpression=n,a.isEmpty=r,a.appendContextPath=o,a}(t),i=function(){"use strict";function t(t,e){var n;e&&e.firstLine&&(n=e.firstLine,t+=" - "+n+":"+e.firstColumn);for(var r=Error.prototype.constructor.call(this,t),o=0;o<i.length;o++)this[i[o]]=r[i[o]];n&&(this.lineNumber=n,this.column=e.firstColumn)}var e,i=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,e=t}(),n=function(t,e){"use strict";function i(t,e){this.helpers=t||{},this.partials=e||{},n(this)}function n(t){t.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new a("Missing helper: '"+arguments[arguments.length-1].name+"'")}),t.registerHelper("blockHelperMissing",function(e,i){var n=i.inverse,r=i.fn;if(e===!0)return r(this);if(e===!1||null==e)return n(this);if(c(e))return e.length>0?(i.ids&&(i.ids=[i.name]),t.helpers.each(e,i)):n(this);if(i.data&&i.ids){var a=g(i.data);a.contextPath=o.appendContextPath(i.data.contextPath,i.name),i={data:a}}return r(e,i)}),t.registerHelper("each",function(t,e){if(!e)throw new a("Must pass iterator to #each");var i,n,r=e.fn,s=e.inverse,h=0,l="";if(e.data&&e.ids&&(n=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),u(t)&&(t=t.call(this)),e.data&&(i=g(e.data)),t&&"object"==typeof t)if(c(t))for(var d=t.length;d>h;h++)i&&(i.index=h,i.first=0===h,i.last=h===t.length-1,n&&(i.contextPath=n+h)),l+=r(t[h],{data:i});
else for(var p in t)t.hasOwnProperty(p)&&(i&&(i.key=p,i.index=h,i.first=0===h,n&&(i.contextPath=n+p)),l+=r(t[p],{data:i}),h++);return 0===h&&(l=s(this)),l}),t.registerHelper("if",function(t,e){return u(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),t.registerHelper("with",function(t,e){u(t)&&(t=t.call(this));var i=e.fn;if(o.isEmpty(t))return e.inverse(this);if(e.data&&e.ids){var n=g(e.data);n.contextPath=o.appendContextPath(e.data.contextPath,e.ids[0]),e={data:n}}return i(t,e)}),t.registerHelper("log",function(e,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;t.log(n,e)}),t.registerHelper("lookup",function(t,e){return t&&t[e]})}var r={},o=t,a=e,s="2.0.0";r.VERSION=s;var h=6;r.COMPILER_REVISION=h;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};r.REVISION_CHANGES=l;var c=o.isArray,u=o.isFunction,d=o.toString,p="[object Object]";r.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:f,log:m,registerHelper:function(t,e){if(d.call(t)===p){if(e)throw new a("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){d.call(t)===p?o.extend(this.partials,t):this.partials[t]=e},unregisterPartial:function(t){delete this.partials[t]}};var f={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(f.level<=t){var i=f.methodMap[t];"undefined"!=typeof console&&console[i]&&console[i].call(console,e)}}};r.logger=f;var m=f.log;r.log=m;var g=function(t){var e=o.extend({},t);return e._parent=t,e};return r.createFrame=g,r}(e,i),r=function(t,e,i){"use strict";function n(t){var e=t&&t[0]||1,i=d;if(e!==i){if(i>e){var n=p[i],r=p[e];throw new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+r+").")}throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){if(!e)throw new u("No environment passed to template");if(!t||!t.main)throw new u("Unknown template object: "+typeof t);e.VM.checkRevision(t.compiler);var i=function(i,n,r,o,a,s,h,l,d){a&&(o=c.extend({},o,a));var p=e.VM.invokePartial.call(this,i,r,o,s,h,l,d);if(null==p&&e.compile){var f={helpers:s,partials:h,data:l,depths:d};h[r]=e.compile(i,{data:void 0!==l,compat:t.compat},e),p=h[r](o,f)}if(null!=p){if(n){for(var m=p.split("\n"),g=0,E=m.length;E>g&&(m[g]||g+1!==E);g++)m[g]=n+m[g];p=m.join("\n")}return p}throw new u("The partial "+r+" could not be compiled when running in runtime-only mode")},n={lookup:function(t,e){for(var i=t.length,n=0;i>n;n++)if(t[n]&&null!=t[n][e])return t[n][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:c.escapeExpression,invokePartial:i,fn:function(e){return t[e]},programs:[],program:function(t,e,i){var n=this.programs[t],r=this.fn(t);return e||i?n=o(this,t,r,e,i):n||(n=this.programs[t]=o(this,t,r)),n},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var i=t||e;return t&&e&&t!==e&&(i=c.extend({},e,t)),i},noop:e.VM.noop,compilerInfo:t.compiler},r=function(e,i){i=i||{};var o=i.data;r._setup(i),!i.partial&&t.useData&&(o=h(e,o));var a;return t.useDepths&&(a=i.depths?[e].concat(i.depths):[e]),t.main.call(n,e,n.helpers,n.partials,o,a)};return r.isTop=!0,r._setup=function(i){i.partial?(n.helpers=i.helpers,n.partials=i.partials):(n.helpers=n.merge(i.helpers,e.helpers),t.usePartial&&(n.partials=n.merge(i.partials,e.partials)))},r._child=function(e,i,r){if(t.useDepths&&!r)throw new u("must pass parent depths");return o(n,e,t[e],i,r)},r}function o(t,e,i,n,r){var o=function(e,o){return o=o||{},i.call(t,e,t.helpers,t.partials,o.data||n,r&&[e].concat(r))};return o.program=e,o.depth=r?r.length:0,o}function a(t,e,i,n,r,o,a){var s={partial:!0,helpers:n,partials:r,data:o,depths:a};if(void 0===t)throw new u("The partial "+e+" could not be found");return t instanceof Function?t(i,s):void 0}function s(){return""}function h(t,e){return e&&"root"in e||(e=e?f(e):{},e.root=t),e}var l={},c=t,u=e,d=i.COMPILER_REVISION,p=i.REVISION_CHANGES,f=i.createFrame;return l.checkRevision=n,l.template=r,l.program=o,l.invokePartial=a,l.noop=s,l}(e,i,n),o=function(t,e,i,n,r){"use strict";var o,a=t,s=e,h=i,l=n,c=r,u=function(){var t=new a.HandlebarsEnvironment;return l.extend(t,a),t.SafeString=s,t.Exception=h,t.Utils=l,t.escapeExpression=l.escapeExpression,t.VM=c,t.template=function(e){return c.template(e,t)},t},d=u();return d.create=u,d["default"]=d,o=d}(n,t,i,e,r),a=function(t){"use strict";function e(t){t=t||{},this.firstLine=t.first_line,this.firstColumn=t.first_column,this.lastColumn=t.last_column,this.lastLine=t.last_line}var i,n=t,r={ProgramNode:function(t,i,n){e.call(this,n),this.type="program",this.statements=t,this.strip=i},MustacheNode:function(t,i,n,o,a){if(e.call(this,a),this.type="mustache",this.strip=o,null!=n&&n.charAt){var s=n.charAt(3)||n.charAt(2);this.escaped="{"!==s&&"&"!==s}else this.escaped=!!n;this.sexpr=t instanceof r.SexprNode?t:new r.SexprNode(t,i),this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(t,i,n){e.call(this,n),this.type="sexpr",this.hash=i;var r=this.id=t[0],o=this.params=t.slice(1);this.isHelper=!(!o.length&&!i),this.eligibleHelper=this.isHelper||r.isSimple},PartialNode:function(t,i,n,r,o){e.call(this,o),this.type="partial",this.partialName=t,this.context=i,this.hash=n,this.strip=r,this.strip.inlineStandalone=!0},BlockNode:function(t,i,n,r,o){e.call(this,o),this.type="block",this.mustache=t,this.program=i,this.inverse=n,this.strip=r,n&&!i&&(this.isInverse=!0)},RawBlockNode:function(t,i,o,a){if(e.call(this,a),t.sexpr.id.original!==o)throw new n(t.sexpr.id.original+" doesn't match "+o,this);i=new r.ContentNode(i,a),this.type="block",this.mustache=t,this.program=new r.ProgramNode([i],{},a)},ContentNode:function(t,i){e.call(this,i),this.type="content",this.original=this.string=t},HashNode:function(t,i){e.call(this,i),this.type="hash",this.pairs=t},IdNode:function(t,i){e.call(this,i),this.type="ID";for(var r="",o=[],a=0,s="",h=0,l=t.length;l>h;h++){var c=t[h].part;if(r+=(t[h].separator||"")+c,".."===c||"."===c||"this"===c){if(o.length>0)throw new n("Invalid path: "+r,this);".."===c?(a++,s+="../"):this.isScoped=!0}else o.push(c)}this.original=r,this.parts=o,this.string=o.join("."),this.depth=a,this.idName=s+this.string,this.isSimple=1===t.length&&!this.isScoped&&0===a,this.stringModeValue=this.string},PartialNameNode:function(t,i){e.call(this,i),this.type="PARTIAL_NAME",this.name=t.original},DataNode:function(t,i){e.call(this,i),this.type="DATA",this.id=t,this.stringModeValue=t.stringModeValue,this.idName="@"+t.stringModeValue},StringNode:function(t,i){e.call(this,i),this.type="STRING",this.original=this.string=this.stringModeValue=t},NumberNode:function(t,i){e.call(this,i),this.type="NUMBER",this.original=this.number=t,this.stringModeValue=Number(t)},BooleanNode:function(t,i){e.call(this,i),this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},CommentNode:function(t,i){e.call(this,i),this.type="comment",this.comment=t,this.strip={inlineStandalone:!0}}};return i=r}(i),s=function(){"use strict";var t,e=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function(t,e,i,n,r,o){var a=o.length-1;switch(r){case 1:return n.prepareProgram(o[a-1].statements,!0),o[a-1];case 2:this.$=new n.ProgramNode(n.prepareProgram(o[a]),{},this._$);break;case 3:this.$=o[a];break;case 4:this.$=o[a];break;case 5:this.$=o[a];break;case 6:this.$=o[a];break;case 7:this.$=new n.ContentNode(o[a],this._$);break;case 8:this.$=new n.CommentNode(o[a],this._$);break;case 9:this.$=new n.RawBlockNode(o[a-2],o[a-1],o[a],this._$);break;case 10:this.$=new n.MustacheNode(o[a-1],null,"","",this._$);break;case 11:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!1,this._$);break;case 12:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!0,this._$);break;case 13:this.$=new n.MustacheNode(o[a-1],null,o[a-2],n.stripFlags(o[a-2],o[a]),this._$);break;case 14:this.$=new n.MustacheNode(o[a-1],null,o[a-2],n.stripFlags(o[a-2],o[a]),this._$);break;case 15:this.$={strip:n.stripFlags(o[a-1],o[a-1]),program:o[a]};break;case 16:this.$={path:o[a-1],strip:n.stripFlags(o[a-2],o[a])};break;case 17:this.$=new n.MustacheNode(o[a-1],null,o[a-2],n.stripFlags(o[a-2],o[a]),this._$);break;case 18:this.$=new n.MustacheNode(o[a-1],null,o[a-2],n.stripFlags(o[a-2],o[a]),this._$);break;case 19:this.$=new n.PartialNode(o[a-3],o[a-2],o[a-1],n.stripFlags(o[a-4],o[a]),this._$);break;case 20:this.$=new n.PartialNode(o[a-2],void 0,o[a-1],n.stripFlags(o[a-3],o[a]),this._$);break;case 21:this.$=new n.SexprNode([o[a-2]].concat(o[a-1]),o[a],this._$);break;case 22:this.$=new n.SexprNode([o[a]],null,this._$);break;case 23:this.$=o[a];break;case 24:this.$=new n.StringNode(o[a],this._$);break;case 25:this.$=new n.NumberNode(o[a],this._$);break;case 26:this.$=new n.BooleanNode(o[a],this._$);break;case 27:this.$=o[a];break;case 28:o[a-1].isHelper=!0,this.$=o[a-1];break;case 29:this.$=new n.HashNode(o[a],this._$);break;case 30:this.$=[o[a-2],o[a]];break;case 31:this.$=new n.PartialNameNode(o[a],this._$);break;case 32:this.$=new n.PartialNameNode(new n.StringNode(o[a],this._$),this._$);break;case 33:this.$=new n.PartialNameNode(new n.NumberNode(o[a],this._$));break;case 34:this.$=new n.DataNode(o[a],this._$);break;case 35:this.$=new n.IdNode(o[a],this._$);break;case 36:o[a-2].push({part:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 37:this.$=[{part:o[a]}];break;case 38:this.$=[];break;case 39:o[a-1].push(o[a]);break;case 48:this.$=[];break;case 49:o[a-1].push(o[a]);break;case 52:this.$=[o[a]];break;case 53:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function(t){throw new Error(t)},parse:function(t){function e(){var t;return t=i.lexer.lex()||1,"number"!=typeof t&&(t=i.symbols_[t]||t),t}var i=this,n=[0],r=[null],o=[],a=this.table,s="",h=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;o.push(u);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,E,v,y,_,T,x={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=e()),g=a[m]&&a[m][p]),"undefined"==typeof g||!g.length||!g[0]){var b="";if(!c){T=[];for(v in a[m])this.terminals_[v]&&v>2&&T.push("'"+this.terminals_[v]+"'");b=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(b,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:T})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),r.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(l=this.lexer.yyleng,s=this.lexer.yytext,h=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(y=this.productions_[g[1]][1],x.$=r[r.length-y],x._$={first_line:o[o.length-(y||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(y||1)].first_column,last_column:o[o.length-1].last_column},d&&(x._$.range=[o[o.length-(y||1)].range[0],o[o.length-1].range[1]]),E=this.performAction.call(x,s,l,h,this.yy,g[1],r,o),"undefined"!=typeof E)return E;y&&(n=n.slice(0,-1*y*2),r=r.slice(0,-1*y),o=o.slice(0,-1*y)),n.push(this.productions_[g[1]][0]),r.push(x.$),o.push(x._$),_=a[n[n.length-2]][n[n.length-1]],n.push(_);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,n,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),a=0;a<o.length&&(i=this._input.match(this.rules[o[a]]),!i||e&&!(i[0].length>e[0].length)||(e=i,n=a,this.options.flex));a++);return e?(r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,i,n){function r(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}switch(i){case 0:if("\\\\"===e.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 12;break;case 1:return 12;case 2:return this.popState(),12;case 3:return e.yytext=e.yytext.substr(5,e.yyleng-9),this.popState(),15;case 4:return 12;case 5:return r(0,4),this.popState(),13;case 6:return 45;case 7:return 46;case 8:return 16;case 9:return this.popState(),this.begin("raw"),18;case 10:return 34;case 11:return 24;case 12:return 29;case 13:return this.popState(),28;case 14:return this.popState(),28;case 15:return 26;case 16:return 26;case 17:return 32;case 18:return 31;case 19:this.popState(),this.begin("com");break;case 20:return r(3,5),this.popState(),13;case 21:return 31;case 22:return 51;case 23:return 50;case 24:return 50;case 25:return 54;case 26:break;case 27:return this.popState(),33;case 28:return this.popState(),25;case 29:return e.yytext=r(1,2).replace(/\\"/g,'"'),42;case 30:return e.yytext=r(1,2).replace(/\\'/g,"'"),42;case 31:return 52;case 32:return 44;case 33:return 44;case 34:return 43;case 35:return 50;case 36:return e.yytext=r(1,2),50;case 37:return"INVALID";case 38:return 5}},t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,38],inclusive:!0}},t}();return e.lexer=i,t.prototype=e,e.Parser=t,new t}();return t=e}(),h=function(t){"use strict";function e(t,e){return{left:"~"===t.charAt(2),right:"~"===e.charAt(e.length-3)}}function i(t,e,i,n,h,c){if(t.sexpr.id.original!==n.path.original)throw new l(t.sexpr.id.original+" doesn't match "+n.path.original,t);var u=i&&i.program,d={left:t.strip.left,right:n.strip.right,openStandalone:o(e.statements),closeStandalone:r((u||e).statements)};if(t.strip.right&&a(e.statements,null,!0),u){var p=i.strip;p.left&&s(e.statements,null,!0),p.right&&a(u.statements,null,!0),n.strip.left&&s(u.statements,null,!0),r(e.statements)&&o(u.statements)&&(s(e.statements),a(u.statements))}else n.strip.left&&s(e.statements,null,!0);return h?new this.BlockNode(t,u,e,d,c):new this.BlockNode(t,e,u,d,c)}function n(t,e){for(var i=0,n=t.length;n>i;i++){var h=t[i],l=h.strip;if(l){var c=r(t,i,e,"partial"===h.type),u=o(t,i,e),d=l.openStandalone&&c,p=l.closeStandalone&&u,f=l.inlineStandalone&&c&&u;l.right&&a(t,i,!0),l.left&&s(t,i,!0),f&&(a(t,i),s(t,i)&&"partial"===h.type&&(h.indent=/([ \t]+$)/.exec(t[i-1].original)?RegExp.$1:"")),d&&(a((h.program||h.inverse).statements),s(t,i)),p&&(a(t,i),s((h.inverse||h.program).statements))}}return t}function r(t,e,i){void 0===e&&(e=t.length);var n=t[e-1],r=t[e-2];return n?"content"===n.type?(r||!i?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:i}function o(t,e,i){void 0===e&&(e=-1);var n=t[e+1],r=t[e+2];return n?"content"===n.type?(r||!i?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:i}function a(t,e,i){var n=t[null==e?0:e+1];if(n&&"content"===n.type&&(i||!n.rightStripped)){var r=n.string;n.string=n.string.replace(i?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.string!==r}}function s(t,e,i){var n=t[null==e?t.length-1:e-1];if(n&&"content"===n.type&&(i||!n.leftStripped)){var r=n.string;return n.string=n.string.replace(i?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.string!==r,n.leftStripped}}var h={},l=t;return h.stripFlags=e,h.prepareBlock=i,h.prepareProgram=n,h}(i),l=function(t,e,i,n){"use strict";function r(t){return t.constructor===s.ProgramNode?t:(a.yy=c,a.parse(t))}var o={},a=t,s=e,h=i,l=n.extend;o.parser=a;var c={};return l(c,h,s),o.parse=r,o}(s,a,h,e),c=function(t,e){"use strict";function i(){}function n(t,e,i){if(null==t||"string"!=typeof t&&t.constructor!==i.AST.ProgramNode)throw new s("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=i.parse(t),r=(new i.Compiler).compile(n,e);return(new i.JavaScriptCompiler).compile(r,e)}function r(t,e,i){function n(){var n=i.parse(t),r=(new i.Compiler).compile(n,e),o=(new i.JavaScriptCompiler).compile(r,e,void 0,!0);return i.template(o)}if(null==t||"string"!=typeof t&&t.constructor!==i.AST.ProgramNode)throw new s("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var r,o=function(t,e){return r||(r=n()),r.call(this,t,e)};return o._setup=function(t){return r||(r=n()),r._setup(t)},o._child=function(t,e,i){return r||(r=n()),r._child(t,e,i)},o}function o(t,e){if(t===e)return!0;if(h(t)&&h(e)&&t.length===e.length){for(var i=0;i<t.length;i++)if(!o(t[i],e[i]))return!1;return!0}}var a={},s=t,h=e.isArray,l=[].slice;return a.Compiler=i,i.prototype={compiler:i,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var i=0;e>i;i++){var n=this.opcodes[i],r=t.opcodes[i];if(n.opcode!==r.opcode||!o(n.args,r.args))return!1}for(e=this.children.length,i=0;e>i;i++)if(!this.children[i].equals(t.children[i]))return!1;return!0},guid:0,compile:function(t,e){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.accept(t)},accept:function(t){return this[t.type](t)},program:function(t){for(var e=t.statements,i=0,n=e.length;n>i;i++)this.accept(e[i]);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,i=(new this.compiler).compile(t,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var r=0,o=i.depths.list.length;o>r;r++)e=i.depths.list[r],2>e||this.addDepth(e-1);return n},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var r=e.sexpr,o=this.classifySexpr(r);"helper"===o?this.helperSexpr(r,i,n):"simple"===o?(this.simpleSexpr(r),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",r.id.original)):(this.ambiguousSexpr(r,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,i,n=t.pairs;for(this.opcode("pushHash"),e=0,i=n.length;i>e;e++)this.pushParam(n[e][1]);for(;e--;)this.opcode("assignToHash",n[e][0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.hash?this.accept(t.hash):this.opcode("push","undefined"),t.context?this.accept(t.context):(this.opcode("getContext",0),this.opcode("pushContext")),this.opcode("invokePartial",e.name,t.indent||""),this.opcode("append")},content:function(t){t.string&&this.opcode("appendContent",t.string)},mustache:function(t){this.sexpr(t.sexpr),this.opcode(t.escaped&&!this.options.noEscape?"appendEscaped":"append")},ambiguousSexpr:function(t,e,i){var n=t.id,r=n.parts[0],o=null!=e||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.ID(n),this.opcode("invokeAmbiguous",r,o)},simpleSexpr:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),r=t.id,o=r.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new s("You specified knownHelpersOnly, but used the unknown helper "+o,t);r.falsy=!0,this.ID(r),this.opcode("invokeHelper",n.length,r.original,r.isSimple)}},sexpr:function(t){var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts,t.falsy,t.isScoped):this.opcode("pushContext")},DATA:function(t){this.options.data=!0,this.opcode("lookupData",t.id.depth,t.id.parts)
},STRING:function(t){this.opcode("pushString",t.string)},NUMBER:function(t){this.opcode("pushLiteral",t.number)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:l.call(arguments,1)})},addDepth:function(t){0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifySexpr:function(t){var e=t.isHelper,i=t.eligibleHelper,n=this.options;if(i&&!e){var r=t.id.parts[0];n.knownHelpers[r]?e=!0:n.knownHelpersOnly&&(i=!1)}return e?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e=0,i=t.length;i>e;e++)this.pushParam(t[e])},pushParam:function(t){this.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type),"sexpr"===t.type&&this.sexpr(t)):(this.trackIds&&this.opcode("pushId",t.type,t.idName||t.stringModeValue),this.accept(t))},setupFullMustacheParams:function(t,e,i){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.hash(t.hash):this.opcode("emptyHash"),n}},a.precompile=n,a.compile=r,a}(i,e),u=function(t,e){"use strict";function i(t){this.value=t}function n(){}var r,o=t.COMPILER_REVISION,a=t.REVISION_CHANGES,s=e;n.prototype={nameLookup:function(t,e){return n.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']"},depthedLookup:function(t){return this.aliases.lookup="this.lookup",'lookup(depths, "'+t+'")'},compilerInfo:function(){var t=o,e=a[t];return[t,e]},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,i,n){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.depths.list.length||this.options.compat;var r,o,a,h=t.opcodes;for(o=0,a=h.length;a>o;o++)r=h[o],this[r.opcode].apply(this,r.args);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s("Compile completed with content left on stack");var l=this.createFunctionContext(n);if(this.isChild)return l;var c={compiler:this.compilerInfo(),main:l},u=this.context.programs;for(o=0,a=u.length;a>o;o++)u[o]&&(c[o]=u[o]);return this.environment.usePartial&&(c.usePartial=!0),this.options.data&&(c.useData=!0),this.useDepths&&(c.useDepths=!0),this.options.compat&&(c.compat=!0),n||(c.compiler=JSON.stringify(c.compiler),c=this.objectLiteral(c)),c},preamble:function(){this.lastContext=0,this.source=[]},createFunctionContext:function(t){var e="",i=this.stackVars.concat(this.registers.list);i.length>0&&(e+=", "+i.join(", "));for(var n in this.aliases)this.aliases.hasOwnProperty(n)&&(e+=", "+n+"="+this.aliases[n]);var r=["depth0","helpers","partials","data"];this.useDepths&&r.push("depths");var o=this.mergeSource(e);return t?(r.push(o),Function.apply(this,r)):"function("+r.join(",")+") {\n  "+o+"}"},mergeSource:function(t){for(var e,i,n="",r=!this.forceBuffer,o=0,a=this.source.length;a>o;o++){var s=this.source[o];s.appendToBuffer?e=e?e+"\n    + "+s.content:s.content:(e&&(n?n+="buffer += "+e+";\n  ":(i=!0,n=e+";\n  "),e=void 0),n+=s+"\n  ",this.environment.isSimple||(r=!1))}return r?(e||!n)&&(n+="return "+(e||'""')+";\n"):(t+=", buffer = "+(i?"":this.initializeBuffer()),n+=e?"return buffer + "+e+";\n":"return buffer;\n"),t&&(n="var "+t.substring(2)+(i?"":";\n  ")+n),n},blockValue:function(t){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=[this.contextName(0)];this.setupParams(t,0,e);var i=this.popStack();e.splice(1,0,i),this.push("blockHelperMissing.call("+e.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=[this.contextName(0)];this.setupParams("",0,t,!0),this.flushInline();var e=this.topStack();t.splice(1,0,e),this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.pendingContent&&(t=this.pendingContent+t),this.pendingContent=t},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if ("+t+" != null) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,i){var n=0,r=t.length;for(i||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[n++]));r>n;n++)this.replaceStack(function(i){var r=this.nameLookup(i,t[n],"context");return e?" && "+r:" != null ? "+r+" : "+i})},lookupData:function(t,e){this.pushStackLiteral(t?"this.data(data, "+t+")":"data");for(var i=e.length,n=0;i>n;n++)this.replaceStack(function(t){return" && "+this.nameLookup(t,e[n],"data")})},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda",this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"sexpr"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(){this.pushStackLiteral("{}"),this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push("{"+t.ids.join(",")+"}"),this.stringParams&&(this.push("{"+t.contexts.join(",")+"}"),this.push("{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){this.pushStackLiteral(null!=t?this.programExpression(t):null)},invokeHelper:function(t,e,i){this.aliases.helperMissing="helpers.helperMissing";var n=this.popStack(),r=this.setupHelper(t,e),o=(i?r.name+" || ":"")+n+" || helperMissing";this.push("(("+o+").call("+r.callParams+"))")},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t,e){this.aliases.functionType='"function"',this.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var i=this.popStack();this.emptyHash();var n=this.setupHelper(0,t,e),r=this.lastHelper=this.nameLookup("helpers",t,"helper");this.push("((helper = (helper = "+r+" || "+i+") != null ? helper : helperMissing"+(n.paramsInit?"),("+n.paramsInit:"")+"),(typeof helper === functionType ? helper.call("+n.callParams+") : helper))")},invokePartial:function(t,e){var i=[this.nameLookup("partials",t,"partial"),"'"+e+"'","'"+t+"'",this.popStack(),this.popStack(),"helpers","partials"];this.options.data?i.push("data"):this.options.compat&&i.push("undefined"),this.options.compat&&i.push("depths"),this.push("this.invokePartial("+i.join(", ")+")")},assignToHash:function(t){var e,i,n,r=this.popStack();this.trackIds&&(n=this.popStack()),this.stringParams&&(i=this.popStack(),e=this.popStack());var o=this.hash;e&&o.contexts.push("'"+t+"': "+e),i&&o.types.push("'"+t+"': "+i),n&&o.ids.push("'"+t+"': "+n),o.values.push("'"+t+"': ("+r+")")},pushId:function(t,e){"ID"===t||"DATA"===t?this.pushString(e):this.pushStackLiteral("sexpr"===t?"true":"null")},compiler:n,compileChildren:function(t,e){for(var i,n,r=t.children,o=0,a=r.length;a>o;o++){i=r[o],n=new this.compiler;var s=this.matchExistingProgram(i);null==s?(this.context.programs.push(""),s=this.context.programs.length,i.index=s,i.name="program"+s,this.context.programs[s]=n.compile(i,e,this.context,!this.precompile),this.context.environments[s]=i,this.useDepths=this.useDepths||n.useDepths):(i.index=s,i.name="program"+s)}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;i>e;e++){var n=this.context.environments[e];if(n&&n.equals(t))return e}},programExpression:function(t){var e=this.environment.children[t],i=(e.depths.list,this.useDepths),n=[e.index,"data"];return i&&n.push("depths"),"this.program("+n.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new i(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),t&&this.source.push(t)},pushStack:function(t){this.flushInline();var e=this.incrStack();return this.pushSource(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){{var e,n,r,o="";this.isInline()}if(!this.isInline())throw new s("replaceStack on non-inline");var a=this.popStack(!0);if(a instanceof i)o=e=a.value,r=!0;else{n=!this.stackSlot;var h=n?this.incrStack():this.topStackName();o="("+this.push(h)+" = "+a+")",e=this.topStack()}var l=t.call(this,e);r||this.popStack(),n&&this.stackSlot--,this.push("("+o+l+")")},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,n=t.length;n>e;e++){var r=t[e];r instanceof i?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),n=(e?this.inlineStack:this.compileStack).pop();if(!t&&n instanceof i)return n.value;if(!e){if(!this.stackSlot)throw new s("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof i?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(this.quotedString(i)+":"+t[i]);return"{"+e.join(",")+"}"},setupHelper:function(t,e,i){var n=[],r=this.setupParams(e,t,n,i),o=this.nameLookup("helpers",e,"helper");return{params:n,paramsInit:r,name:o,callParams:[this.contextName(0)].concat(n).join(", ")}},setupOptions:function(t,e,i){var n,r,o,a={},s=[],h=[],l=[];a.name=this.quotedString(t),a.hash=this.popStack(),this.trackIds&&(a.hashIds=this.popStack()),this.stringParams&&(a.hashTypes=this.popStack(),a.hashContexts=this.popStack()),r=this.popStack(),o=this.popStack(),(o||r)&&(o||(o="this.noop"),r||(r="this.noop"),a.fn=o,a.inverse=r);for(var c=e;c--;)n=this.popStack(),i[c]=n,this.trackIds&&(l[c]=this.popStack()),this.stringParams&&(h[c]=this.popStack(),s[c]=this.popStack());return this.trackIds&&(a.ids="["+l.join(",")+"]"),this.stringParams&&(a.types="["+h.join(",")+"]",a.contexts="["+s.join(",")+"]"),this.options.data&&(a.data="data"),a},setupParams:function(t,e,i,n){var r=this.objectLiteral(this.setupOptions(t,e,i));return n?(this.useRegister("options"),i.push("options"),"options="+r):(i.push(r),"")}};for(var h="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=n.RESERVED_WORDS={},c=0,u=h.length;u>c;c++)l[h[c]]=!0;return n.isValidJavaScriptVariableName=function(t){return!n.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},r=n}(n,i),d=function(t,e,i,n,r){"use strict";var o,a=t,s=e,h=i.parser,l=i.parse,c=n.Compiler,u=n.compile,d=n.precompile,p=r,f=a.create,m=function(){var t=f();return t.compile=function(e,i){return u(e,i,t)},t.precompile=function(e,i){return d(e,i,t)},t.AST=s,t.Compiler=c,t.JavaScriptCompiler=p,t.Parser=h,t.parse=l,t};return a=m(),a.create=m,a["default"]=a,o=a}(o,a,l,c,u);return d}),define("vendors/handlebars",["require","handlebars","marionette"],function(t){"use strict";var e=t("handlebars"),i=t("marionette");return function(){i.Renderer.render=function(t,i){var n=e.compile(t);return n(i)},i.Object.prototype.renderTemplate=function(t,i){var n=e.compile(t);return n(i)},e.registerHelper("staticFile",function(t){return window.application.paths.staticFiles+t}),e.registerHelper("list",function(t,e){for(var i="<ul>",n=0,r=t.length;r>n;n++)i=i+"<li>"+e.fn(t[n])+"</li>";return i+"</ul>"})}}),function(t){"use strict";t("jquery.scrollto",["jquery"],function(t){function e(e){return!e.nodeName||-1!==t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])}function i(e){return t.isFunction(e)||t.isPlainObject(e)?e:{top:e,left:e}}var n=t.scrollTo=function(e,i,n){return t(window).scrollTo(e,i,n)};return n.defaults={axis:"xy",duration:0,limit:!0},t.fn.scrollTo=function(r,o,a){"object"==typeof o&&(a=o,o=0),"function"==typeof a&&(a={onAfter:a}),"max"===r&&(r=9e9),a=t.extend({},n.defaults,a),o=o||a.duration;var s=a.queue&&a.axis.length>1;return s&&(o/=2),a.offset=i(a.offset),a.over=i(a.over),this.each(function(){function h(e){var i=t.extend({},a,{queue:!0,duration:o,complete:e&&function(){e.call(u,p,a)}});d.animate(f,i)}if(null!==r){var l,c=e(this),u=c?this.contentWindow||window:this,d=t(u),p=r,f={};switch(typeof p){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(p)){p=i(p);break}if(p=c?t(p):t(p,u),!p.length)return;case"object":(p.is||p.style)&&(l=(p=t(p)).offset())}var m=t.isFunction(a.offset)&&a.offset(u,p)||a.offset;t.each(a.axis.split(""),function(t,e){var i="x"===e?"Left":"Top",r=i.toLowerCase(),o="scroll"+i,g=d[o](),E=n.max(u,e);if(l)f[o]=l[r]+(c?0:g-d.offset()[r]),a.margin&&(f[o]-=parseInt(p.css("margin"+i),10)||0,f[o]-=parseInt(p.css("border"+i+"Width"),10)||0),f[o]+=m[r]||0,a.over[r]&&(f[o]+=p["x"===e?"width":"height"]()*a.over[r]);else{var v=p[r];f[o]=v.slice&&"%"===v.slice(-1)?parseFloat(v)/100*E:v}a.limit&&/^\d+$/.test(f[o])&&(f[o]=f[o]<=0?0:Math.min(f[o],E)),!t&&a.axis.length>1&&(g===f[o]?f={}:s&&(h(a.onAfterFirst),f={}))}),h(a.onAfter)}})},n.max=function(i,n){var r="x"===n?"Width":"Height",o="scroll"+r;if(!e(i))return i[o]-t(i)[r.toLowerCase()]();var a="client"+r,s=i.ownerDocument||i.document,h=s.documentElement,l=s.body;return Math.max(h[o],l[o])-Math.min(h[a],l[a])},t.Tween.propHooks.scrollLeft=t.Tween.propHooks.scrollTop={get:function(e){return t(e.elem)[e.prop]()},set:function(e){var i=this.get(e);if(e.options.interrupt&&e._last&&e._last!==i)return t(e.elem).stop();var n=Math.round(e.now);i!==n&&(t(e.elem)[e.prop](n),e._last=this.get(e))}},n})}("function"==typeof define&&define.amd?define:function(t,e){"use strict";"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}),function(t,e){"function"==typeof define&&define.amd?define("fullpage",["jquery"],function(i){return e(i,t,t.document,t.Math)}):"undefined"!=typeof exports?module.exports=e(require("jquery"),t,t.document,t.Math):e(jQuery,t,t.document,t.Math)}("undefined"!=typeof window?window:this,function(t,e,i,n,r){var o=t(e),a=t(i);t.fn.fullpage=function(s){function h(t){t.find(".fp-slides").after('<div class="fp-controlArrow fp-prev"></div><div class="fp-controlArrow fp-next"></div>'),"#fff"!=s.controlArrowColor&&(t.find(".fp-controlArrow.fp-next").css("border-color","transparent transparent transparent "+s.controlArrowColor),t.find(".fp-controlArrow.fp-prev").css("border-color","transparent "+s.controlArrowColor+" transparent transparent")),s.loopHorizontal||t.find(".fp-controlArrow.fp-prev").hide()}function l(){he.append('<div id="fp-nav"><ul></ul></div>'),de=t("#fp-nav"),de.addClass(function(){return s.showActiveTooltip?"fp-show-active "+s.navigationPosition:s.navigationPosition});for(var e=0;e<t(".fp-section").length;e++){var i="";s.anchors.length&&(i=s.anchors[e]);var i='<li><a href="#'+i+'"><span></span></a>',n=s.navigationTooltips[e];"undefined"!=typeof n&&""!==n&&(i+='<div class="fp-tooltip '+s.navigationPosition+'">'+n+"</div>"),i+="</li>",de.find("ul").append(i)}}function c(){t(".fp-section").each(function(){var e=t(this).find(".fp-slide");e.length?e.each(function(){B(t(this))}):B(t(this))}),u()}function u(){var e=t(".fp-section.active");e.find(".fp-scrollable").mouseover(),t.isFunction(s.afterLoad)&&s.afterLoad.call(e,e.data("anchor"),e.index(".fp-section")+1),t.isFunction(s.afterRender)&&s.afterRender.call(this)}function d(){var e;if(!s.autoScrolling||s.scrollBar){for(var r=o.scrollTop(),a=0,h=n.abs(r-i.querySelectorAll(".fp-section")[0].offsetTop),l=i.querySelectorAll(".fp-section"),c=0;c<l.length;++c){var u=n.abs(r-l[c].offsetTop);h>u&&(a=c,h=u)}e=t(l).eq(a)}if(!s.autoScrolling||s.scrollBar){if(!e.hasClass("active")){if(He=!0,r=t(".fp-section.active"),a=r.index(".fp-section")+1,h=O(e),l=e.data("anchor"),c=e.index(".fp-section")+1,u=e.find(".fp-slide.active"),u.length)var d=u.data("anchor"),p=u.index();_e&&(e.addClass("active").siblings().removeClass("active"),t.isFunction(s.onLeave)&&s.onLeave.call(r,a,c,h),t.isFunction(s.afterLoad)&&s.afterLoad.call(e,l,c),D(l,c-1),s.anchors.length&&(ce=l,q(p,d,l,c))),clearTimeout(Re),Re=setTimeout(function(){He=!1},100)}s.fitToSection&&(clearTimeout(we),we=setTimeout(function(){_e&&(t(".fp-section.active").is(e)&&(ye=!0),b(e),ye=!1)},1e3))}}function p(t){return t.find(".fp-slides").length?t.find(".fp-slide.active").find(".fp-scrollable"):t.find(".fp-scrollable")}function f(t,e){if(xe[t]){var i,n;if("down"==t?(i="bottom",n=le.moveSectionDown):(i="top",n=le.moveSectionUp),0<e.length){if(!(i="top"===i?!e.scrollTop():"bottom"===i?e.scrollTop()+1+e.innerHeight()>=e[0].scrollHeight:void 0))return!0;n()}else n()}}function m(e){var i=e.originalEvent;if(!g(e.target)&&E(i)){s.autoScrolling&&e.preventDefault(),e=t(".fp-section.active");var r=p(e);_e&&!fe&&(i=te(i),Ce=i.y,Le=i.x,e.find(".fp-slides").length&&n.abs(Se-Le)>n.abs(Me-Ce)?n.abs(Se-Le)>o.width()/100*s.touchSensitivity&&(Se>Le?xe.right&&le.moveSlideRight():xe.left&&le.moveSlideLeft()):s.autoScrolling&&n.abs(Me-Ce)>o.height()/100*s.touchSensitivity&&(Me>Ce?f("down",r):Ce>Me&&f("up",r)))}}function g(e,i){i=i||0;var n=t(e).parent();return i<s.normalScrollElementTouchThreshold&&n.is(s.normalScrollElements)?!0:i==s.normalScrollElementTouchThreshold?!1:g(n,++i)}function E(t){return"undefined"==typeof t.pointerType||"mouse"!=t.pointerType}function v(t){t=t.originalEvent,s.fitToSection&&se.stop(),E(t)&&(t=te(t),Me=t.y,Se=t.x)}function y(t,e){for(var i=0,r=t.slice(n.max(t.length-e,1)),o=0;o<r.length;o++)i+=r[o];return n.ceil(i/e)}function _(i){var r=(new Date).getTime();if(s.autoScrolling&&!pe){i=e.event||i;var o=i.wheelDelta||-i.deltaY||-i.detail,a=n.max(-1,n.min(1,o));return 149<Te.length&&Te.shift(),Te.push(n.abs(o)),s.scrollBar&&(i.preventDefault?i.preventDefault():i.returnValue=!1),i=t(".fp-section.active"),i=p(i),o=r-Ae,Ae=r,o>200&&(Te=[]),_e&&(r=y(Te,10),o=y(Te,70),r>=o&&(0>a?f("down",i):f("up",i))),!1}s.fitToSection&&se.stop()}function T(e){var i=t(".fp-section.active").find(".fp-slides");if(i.length&&!fe){var n=i.find(".fp-slide.active"),r=null,r="prev"===e?n.prev(".fp-slide"):n.next(".fp-slide");if(!r.length){if(!s.loopHorizontal)return;r=n.siblings("prev"===e?":last":":first")}fe=!0,C(i,r)}}function x(){t(".fp-slide.active").each(function(){ee(t(this),"internal")})}function b(e,i,n){var r=e.position();if("undefined"!=typeof r&&(i={element:e,callback:i,isMovementUp:n,dest:r,dtop:r.top,yMovement:O(e),anchorLink:e.data("anchor"),sectionIndex:e.index(".fp-section"),activeSlide:e.find(".fp-slide.active"),activeSection:t(".fp-section.active"),leavingSection:t(".fp-section.active").index(".fp-section")+1,localIsResizing:ye},!(i.activeSection.is(e)&&!ye||s.scrollBar&&o.scrollTop()===i.dtop))){if(i.activeSlide.length)var a=i.activeSlide.data("anchor"),h=i.activeSlide.index();s.autoScrolling&&s.continuousVertical&&"undefined"!=typeof i.isMovementUp&&(!i.isMovementUp&&"up"==i.yMovement||i.isMovementUp&&"down"==i.yMovement)&&(i.isMovementUp?t(".fp-section.active").before(i.activeSection.nextAll(".fp-section")):t(".fp-section.active").after(i.activeSection.prevAll(".fp-section").get().reverse()),ie(t(".fp-section.active").position().top),x(),i.wrapAroundElements=i.activeSection,i.dest=i.element.position(),i.dtop=i.dest.top,i.yMovement=O(i.element)),e.addClass("active").siblings().removeClass("active"),_e=!1,q(h,a,i.anchorLink,i.sectionIndex),t.isFunction(s.onLeave)&&!i.localIsResizing&&s.onLeave.call(i.activeSection,i.leavingSection,i.sectionIndex+1,i.yMovement),R(i),ce=i.anchorLink,D(i.anchorLink,i.sectionIndex)}}function R(e){if(s.css3&&s.autoScrolling&&!s.scrollBar)V("translate3d(0px, -"+e.dtop+"px, 0px)",!0),setTimeout(function(){H(e)},s.scrollingSpeed);else{var i=w(e);t(i.element).animate(i.options,s.scrollingSpeed,s.easing).promise().done(function(){H(e)})}}function w(t){var e={};return s.autoScrolling&&!s.scrollBar?(e.options={top:-t.dtop},e.element=".fullpage-wrapper"):(e.options={scrollTop:t.dtop},e.element="html, body"),e}function H(e){e.wrapAroundElements&&e.wrapAroundElements.length&&(e.isMovementUp?t(".fp-section:first").before(e.wrapAroundElements):t(".fp-section:last").after(e.wrapAroundElements),ie(t(".fp-section.active").position().top),x()),e.element.find(".fp-scrollable").mouseover(),t.isFunction(s.afterLoad)&&!e.localIsResizing&&s.afterLoad.call(e.element,e.anchorLink,e.sectionIndex+1),_e=!0,t.isFunction(e.callback)&&e.callback.call(this)}function M(){if(!He){var t=e.location.hash.replace("#","").split("/"),i=t[0],t=t[1];if(i.length){var n="undefined"==typeof ce,r="undefined"==typeof ce&&"undefined"==typeof t&&!fe;(i&&i!==ce&&!n||r||!fe&&ue!=t)&&j(i,t)}}}function S(t){_e&&(t.pageY<ke?le.moveSectionUp():t.pageY>ke&&le.moveSectionDown()),ke=t.pageY}function C(e,i){var r=i.position(),o=i.index(),a=e.closest(".fp-section"),h=a.index(".fp-section"),l=a.data("anchor"),c=a.find(".fp-slidesNav"),u=Y(i),d=ye;if(s.onSlideLeave){var p,f=a.find(".fp-slide.active"),m=f.index();p=m==o?"none":m>o?"left":"right",d||"none"===p||t.isFunction(s.onSlideLeave)&&s.onSlideLeave.call(f,l,h+1,m,p)}i.addClass("active").siblings().removeClass("active"),!s.loopHorizontal&&s.controlArrows&&(a.find(".fp-controlArrow.fp-prev").toggle(0!==o),a.find(".fp-controlArrow.fp-next").toggle(!i.is(":last-child"))),a.hasClass("active")&&q(o,u,l,h);var g=function(){d||t.isFunction(s.afterSlideLoad)&&s.afterSlideLoad.call(i,l,h+1,u,o),fe=!1};s.css3?(r="translate3d(-"+n.round(r.left)+"px, 0px, 0px)",P(e.find(".fp-slidesContainer"),0<s.scrollingSpeed).css(ne(r)),setTimeout(function(){g()},s.scrollingSpeed,s.easing)):e.animate({scrollLeft:n.round(r.left)},s.scrollingSpeed,s.easing,function(){g()}),c.find(".active").removeClass("active"),c.find("li").eq(o).find("a").addClass("active")}function L(){if(A(),me){var e=t(i.activeElement);e.is("textarea")||e.is("input")||e.is("select")||(e=o.height(),n.abs(e-Oe)>20*n.max(Oe,e)/100&&(le.reBuild(!0),Oe=e))}else clearTimeout(De),De=setTimeout(function(){le.reBuild(!0)},350)}function A(){if(s.responsive){var e=Ee.hasClass("fp-responsive");o.width()<s.responsive?e||(le.setAutoScrolling(!1,"internal"),le.setFitToSection(!1,"internal"),t("#fp-nav").hide(),Ee.addClass("fp-responsive")):e&&(le.setAutoScrolling(be.autoScrolling,"internal"),le.setFitToSection(be.autoScrolling,"internal"),t("#fp-nav").show(),Ee.removeClass("fp-responsive"))}}function P(t){var e="all "+s.scrollingSpeed+"ms "+s.easingcss3;return t.removeClass("fp-notransition"),t.css({"-webkit-transition":e,transition:e})}function k(t,e){if(825>t||900>e){var i=n.min(100*t/825,100*e/900).toFixed(2);he.css("font-size",i+"%")}else he.css("font-size","100%")}function D(e,i){s.menu&&(t(s.menu).find(".active").removeClass("active"),t(s.menu).find('[data-menuanchor="'+e+'"]').addClass("active")),s.navigation&&(t("#fp-nav").find(".active").removeClass("active"),e?t("#fp-nav").find('a[href="#'+e+'"]').addClass("active"):t("#fp-nav").find("li").eq(i).find("a").addClass("active"))}function O(e){var i=t(".fp-section.active").index(".fp-section");return e=e.index(".fp-section"),i==e?"none":i>e?"up":"down"}function B(t){t.css("overflow","hidden");var e,i=t.closest(".fp-section"),n=t.find(".fp-scrollable");n.length?e=n.get(0).scrollHeight:(e=t.get(0).scrollHeight,s.verticalCentered&&(e=t.find(".fp-tableCell").get(0).scrollHeight)),i=ve-parseInt(i.css("padding-bottom"))-parseInt(i.css("padding-top")),e>i?n.length?n.css("height",i+"px").parent().css("height",i+"px"):(s.verticalCentered?t.find(".fp-tableCell").wrapInner('<div class="fp-scrollable" />'):t.wrapInner('<div class="fp-scrollable" />'),t.find(".fp-scrollable").slimScroll({allowPageScroll:!0,height:i+"px",size:"10px",alwaysVisible:!0})):N(t),t.css("overflow","")}function N(t){t.find(".fp-scrollable").children().first().unwrap().unwrap(),t.find(".slimScrollBar").remove(),t.find(".slimScrollRail").remove()}function U(t){t.addClass("fp-table").wrapInner('<div class="fp-tableCell" style="height:'+F(t)+'px;" />')}function F(t){var e=ve;return(s.paddingTop||s.paddingBottom)&&(e=t,e.hasClass("fp-section")||(e=t.closest(".fp-section")),t=parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom")),e=ve-t),e}function V(t,e){e?P(Ee):Ee.addClass("fp-notransition"),Ee.css(ne(t)),setTimeout(function(){Ee.removeClass("fp-notransition")},10)}function z(e){var i=t('.fp-section[data-anchor="'+e+'"]');return i.length||(i=t(".fp-section").eq(e-1)),i}function I(t,e){var i=e.find(".fp-slides"),n=i.find('.fp-slide[data-anchor="'+t+'"]');return n.length||(n=i.find(".fp-slide").eq(t)),n}function j(t,e){var i=z(t);"undefined"==typeof e&&(e=0),t===ce||i.hasClass("active")?G(i,e):b(i,function(){G(i,e)})}function G(t,e){if("undefined"!=typeof e){var i=t.find(".fp-slides"),n=I(e,t);n.length&&C(i,n)}}function W(t,e){t.append('<div class="fp-slidesNav"><ul></ul></div>');var i=t.find(".fp-slidesNav");i.addClass(s.slidesNavPosition);for(var n=0;e>n;n++)i.find("ul").append('<li><a href="#"><span></span></a></li>');i.css("margin-left","-"+i.width()/2+"px"),i.find("li").first().find("a").addClass("active")}function q(t,e,i,n){n="",s.anchors.length&&(t?("undefined"!=typeof i&&(n=i),"undefined"==typeof e&&(e=t),ue=e,X(n+"/"+e)):("undefined"!=typeof t&&(ue=e),X(i))),$()}function X(t){if(s.recordHistory)location.hash=t;else if(me||ge)history.replaceState(r,r,"#"+t);else{var i=e.location.href.split("#")[0];e.location.replace(i+"#"+t)}}function Y(t){var e=t.data("anchor");return t=t.index(),"undefined"==typeof e&&(e=t),e}function $(){var e=t(".fp-section.active"),i=e.find(".fp-slide.active"),n=e.data("anchor"),r=Y(i),e=e.index(".fp-section"),e=String(e);s.anchors.length&&(e=n),i.length&&(e=e+"-"+r),e=e.replace("/","-").replace("#",""),he[0].className=he[0].className.replace(RegExp("\\b\\s?fp-viewing-[^\\s]+\\b","g"),""),he.addClass("fp-viewing-"+e)}function Z(){var t,n=i.createElement("p"),o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};i.body.insertBefore(n,null);for(var a in o)n.style[a]!==r&&(n.style[a]="translate3d(1px,1px,1px)",t=e.getComputedStyle(n).getPropertyValue(o[a]));return i.body.removeChild(n),t!==r&&0<t.length&&"none"!==t}function K(){if(me||ge){var e=Q();t(".fullpage-wrapper").off("touchstart "+e.down).on("touchstart "+e.down,v),t(".fullpage-wrapper").off("touchmove "+e.move).on("touchmove "+e.move,m)}}function J(){if(me||ge){var e=Q();t(".fullpage-wrapper").off("touchstart "+e.down),t(".fullpage-wrapper").off("touchmove "+e.move)}}function Q(){return e.PointerEvent?{down:"pointerdown",move:"pointermove"}:{down:"MSPointerDown",move:"MSPointerMove"}}function te(t){var e=[];return e.y="undefined"!=typeof t.pageY&&(t.pageY||t.pageX)?t.pageY:t.touches[0].pageY,e.x="undefined"!=typeof t.pageX&&(t.pageY||t.pageX)?t.pageX:t.touches[0].pageX,ge&&E(t)&&(e.y=t.touches[0].pageY,e.x=t.touches[0].pageX),e}function ee(t,e){le.setScrollingSpeed(0,"internal"),"undefined"!=typeof e&&(ye=!0),C(t.closest(".fp-slides"),t),"undefined"!=typeof e&&(ye=!1),le.setScrollingSpeed(be.scrollingSpeed,"internal")}function ie(t){s.scrollBar?Ee.scrollTop(t):s.css3?V("translate3d(0px, -"+t+"px, 0px)",!1):Ee.css("top",-t)}function ne(t){return{"-webkit-transform":t,"-moz-transform":t,"-ms-transform":t,transform:t}}function re(){ie(0),t("#fp-nav, .fp-slidesNav, .fp-controlArrow").remove(),t(".fp-section").css({height:"","background-color":"",padding:""}),t(".fp-slide").css({width:""}),Ee.css({height:"",position:"","-ms-touch-action":"","touch-action":""}),t(".fp-section, .fp-slide").each(function(){N(t(this)),t(this).removeClass("fp-table active")}),Ee.addClass("fp-notransition"),Ee.find(".fp-tableCell, .fp-slidesContainer, .fp-slides").each(function(){t(this).replaceWith(this.childNodes)}),se.scrollTop(0)}function oe(t,e,i){s[t]=e,"internal"!==i&&(be[t]=e)}function ae(t,e){console&&console[t]&&console[t]("fullPage: "+e)}var se=t("html, body"),he=t("body"),le=t.fn.fullpage;s=t.extend({menu:!1,anchors:[],navigation:!1,navigationPosition:"right",navigationTooltips:[],showActiveTooltip:!1,slidesNavigation:!1,slidesNavPosition:"bottom",scrollBar:!1,css3:!0,scrollingSpeed:700,autoScrolling:!0,fitToSection:!0,easing:"easeInOutCubic",easingcss3:"ease",loopBottom:!1,loopTop:!1,loopHorizontal:!0,continuousVertical:!1,normalScrollElements:null,scrollOverflow:!1,touchSensitivity:5,normalScrollElementTouchThreshold:5,keyboardScrolling:!0,animateAnchor:!0,recordHistory:!0,controlArrows:!0,controlArrowColor:"#fff",verticalCentered:!0,resize:!1,sectionsColor:[],paddingTop:0,paddingBottom:0,fixedElements:null,responsive:0,sectionSelector:".section",slideSelector:".slide",afterLoad:null,onLeave:null,afterRender:null,afterResize:null,afterReBuild:null,afterSlideLoad:null,onSlideLeave:null},s),function(){s.continuousVertical&&(s.loopTop||s.loopBottom)&&(s.continuousVertical=!1,ae("warn","Option `loopTop/loopBottom` is mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),s.continuousVertical&&s.scrollBar&&(s.continuousVertical=!1,ae("warn","Option `scrollBar` is mutually exclusive with `continuousVertical`; `continuousVertical` disabled")),t.each(s.anchors,function(e,i){(t("#"+i).length||t('[name="'+i+'"]').length)&&ae("error","data-anchor tags can not have the same value as any `id` element on the site (or `name` element for IE).")})}(),t.extend(t.easing,{easeInOutCubic:function(t,e,i,n,r){return 1>(e/=r/2)?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i}}),t.extend(t.easing,{easeInQuart:function(t,e,i,n,r){return n*(e/=r)*e*e*e+i}}),le.setAutoScrolling=function(e,i){oe("autoScrolling",e,i);var n=t(".fp-section.active");s.autoScrolling&&!s.scrollBar?(se.css({overflow:"hidden",height:"100%"}),le.setRecordHistory(s.recordHistory,"internal"),Ee.css({"-ms-touch-action":"none","touch-action":"none"}),n.length&&ie(n.position().top)):(se.css({overflow:"visible",height:"initial"}),le.setRecordHistory(!1,"internal"),Ee.css({"-ms-touch-action":"","touch-action":""}),ie(0),n.length&&se.scrollTop(n.position().top))},le.setRecordHistory=function(t,e){oe("recordHistory",t,e)},le.setScrollingSpeed=function(t,e){oe("scrollingSpeed",t,e)},le.setFitToSection=function(t,e){oe("fitToSection",t,e)},le.setMouseWheelScrolling=function(t){t?i.addEventListener?(i.addEventListener("mousewheel",_,!1),i.addEventListener("wheel",_,!1)):i.attachEvent("onmousewheel",_):i.addEventListener?(i.removeEventListener("mousewheel",_,!1),i.removeEventListener("wheel",_,!1)):i.detachEvent("onmousewheel",_)
},le.setAllowScrolling=function(e,i){"undefined"!=typeof i?(i=i.replace(/ /g,"").split(","),t.each(i,function(t,i){switch(i){case"up":xe.up=e;break;case"down":xe.down=e;break;case"left":xe.left=e;break;case"right":xe.right=e;break;case"all":le.setAllowScrolling(e)}})):e?(le.setMouseWheelScrolling(!0),K()):(le.setMouseWheelScrolling(!1),J())},le.setKeyboardScrolling=function(t){s.keyboardScrolling=t},le.moveSectionUp=function(){var e=t(".fp-section.active").prev(".fp-section");e.length||!s.loopTop&&!s.continuousVertical||(e=t(".fp-section").last()),e.length&&b(e,null,!0)},le.moveSectionDown=function(){var e=t(".fp-section.active").next(".fp-section");e.length||!s.loopBottom&&!s.continuousVertical||(e=t(".fp-section").first()),e.length&&b(e,null,!1)},le.silentMoveTo=function(t,e){if(le.setScrollingSpeed(0,"internal"),le.moveTo(t),le.setScrollingSpeed(be.scrollingSpeed,"internal"),"undefined"!=typeof e){var i=z(t),i=I(e,i);ee(i)}},le.moveTo=function(t,e){var i=z(t);"undefined"!=typeof e?j(t,e):0<i.length&&b(i)},le.moveSlideRight=function(){T("next")},le.moveSlideLeft=function(){T("prev")},le.reBuild=function(e){if(!Ee.hasClass("fp-destroyed")){ye=!0;var i=o.width();ve=o.height(),s.resize&&k(ve,i),t(".fp-section").each(function(){var e=t(this).find(".fp-slides"),i=t(this).find(".fp-slide");s.verticalCentered&&t(this).find(".fp-tableCell").css("height",F(t(this))+"px"),t(this).css("height",ve+"px"),s.scrollOverflow&&(i.length?i.each(function(){B(t(this))}):B(t(this))),1<i.length&&C(e,e.find(".fp-slide.active"))}),(i=t(".fp-section.active").index(".fp-section"))&&le.silentMoveTo(i+1),ye=!1,t.isFunction(s.afterResize)&&e&&s.afterResize.call(Ee),t.isFunction(s.afterReBuild)&&!e&&s.afterReBuild.call(Ee)}};var ce,ue,de,pe,fe=!1,me=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini)/),ge="ontouchstart"in e||0<navigator.msMaxTouchPoints||navigator.maxTouchPoints,Ee=t(this),ve=o.height(),ye=!1,_e=!0,Te=[],xe={up:!0,down:!0,left:!0,right:!0},be=t.extend(!0,{},s);t(this).length?(Ee.css({height:"100%",position:"relative"}),Ee.addClass("fullpage-wrapper"),t("html").addClass("fp-enabled")):ae("error","Error! Fullpage.js needs to be initialized with a selector. For example: $('#myContainer').fullpage();"),s.css3&&(s.css3=Z()),le.setAllowScrolling(!0),Ee.removeClass("fp-destroyed"),t(s.sectionSelector).each(function(){t(this).addClass("fp-section")}),t(s.slideSelector).each(function(){t(this).addClass("fp-slide")}),s.navigation&&l(),t(".fp-section").each(function(e){var i=t(this),n=t(this).find(".fp-slide"),r=n.length;if(e||0!==t(".fp-section.active").length||t(this).addClass("active"),t(this).css("height",ve+"px"),s.paddingTop&&t(this).css("padding-top",s.paddingTop),s.paddingBottom&&t(this).css("padding-bottom",s.paddingBottom),"undefined"!=typeof s.sectionsColor[e]&&t(this).css("background-color",s.sectionsColor[e]),"undefined"!=typeof s.anchors[e]&&(t(this).attr("data-anchor",s.anchors[e]),t(this).hasClass("active")&&D(s.anchors[e],e)),r>0){e=100*r;var o=100/r;n.wrapAll('<div class="fp-slidesContainer" />'),n.parent().wrap('<div class="fp-slides" />'),t(this).find(".fp-slidesContainer").css("width",e+"%"),s.controlArrows&&r>1&&h(t(this)),s.slidesNavigation&&W(t(this),r),n.each(function(){t(this).css("width",o+"%"),s.verticalCentered&&U(t(this))}),i=i.find(".fp-slide.active"),i.length?ee(i):n.eq(0).addClass("active")}else s.verticalCentered&&U(t(this))}).promise().done(function(){le.setAutoScrolling(s.autoScrolling,"internal");var n=t(".fp-section.active").find(".fp-slide.active");if(n.length&&(0!==t(".fp-section.active").index(".fp-section")||0===t(".fp-section.active").index(".fp-section")&&0!==n.index())&&ee(n),s.fixedElements&&s.css3&&t(s.fixedElements).appendTo(he),s.navigation&&(de.css("margin-top","-"+de.height()/2+"px"),de.find("li").eq(t(".fp-section.active").index(".fp-section")).find("a").addClass("active")),s.menu&&s.css3&&t(s.menu).closest(".fullpage-wrapper").length&&t(s.menu).appendTo(he),s.scrollOverflow?("complete"===i.readyState&&c(),o.on("load",c)):u(),A(),!s.animateAnchor&&(n=e.location.hash.replace("#","").split("/")[0],n.length)){var r=t('[data-anchor="'+n+'"]');r.length&&(s.autoScrolling?ie(r.position().top):(ie(0),se.scrollTop(r.position().top)),D(n,null),t.isFunction(s.afterLoad)&&s.afterLoad.call(r,n,r.index(".fp-section")+1),r.addClass("active").siblings().removeClass("active"))}$(),o.on("load",function(){var t=e.location.hash.replace("#","").split("/"),i=t[0],t=t[1];i&&j(i,t)})});var Re,we,He=!1;o.on("scroll",d);var Me=0,Se=0,Ce=0,Le=0,Ae=(new Date).getTime();o.on("hashchange",M),a.keydown(function(e){clearTimeout(Pe),pe=e.ctrlKey;var n=t(i.activeElement);n.is("textarea")||n.is("input")||n.is("select")||!s.keyboardScrolling||!s.autoScrolling||(-1<t.inArray(e.which,[40,38,32,33,34])&&e.preventDefault(),Pe=setTimeout(function(){var i=e.shiftKey;switch(e.which){case 38:case 33:le.moveSectionUp();break;case 32:if(i){le.moveSectionUp();break}case 40:case 34:le.moveSectionDown();break;case 36:le.moveTo(1);break;case 35:le.moveTo(t(".fp-section").length);break;case 37:le.moveSlideLeft();break;case 39:le.moveSlideRight()}},150))}),a.keyup(function(t){pe=t.ctrlKey});var Pe;Ee.mousedown(function(t){2==t.which&&(ke=t.pageY,Ee.on("mousemove",S))}),Ee.mouseup(function(t){2==t.which&&Ee.off("mousemove")});var ke=0;a.on("click touchstart","#fp-nav a",function(e){e.preventDefault(),e=t(this).parent().index(),b(t(".fp-section").eq(e))}),a.on("click touchstart",".fp-slidesNav a",function(e){e.preventDefault(),e=t(this).closest(".fp-section").find(".fp-slides");var i=e.find(".fp-slide").eq(t(this).closest("li").index());C(e,i)}),s.normalScrollElements&&(a.on("mouseenter",s.normalScrollElements,function(){le.setMouseWheelScrolling(!1)}),a.on("mouseleave",s.normalScrollElements,function(){le.setMouseWheelScrolling(!0)})),t(".fp-section").on("click touchstart",".fp-controlArrow",function(){t(this).hasClass("fp-prev")?xe.left&&le.moveSlideLeft():xe.right&&le.moveSlideRight()}),o.resize(L);var De,Oe=ve;le.destroy=function(e){le.setAutoScrolling(!1,"internal"),le.setAllowScrolling(!1),le.setKeyboardScrolling(!1),Ee.addClass("fp-destroyed"),o.off("scroll",d).off("hashchange",M).off("resize",L),a.off("click","#fp-nav a").off("mouseenter","#fp-nav li").off("mouseleave","#fp-nav li").off("click",".fp-slidesNav a").off("mouseover",s.normalScrollElements).off("mouseout",s.normalScrollElements),t(".fp-section").off("click",".fp-controlArrow"),e&&re()}}});var THREE={REVISION:"70"};"object"==typeof module&&(module.exports=THREE),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:0}),THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.MinEquation=103,THREE.MaxEquation=104,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=300,THREE.CubeReflectionMapping=301,THREE.CubeRefractionMapping=302,THREE.EquirectangularReflectionMapping=303,THREE.EquirectangularRefractionMapping=304,THREE.SphericalReflectionMapping=305,THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGBEFormat=THREE.RGBAFormat,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.RGB_PVRTC_4BPPV1_Format=2100,THREE.RGB_PVRTC_2BPPV1_Format=2101,THREE.RGBA_PVRTC_4BPPV1_Format=2102,THREE.RGBA_PVRTC_2BPPV1_Format=2103,THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},THREE.Color=function(t){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(t)},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(t,e,i){if(0===e)this.r=this.g=this.b=i;else{var n=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+6*(e-t)*(2/3-i):t};e=.5>=i?i*(1+e):i+e-i*e,i=2*i-e,this.r=n(i,e,t+1/3),this.g=n(i,e,t),this.b=n(i,e,t-1/3)}return this},setStyle:function(t){return/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(t)?(t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(t),this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this):/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(t)?(t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(t),this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this):/^\#([0-9a-f]{6})$/i.test(t)?(t=/^\#([0-9a-f]{6})$/i.exec(t),this.setHex(parseInt(t[1],16)),this):/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)?(t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t),this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this):/^(\w+)$/i.test(t)?(this.setHex(THREE.ColorKeywords[t]),this):void 0},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,i=this.r,n=this.g,r=this.b,o=Math.max(i,n,r),a=Math.min(i,n,r),s=(a+o)/2;if(a===o)a=e=0;else{var h=o-a,a=.5>=s?h/(o+a):h/(2-o-a);switch(o){case i:e=(n-r)/h+(r>n?6:0);break;case n:e=(r-i)/h+2;break;case r:e=(i-n)/h+4}e/=6}return t.h=e,t.s=a,t.l=s,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1==t instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2);return"XYZ"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"YXZ"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"ZXY"===t.order?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r-o*a*s):"ZYX"===t.order?(this._x=o*n*r-i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r+o*a*s):"YZX"===t.order?(this._x=o*n*r+i*a*s,this._y=i*a*r+o*n*s,this._z=i*n*s-o*a*r,this._w=i*n*r-o*a*s):"XZY"===t.order&&(this._x=o*n*r-i*a*s,this._y=i*a*r-o*n*s,this._z=i*n*s+o*a*r,this._w=i*n*r+o*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=t.elements,i=e[0];t=e[4];var n=e[8],r=e[1],o=e[5],a=e[9],s=e[2],h=e[6],e=e[10],l=i+o+e;return l>0?(i=.5/Math.sqrt(l+1),this._w=.25/i,this._x=(h-a)*i,this._y=(n-s)*i,this._z=(r-t)*i):i>o&&i>e?(i=2*Math.sqrt(1+i-o-e),this._w=(h-a)/i,this._x=.25*i,this._y=(t+r)/i,this._z=(n+s)/i):o>e?(i=2*Math.sqrt(1+o-i-e),this._w=(n-s)/i,this._x=(t+r)/i,this._y=.25*i,this._z=(a+h)/i):(i=2*Math.sqrt(1+e-i-o),this._w=(r-t)/i,this._x=(n+s)/i,this._y=(a+h)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(i,n){return void 0===t&&(t=new THREE.Vector3),e=i.dot(n)+1,1e-6>e?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,o=t._w,a=e._x,s=e._y,h=e._z,l=e._w;return this._x=i*l+o*a+n*h-r*s,this._y=n*l+o*s+r*a-i*h,this._z=r*l+o*h+i*s-n*a,this._w=o*l-i*a-n*s-r*h,this.onChangeCallback(),this},multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,o=this._w,a=o*t._w+i*t._x+n*t._y+r*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=Math.acos(a),h=Math.sqrt(1-a*a);return.001>Math.abs(h)?(this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this):(a=Math.sin((1-e)*s)/h,s=Math.sin(e*s)/h,this._w=o*a+this._w*s,this._x=i*a+this._x*s,this._y=n*a+this._y*s,this._z=r*a+this._z*s,this.onChangeCallback(),this)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(t,e,i,n){return i.copy(t).slerp(e,n)},THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t):this.y=this.x=0,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new THREE.Vector2,e=new THREE.Vector2),t.set(i,i),e.set(n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t;return function(e){return!1==e instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t;return function(e,i){return void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromAxisAngle(e,i)),this}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*i+t[6]*n,this.y=t[1]*e+t[4]*i+t[7]*n,this.z=t[2]*e+t[5]*i+t[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n+t[12],this.y=t[1]*e+t[5]*i+t[9]*n+t[13],this.z=t[2]*e+t[6]*i+t[10]*n+t[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z;t=t.elements;var r=1/(t[3]*e+t[7]*i+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*i+t[8]*n+t[12])*r,this.y=(t[1]*e+t[5]*i+t[9]*n+t[13])*r,this.z=(t[2]*e+t[6]*i+t[10]*n+t[14])*r,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z;t=t.w;var s=t*e+o*n-a*i,h=t*i+a*e-r*n,l=t*n+r*i-o*e,e=-r*e-o*i-a*n;return this.x=s*t+e*-r+h*-a-l*-o,this.y=h*t+e*-o+l*-r-s*-a,this.z=l*t+e*-a+s*-o-h*-r,this},project:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(e){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n,this.y=t[1]*e+t[5]*i+t[9]*n,this.z=t[2]*e+t[6]*i+t[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new THREE.Vector3,e=new THREE.Vector3),t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var i=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},projectOnVector:function(){var t,e;return function(i){return void 0===t&&(t=new THREE.Vector3),t.copy(i).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3),t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t;return function(e){return void 0===t&&(t=new THREE.Vector3),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/(this.length()*t.length()),Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return t=this.z-t.z,e*e+i*i+t*t},setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),i=this.set(t.elements[4],t.elements[5],t.elements[6]).length();return t=this.set(t.elements[8],t.elements[9],t.elements[10]).length(),this.x=e,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,e){var i=4*t,n=e.elements;return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t
},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return t=t.elements,this.x=t[0]*e+t[4]*i+t[8]*n+t[12]*r,this.y=t[1]*e+t[5]*i+t[9]*n+t[13]*r,this.z=t[2]*e+t[6]*i+t[10]*n+t[14]*r,this.w=t[3]*e+t[7]*i+t[11]*n+t[15]*r,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.z=this.y=this.x=0,this.w=1),this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n;t=t.elements;var r=t[0];n=t[4];var o=t[8],a=t[1],s=t[5],h=t[9];i=t[2],e=t[6];var l=t[10];return.01>Math.abs(n-a)&&.01>Math.abs(o-i)&&.01>Math.abs(h-e)?.1>Math.abs(n+a)&&.1>Math.abs(o+i)&&.1>Math.abs(h+e)&&.1>Math.abs(r+s+l-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,s=(s+1)/2,l=(l+1)/2,n=(n+a)/4,o=(o+i)/4,h=(h+e)/4,r>s&&r>l?.01>r?(e=0,n=i=.707106781):(e=Math.sqrt(r),i=n/e,n=o/e):s>l?.01>s?(e=.707106781,i=0,n=.707106781):(i=Math.sqrt(s),e=n/i,n=h/i):.01>l?(i=e=.707106781,n=0):(n=Math.sqrt(l),e=o/n,i=h/n),this.set(e,i,n,t),this):(t=Math.sqrt((e-h)*(e-h)+(o-i)*(o-i)+(a-n)*(a-n)),.001>Math.abs(t)&&(t=1),this.x=(e-h)/t,this.y=(o-i)/t,this.z=(a-n)/t,this.w=Math.acos((r+s+l-1)/2),this)},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new THREE.Vector4,e=new THREE.Vector4),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=THREE.Math.clamp,r=t.elements;t=r[0];var o=r[4],a=r[8],s=r[1],h=r[5],l=r[9],c=r[2],u=r[6],r=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(n(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-l,r),this._z=Math.atan2(-o,t)):(this._x=Math.atan2(u,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(a,r),this._z=Math.atan2(s,h)):(this._y=Math.atan2(-c,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(u,-1,1)),.99999>Math.abs(u)?(this._y=Math.atan2(-c,r),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(s,t))):"ZYX"===e?(this._y=Math.asin(-n(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(u,r),this._z=Math.atan2(s,t)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"===e?(this._z=Math.asin(n(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-c,t)):(this._x=0,this._y=Math.atan2(a,r))):"XZY"===e?(this._z=Math.asin(-n(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(u,h),this._y=Math.atan2(a,t)):(this._x=Math.atan2(-l,r),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,i,n){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n),this}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new THREE.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(t,e){this.start=void 0!==t?t:new THREE.Vector3,this.end=void 0!==e?e:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){return(t||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new THREE.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),r=e.dot(t)/r;return n&&(r=THREE.Math.clamp(r,0,1)),r}}(),closestPointToPoint:function(t,e,i){return t=this.closestPointToPointParameter(t,e),i=i||new THREE.Vector3,this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2(1/0,1/0),this.max=void 0!==e?e:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new THREE.Vector2;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y?!0:!1},getParameter:function(t,e){return(e||new THREE.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,e){return(e||new THREE.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector2;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;i>e;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new THREE.Vector3;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(){var t=new THREE.Vector3;return function(e){var i=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){var n=e.geometry;if(void 0!==n)if(n instanceof THREE.Geometry)for(var r=n.vertices,n=0,o=r.length;o>n;n++)t.copy(r[n]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t);else if(n instanceof THREE.BufferGeometry&&void 0!==n.attributes.position)for(r=n.attributes.position.array,n=0,o=r.length;o>n;n+=3)t.set(r[n],r[n+1],r[n+2]),t.applyMatrix4(e.matrixWorld),i.expandByPoint(t)}),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z?!0:!1},getParameter:function(t,e){return(e||new THREE.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},clampPoint:function(t,e){return(e||new THREE.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new THREE.Vector3;return function(e){return e=e||new THREE.Sphere,e.center=this.center(),e.radius=.5*this.size(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,e,i,n,r,o,a,s,h){var l=this.elements;return l[0]=t,l[3]=e,l[6]=i,l[1]=n,l[4]=r,l[7]=o,l[2]=a,l[5]=s,l[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t=new THREE.Vector3;return function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0;n>r;r+=3,i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyMatrix3(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],h=t[7],t=t[8];return e*o*t-e*a*h-i*r*t+i*a*s+n*r*h-n*o*s},getInverse:function(t,e){var i=t.elements,n=this.elements;if(n[0]=i[10]*i[5]-i[6]*i[9],n[1]=-i[10]*i[1]+i[2]*i[9],n[2]=i[6]*i[1]-i[2]*i[5],n[3]=-i[10]*i[4]+i[6]*i[8],n[4]=i[10]*i[0]-i[2]*i[8],n[5]=-i[6]*i[0]+i[2]*i[4],n[6]=i[9]*i[4]-i[5]*i[8],n[7]=-i[9]*i[0]+i[1]*i[8],n[8]=i[5]*i[0]-i[1]*i[4],i=i[0]*n[0]+i[1]*n[3]+i[2]*n[6],0===i){if(e)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/i),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,i,n,r,o,a,s,h,l,c,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=h,g[6]=l,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,i){var n=this.elements;return t.set(n[0],n[1],n[2]),e.set(n[4],n[5],n[6]),i.set(n[8],n[9],n[10]),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t=new THREE.Vector3;return function(e){var i=this.elements;e=e.elements;var n=1/t.set(e[0],e[1],e[2]).length(),r=1/t.set(e[4],e[5],e[6]).length(),o=1/t.set(e[8],e[9],e[10]).length();return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[4]=e[4]*r,i[5]=e[5]*r,i[6]=e[6]*r,i[8]=e[8]*o,i[9]=e[9]*o,i[10]=e[10]*o,this}}(),makeRotationFromEuler:function(t){!1==t instanceof THREE.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,o=Math.cos(i),i=Math.sin(i),a=Math.cos(n),n=Math.sin(n),s=Math.cos(r),r=Math.sin(r);if("XYZ"===t.order){t=o*s;var h=o*r,l=i*s,c=i*r;e[0]=a*s,e[4]=-a*r,e[8]=n,e[1]=h+l*n,e[5]=t-c*n,e[9]=-i*a,e[2]=c-t*n,e[6]=l+h*n,e[10]=o*a}else"YXZ"===t.order?(t=a*s,h=a*r,l=n*s,c=n*r,e[0]=t+c*i,e[4]=l*i-h,e[8]=o*n,e[1]=o*r,e[5]=o*s,e[9]=-i,e[2]=h*i-l,e[6]=c+t*i,e[10]=o*a):"ZXY"===t.order?(t=a*s,h=a*r,l=n*s,c=n*r,e[0]=t-c*i,e[4]=-o*r,e[8]=l+h*i,e[1]=h+l*i,e[5]=o*s,e[9]=c-t*i,e[2]=-o*n,e[6]=i,e[10]=o*a):"ZYX"===t.order?(t=o*s,h=o*r,l=i*s,c=i*r,e[0]=a*s,e[4]=l*n-h,e[8]=t*n+c,e[1]=a*r,e[5]=c*n+t,e[9]=h*n-l,e[2]=-n,e[6]=i*a,e[10]=o*a):"YZX"===t.order?(t=o*a,h=o*n,l=i*a,c=i*n,e[0]=a*s,e[4]=c-t*r,e[8]=l*r+h,e[1]=r,e[5]=o*s,e[9]=-i*s,e[2]=-n*s,e[6]=h*r+l,e[10]=t-c*r):"XZY"===t.order&&(t=o*a,h=o*n,l=i*a,c=i*n,e[0]=a*s,e[4]=-r,e[8]=n*s,e[1]=t*r+c,e[5]=o*s,e[9]=h*r-l,e[2]=l*r-h,e[6]=i*s,e[10]=c*r+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z,o=t.w,a=i+i,s=n+n,h=r+r;t=i*a;var l=i*s,i=i*h,c=n*s,n=n*h,r=r*h,a=o*a,s=o*s,o=o*h;return e[0]=1-(c+r),e[4]=l-o,e[8]=i+s,e[1]=l+o,e[5]=1-(t+r),e[9]=n-a,e[2]=i-s,e[6]=n+a,e[10]=1-(t+c),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o){var a=this.elements;return i.subVectors(n,r).normalize(),0===i.length()&&(i.z=1),t.crossVectors(o,i).normalize(),0===t.length()&&(i.x+=1e-4,t.crossVectors(o,i).normalize()),e.crossVectors(i,t),a[0]=t.x,a[4]=e.x,a[8]=i.x,a[1]=t.y,a[5]=e.y,a[9]=i.y,a[2]=t.z,a[6]=e.z,a[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],h=i[12],l=i[1],c=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],E=i[3],v=i[7],y=i[11],i=i[15],_=n[0],T=n[4],x=n[8],b=n[12],R=n[1],w=n[5],H=n[9],M=n[13],S=n[2],C=n[6],L=n[10],A=n[14],P=n[3],k=n[7],D=n[11],n=n[15];return r[0]=o*_+a*R+s*S+h*P,r[4]=o*T+a*w+s*C+h*k,r[8]=o*x+a*H+s*L+h*D,r[12]=o*b+a*M+s*A+h*n,r[1]=l*_+c*R+u*S+d*P,r[5]=l*T+c*w+u*C+d*k,r[9]=l*x+c*H+u*L+d*D,r[13]=l*b+c*M+u*A+d*n,r[2]=p*_+f*R+m*S+g*P,r[6]=p*T+f*w+m*C+g*k,r[10]=p*x+f*H+m*L+g*D,r[14]=p*b+f*M+m*A+g*n,r[3]=E*_+v*R+y*S+i*P,r[7]=E*T+v*w+y*C+i*k,r[11]=E*x+v*H+y*L+i*D,r[15]=E*b+v*M+y*A+i*n,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t=new THREE.Vector3;return function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var r=0;n>r;r+=3,i+=3)t.x=e[i],t.y=e[i+1],t.z=e[i+2],t.applyMatrix4(this),e[i]=t.x,e[i+1]=t.y,e[i+2]=t.z;return e}}(),rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],h=t[13],l=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+r*s*c-n*h*c-r*a*u+i*h*u+n*a*d-i*s*d)+t[7]*(+e*s*d-e*h*u+r*o*u-n*o*d+n*h*l-r*s*l)+t[11]*(+e*h*c-e*a*d-r*o*c+i*o*d+r*a*l-i*h*l)+t[15]*(-n*a*l-e*s*c+e*a*u+n*o*c-i*o*u+i*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){var t=new THREE.Vector3;return function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],o=n[4],a=n[8],s=n[12],h=n[1],l=n[5],c=n[9],u=n[13],d=n[2],p=n[6],f=n[10],m=n[14],g=n[3],E=n[7],v=n[11],n=n[15];if(i[0]=c*m*E-u*f*E+u*p*v-l*m*v-c*p*n+l*f*n,i[4]=s*f*E-a*m*E-s*p*v+o*m*v+a*p*n-o*f*n,i[8]=a*u*E-s*c*E+s*l*v-o*u*v-a*l*n+o*c*n,i[12]=s*c*p-a*u*p-s*l*f+o*u*f+a*l*m-o*c*m,i[1]=u*f*g-c*m*g-u*d*v+h*m*v+c*d*n-h*f*n,i[5]=a*m*g-s*f*g+s*d*v-r*m*v-a*d*n+r*f*n,i[9]=s*c*g-a*u*g-s*h*v+r*u*v+a*h*n-r*c*n,i[13]=a*u*d-s*c*d+s*h*f-r*u*f-a*h*m+r*c*m,i[2]=l*m*g-u*p*g+u*d*E-h*m*E-l*d*n+h*p*n,i[6]=s*p*g-o*m*g-s*d*E+r*m*E+o*d*n-r*p*n,i[10]=o*u*g-s*l*g+s*h*E-r*u*E-o*h*n+r*l*n,i[14]=s*l*d-o*u*d-s*h*p+r*u*p+o*h*m-r*l*m,i[3]=c*p*g-l*f*g-c*d*E+h*f*E+l*d*v-h*p*v,i[7]=o*f*g-a*p*g+a*d*E-r*f*E-o*d*v+r*p*v,i[11]=a*l*g-o*c*g-a*h*E+r*c*E+o*h*v-r*l*v,i[15]=o*c*d-a*l*d+a*h*p-r*c*p-o*h*f+r*l*f,i=r*i[0]+h*i[4]+d*i[8]+g*i[12],0==i){if(e)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/i),this},translate:function(){console.warn("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.warn("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.warn("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.warn("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var e=this.elements,i=t.x,n=t.y;return t=t.z,e[0]*=i,e[4]*=n,e[8]*=t,e[1]*=i,e[5]*=n,e[9]*=t,e[2]*=i,e[6]*=n,e[10]*=t,e[3]*=i,e[7]*=n,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],Math.max(t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10])))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,h=r*o,l=r*a;return this.set(h*o+i,h*a-n*s,h*s+n*a,0,h*a+n*s,l*a+i,l*s-n*o,0,h*s-n*a,l*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t=new THREE.Vector3,e=new THREE.Matrix4;return function(i,n,r){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),h=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),i.x=o[12],i.y=o[13],i.z=o[14],e.elements.set(this.elements),i=1/a;var o=1/s,l=1/h;return e.elements[0]*=i,e.elements[1]*=i,e.elements[2]*=i,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=l,e.elements[9]*=l,e.elements[10]*=l,n.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=h,this}}(),makeFrustum:function(t,e,i,n,r,o){var a=this.elements;return a[0]=2*r/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*r/(n-i),a[9]=(n+i)/(n-i),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+r)/(o-r),a[14]=-2*o*r/(o-r),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,n){t=i*Math.tan(THREE.Math.degToRad(.5*t));var r=-t;return this.makeFrustum(r*e,t*e,r,t,i,n)},makeOrthographic:function(t,e,i,n,r,o){var a=this.elements,s=e-t,h=i-n,l=o-r;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-((e+t)/s),a[1]=0,a[5]=2/h,a[9]=0,a[13]=-((i+n)/h),a[2]=0,a[6]=0,a[10]=-2/l,a[14]=-((o+r)/l),a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}},THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3,this.direction=void 0!==e?e:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new THREE.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new THREE.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new THREE.Vector3;i.subVectors(t,this.origin);var n=i.dot(this.direction);return 0>n?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return 0>i?this.origin.distanceTo(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceTo(e))}}(),distanceSqToSegment:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o,a){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var s,h=.5*n.distanceTo(r),l=-this.direction.dot(e),c=i.dot(this.direction),u=-i.dot(e),d=i.lengthSq(),p=Math.abs(1-l*l);return p>0?(n=l*u-c,r=l*c-u,s=h*p,n>=0?r>=-s?s>=r?(h=1/p,n*=h,r*=h,l=n*(n+l*r+2*c)+r*(l*n+r+2*u)+d):(r=h,n=Math.max(0,-(l*r+c)),l=-n*n+r*(r+2*u)+d):(r=-h,n=Math.max(0,-(l*r+c)),l=-n*n+r*(r+2*u)+d):-s>=r?(n=Math.max(0,-(-l*h+c)),r=n>0?-h:Math.min(Math.max(-h,-u),h),l=-n*n+r*(r+2*u)+d):s>=r?(n=0,r=Math.min(Math.max(-h,-u),h),l=r*(r+2*u)+d):(n=Math.max(0,-(l*h+c)),r=n>0?h:Math.min(Math.max(-h,-u),h),l=-n*n+r*(r+2*u)+d)):(r=l>0?-h:h,n=Math.max(0,-(l*r+c)),l=-n*n+r*(r+2*u)+d),o&&o.copy(this.direction).multiplyScalar(n).add(this.origin),a&&a.copy(e).multiplyScalar(r).add(t),l}}(),isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},intersectSphere:function(){var t=new THREE.Vector3;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n,o=e.radius*e.radius;return r>o?null:(o=Math.sqrt(o-r),r=n-o,n+=o,0>r&&0>n?null:0>r?this.at(n,i):this.at(r,i))
}}(),isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e?!0:!1},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0==e?0==t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,t>=0?t:null)},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},isIntersectionBox:function(){var t=new THREE.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var i,n,r,o,a;n=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return n>=0?(i=(t.min.x-s.x)*n,n*=t.max.x-s.x):(i=(t.max.x-s.x)*n,n*=t.min.x-s.x),o>=0?(r=(t.min.y-s.y)*o,o*=t.max.y-s.y):(r=(t.max.y-s.y)*o,o*=t.min.y-s.y),i>o||r>n?null:((r>i||i!==i)&&(i=r),(n>o||n!==n)&&(n=o),a>=0?(r=(t.min.z-s.z)*a,a*=t.max.z-s.z):(r=(t.max.z-s.z)*a,a*=t.min.z-s.z),i>a||r>n?null:((r>i||i!==i)&&(i=r),(n>a||n!==n)&&(n=a),0>n?null:this.at(i>=0?i:n,e)))},intersectTriangle:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3;return function(r,o,a,s,h){if(e.subVectors(o,r),i.subVectors(a,r),n.crossVectors(e,i),o=this.direction.dot(n),o>0){if(s)return null;s=1}else{if(!(0>o))return null;s=-1,o=-o}return t.subVectors(this.origin,r),r=s*this.direction.dot(i.crossVectors(t,i)),0>r?null:(a=s*this.direction.dot(e.cross(t)),0>a||r+a>o?null:(r=-s*t.dot(n),0>r?null:this.at(r/o,h)))}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3,this.radius=void 0!==e?e:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new THREE.Box3;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).center(n);for(var r=0,o=0,a=e.length;a>o;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}}(),copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new THREE.Vector3;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){return t=t||new THREE.Box3,t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(t,e,i,n,r,o){this.planes=[void 0!==t?t:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(t,e,i,n,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},copy:function(t){for(var e=this.planes,i=0;6>i;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements;t=i[0];var n=i[1],r=i[2],o=i[3],a=i[4],s=i[5],h=i[6],l=i[7],c=i[8],u=i[9],d=i[10],p=i[11],f=i[12],m=i[13],g=i[14],i=i[15];return e[0].setComponents(o-t,l-a,p-c,i-f).normalize(),e[1].setComponents(o+t,l+a,p+c,i+f).normalize(),e[2].setComponents(o+n,l+s,p+u,i+m).normalize(),e[3].setComponents(o-n,l-s,p-u,i-m).normalize(),e[4].setComponents(o-r,l-h,p-d,i-g).normalize(),e[5].setComponents(o+r,l+h,p+d,i+g).normalize(),this},intersectsObject:function(){var t=new THREE.Sphere;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,i=t.center;t=-t.radius;for(var n=0;6>n;n++)if(e[n].distanceToPoint(i)<t)return!1;return!0},intersectsBox:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){for(var n=this.planes,r=0;6>r;r++){var o=n[r];t.x=0<o.normal.x?i.min.x:i.max.x,e.x=0<o.normal.x?i.max.x:i.min.x,t.y=0<o.normal.y?i.min.y:i.max.y,e.y=0<o.normal.y?i.max.y:i.min.y,t.z=0<o.normal.z?i.min.z:i.max.z,e.z=0<o.normal.z?i.max.z:i.min.z;var a=o.distanceToPoint(t),o=o.distanceToPoint(e);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;6>i;i++)if(0>e[i].distanceToPoint(t))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i,n,r){return n=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize(),this.setFromNormalAndCoplanarPoint(n,i),this}}(),copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t);return(e||new THREE.Vector3).copy(this.normal).multiplyScalar(i)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&t>0||0>t&&e>0},intersectLine:function(){var t=new THREE.Vector3;return function(e,i){var n=i||new THREE.Vector3,r=e.delta(t),o=this.normal.dot(r);return 0!=o?(o=-(e.start.dot(this.normal)+this.constant)/o,0>o||o>1?void 0:n.copy(r).multiplyScalar(o).add(e.start)):0==this.distanceToPoint(e.start)?n.copy(e.start):void 0}}(),coplanarPoint:function(t){return(t||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Matrix3;return function(n,r){var o=r||i.getNormalMatrix(n),o=t.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(e);return a.applyMatrix4(n),this.setFromNormalAndCoplanarPoint(o,a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=Array(36),n=0;return function(){for(var r=0;36>r;r++)8==r||13==r||18==r||23==r?i[r]="-":14==r?i[r]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[r]=e[19==r?3&t|8:t]);return i.join("")}}(),clamp:function(t,e,i){return e>t?e:t>i?i:t},clampBottom:function(t,e){return e>t?e:t},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},smoothstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return Math.floor(this.randFloat(t,e))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}(),isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t}},THREE.Spline=function(t){function e(t,e,i,n,r,o,a){return t=.5*(i-t),n=.5*(n-e),(2*(e-i)+t+n)*a+(-3*(e-i)-2*t-n)*o+t*r+e}this.points=t;var i,n,r,o,a,s,h,l,c,u=[],d={x:0,y:0,z:0};this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return i=(this.points.length-1)*t,n=Math.floor(i),r=i-n,u[0]=0===n?n:n-1,u[1]=n,u[2]=n>this.points.length-2?this.points.length-1:n+1,u[3]=n>this.points.length-3?this.points.length-1:n+2,s=this.points[u[0]],h=this.points[u[1]],l=this.points[u[2]],c=this.points[u[3]],o=r*r,a=r*o,d.x=e(s.x,h.x,l.x,c.x,r,o,a),d.y=e(s.y,h.y,l.y,c.y,r,o,a),d.z=e(s.z,h.z,l.z,c.z,r,o,a),d},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;i>t;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,r=e=e=0,o=new THREE.Vector3,a=new THREE.Vector3,s=[],h=0;for(s[0]=0,t||(t=100),i=this.points.length*t,o.copy(this.points[0]),t=1;i>t;t++)e=t/i,n=this.getPoint(e),a.copy(n),h+=a.distanceTo(o),o.copy(n),e*=this.points.length-1,e=Math.floor(e),e!=r&&(s[e]=h,r=e);return s[s.length]=h,{chunks:s,total:h}},this.reparametrizeByArcLength=function(t){var e,i,n,r,o,a,s=[],h=new THREE.Vector3,l=this.getLength();for(s.push(h.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(i=l.chunks[e]-l.chunks[e-1],a=Math.ceil(t*i/l.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),i=1;a-1>i;i++)n=r+1/a*i*(o-r),n=this.getPoint(n),s.push(h.copy(n).clone());s.push(h.copy(this.points[e]).clone())}this.points=s}},THREE.Triangle=function(t,e,i){this.a=void 0!==t?t:new THREE.Vector3,this.b=void 0!==e?e:new THREE.Vector3,this.c=void 0!==i?i:new THREE.Vector3},THREE.Triangle.normal=function(){var t=new THREE.Vector3;return function(e,i,n,r){return r=r||new THREE.Vector3,r.subVectors(n,i),t.subVectors(e,i),r.cross(t),e=r.lengthSq(),e>0?r.multiplyScalar(1/Math.sqrt(e)):r.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(n,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),i.subVectors(n,r),n=t.dot(t),r=t.dot(e),o=t.dot(i);var h=e.dot(e);a=e.dot(i);var l=n*h-r*r;return s=s||new THREE.Vector3,0==l?s.set(-2,-1,-1):(l=1/l,h=(h*o-r*a)*l,n=(n*a-r*o)*l,s.set(1-h-n,n,h))}}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3;return function(e,i,n,r){return e=THREE.Triangle.barycoordFromPoint(e,i,n,r,t),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return THREE.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Clock=function(t){this.autoStart=void 0!==t?t:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),t=.001*(e-this.oldTime);this.oldTime=e,this.elapsedTime+=t}return t}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(t){t.addEventListener=THREE.EventDispatcher.prototype.addEventListener,t.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,t.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=[],n=e.length,r=0;n>r;r++)i[r]=e[r];for(r=0;n>r;r++)i[r].call(this,t)}}}},function(t){t.Raycaster=function(e,i,n,r){this.ray=new t.Ray(e,i),this.near=n||0,this.far=r||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var e=function(t,e){return t.distance-e.distance},i=function(t,e,n,r){if(t.raycast(e,n),!0===r){t=t.children,r=0;for(var o=t.length;o>r;r++)i(t[r],e,n,!0)}};t.Raycaster.prototype={constructor:t.Raycaster,precision:1e-4,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,i){i instanceof t.PerspectiveCamera?(this.ray.origin.copy(i.position),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(i.position).normalize()):i instanceof t.OrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,n){var r=[];return i(t,this,r,n),r.sort(e),r},intersectObjects:function(t,n){var r=[];if(!1==t instanceof Array)return console.log("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var o=0,a=t.length;a>o;o++)i(t[o],this,r,n);return r.sort(e),r}}}(THREE),THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var t=new THREE.Vector3,e=new THREE.Euler,i=new THREE.Quaternion,n=new THREE.Vector3(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n}}),this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(t){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=t},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new THREE.Quaternion;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new THREE.Vector3;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new THREE.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new THREE.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add:",t,"can't be added as a child of itself."),this):(t instanceof THREE.Object3D?(void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add:",t,"is not an instance of THREE.Object3D."),this)},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);e=this.children.indexOf(t),-1!==e&&(t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(e,1))},getChildByName:function(t,e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t,e)},getObjectById:function(t,e){return this.getObjectByProperty("id",t,e)},getObjectByName:function(t,e){return this.getObjectByProperty("name",t,e)},getObjectByProperty:function(t,e,i){if(this[t]===e)return this;for(var n=0,r=this.children.length;r>n;n++){var o=this.children[n].getObjectByProperty(t,e,i);if(void 0!==o)return o}},getWorldPosition:function(t){return t=t||new THREE.Vector3,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){return i=i||new THREE.Quaternion,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new THREE.Quaternion;return function(e){return e=e||new THREE.Euler,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new THREE.Vector3,e=new THREE.Quaternion;return function(i){return i=i||new THREE.Vector3,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new THREE.Quaternion;return function(e){return e=e||new THREE.Vector3,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=0,i=this.children.length;i>e;e++)this.children[e].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=0,i=this.children.length;i>e;e++)this.children[e].traverseVisible(t)}},traverseAncestors:function(t){this.parent&&(t(this.parent),this.parent.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===t)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=0,i=this.children.length;i>e;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(){var t={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},e={},i=function(i){if(void 0===t.geometries&&(t.geometries=[]),void 0===e[i.uuid]){var n=i.toJSON();delete n.metadata,e[i.uuid]=n,t.geometries.push(n)}return i.uuid},n={},r=function(e){if(void 0===t.materials&&(t.materials=[]),void 0===n[e.uuid]){var i=e.toJSON();delete i.metadata,n[e.uuid]=i,t.materials.push(i)}return e.uuid},o=function(t){var e={};if(e.uuid=t.uuid,e.type=t.type,""!==t.name&&(e.name=t.name),"{}"!==JSON.stringify(t.userData)&&(e.userData=t.userData),!0!==t.visible&&(e.visible=t.visible),t instanceof THREE.PerspectiveCamera?(e.fov=t.fov,e.aspect=t.aspect,e.near=t.near,e.far=t.far):t instanceof THREE.OrthographicCamera?(e.left=t.left,e.right=t.right,e.top=t.top,e.bottom=t.bottom,e.near=t.near,e.far=t.far):t instanceof THREE.AmbientLight?e.color=t.color.getHex():t instanceof THREE.DirectionalLight?(e.color=t.color.getHex(),e.intensity=t.intensity):t instanceof THREE.PointLight?(e.color=t.color.getHex(),e.intensity=t.intensity,e.distance=t.distance):t instanceof THREE.SpotLight?(e.color=t.color.getHex(),e.intensity=t.intensity,e.distance=t.distance,e.angle=t.angle,e.exponent=t.exponent):t instanceof THREE.HemisphereLight?(e.color=t.color.getHex(),e.groundColor=t.groundColor.getHex()):t instanceof THREE.Mesh?(e.geometry=i(t.geometry),e.material=r(t.material)):t instanceof THREE.Line?(e.geometry=i(t.geometry),e.material=r(t.material)):t instanceof THREE.Sprite&&(e.material=r(t.material)),e.matrix=t.matrix.toArray(),0<t.children.length){e.children=[];for(var n=0;n<t.children.length;n++)e.children.push(o(t.children[n]))}return e};return t.object=o(this),t},clone:function(t,e){if(void 0===t&&(t=new THREE.Object3D),void 0===e&&(e=!0),t.name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.quaternion.copy(this.quaternion),t.scale.copy(this.scale),t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData)),!0===e)for(var i=0;i<this.children.length;i++)t.add(this.children[i].clone());return t}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Face3=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3,this.vertexNormals=n instanceof Array?n:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var t=new THREE.Face3(this.a,this.b,this.c);t.normal.copy(this.normal),t.color.copy(this.color),t.materialIndex=this.materialIndex;for(var e=0,i=this.vertexNormals.length;i>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,i=this.vertexColors.length;i>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,i=this.vertexTangents.length;i>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Face4=function(t,e,i,n,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(t,e,i,r,o,a)},THREE.BufferAttribute=function(t,e){this.array=t,this.itemSize=e,this.needsUpdate=!1},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;r>n;n++)this.array[t+n]=e.array[i+n]},set:function(t){return this.array.set(t),this},setX:function(t,e){return this.array[t*this.itemSize]=e,this},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},clone:function(){return new THREE.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},THREE.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(t,e)},THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.offsets=this.drawcalls=[],this.boundingSphere=this.boundingBox=null},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(t,e,i){!1==e instanceof THREE.BufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.attributes[t]={array:e,itemSize:i}):(this.attributes[t]=e,this.attributesKeys=Object.keys(this.attributes))},getAttribute:function(t){return this.attributes[t]},addDrawCall:function(t,e,i){this.drawcalls.push({start:t,count:e,index:void 0!==i?i:0})},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0),e=this.attributes.normal,void 0!==e&&((new THREE.Matrix3).getNormalMatrix(t).applyToVector3Array(e.array),e.needsUpdate=!0)},center:function(){},fromGeometry:function(t,e){e=e||{vertexColors:THREE.NoColors};var i=t.vertices,n=t.faces,r=t.faceVertexUvs,o=e.vertexColors,a=0<r[0].length,s=3==n[0].vertexNormals.length,h=new Float32Array(9*n.length);this.addAttribute("position",new THREE.BufferAttribute(h,3));var l=new Float32Array(9*n.length);if(this.addAttribute("normal",new THREE.BufferAttribute(l,3)),o!==THREE.NoColors){var c=new Float32Array(9*n.length);this.addAttribute("color",new THREE.BufferAttribute(c,3))}if(!0===a){var u=new Float32Array(6*n.length);this.addAttribute("uv",new THREE.BufferAttribute(u,2))}for(var d=0,p=0,f=0;d<n.length;d++,p+=6,f+=9){var m=n[d],g=i[m.a],E=i[m.b],v=i[m.c];h[f]=g.x,h[f+1]=g.y,h[f+2]=g.z,h[f+3]=E.x,h[f+4]=E.y,h[f+5]=E.z,h[f+6]=v.x,h[f+7]=v.y,h[f+8]=v.z,!0===s?(g=m.vertexNormals[0],E=m.vertexNormals[1],v=m.vertexNormals[2],l[f]=g.x,l[f+1]=g.y,l[f+2]=g.z,l[f+3]=E.x,l[f+4]=E.y,l[f+5]=E.z,l[f+6]=v.x,l[f+7]=v.y,l[f+8]=v.z):(g=m.normal,l[f]=g.x,l[f+1]=g.y,l[f+2]=g.z,l[f+3]=g.x,l[f+4]=g.y,l[f+5]=g.z,l[f+6]=g.x,l[f+7]=g.y,l[f+8]=g.z),o===THREE.FaceColors?(m=m.color,c[f]=m.r,c[f+1]=m.g,c[f+2]=m.b,c[f+3]=m.r,c[f+4]=m.g,c[f+5]=m.b,c[f+6]=m.r,c[f+7]=m.g,c[f+8]=m.b):o===THREE.VertexColors&&(g=m.vertexColors[0],E=m.vertexColors[1],m=m.vertexColors[2],c[f]=g.r,c[f+1]=g.g,c[f+2]=g.b,c[f+3]=E.r,c[f+4]=E.g,c[f+5]=E.b,c[f+6]=m.r,c[f+7]=m.g,c[f+8]=m.b),!0===a&&(m=r[0][d][0],g=r[0][d][1],E=r[0][d][2],u[p]=m.x,u[p+1]=m.y,u[p+2]=g.x,u[p+3]=g.y,u[p+4]=E.x,u[p+5]=E.y)}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var t=new THREE.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.attributes.position.array;if(e){var i=this.boundingBox;i.makeEmpty();for(var n=0,r=e.length;r>n;n+=3)t.set(e[n],e[n+1],e[n+2]),i.expandByPoint(t)}(void 0===e||0===e.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var t=new THREE.Box3,e=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var i=this.attributes.position.array;if(i){t.makeEmpty();for(var n=this.boundingSphere.center,r=0,o=i.length;o>r;r+=3)e.set(i[r],i[r+1],i[r+2]),t.expandByPoint(e);t.center(n);for(var a=0,r=0,o=i.length;o>r;r+=3)e.set(i[r],i[r+1],i[r+2]),a=Math.max(a,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.attributes;if(t.position){var e=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(e.length),3));else for(var i=t.normal.array,n=0,r=i.length;r>n;n++)i[n]=0;var o,a,s,i=t.normal.array,h=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3;if(t.index)for(var p=t.index.array,f=0<this.offsets.length?this.offsets:[{start:0,count:p.length,index:0}],m=0,g=f.length;g>m;++m){r=f[m].start,o=f[m].count;for(var E=f[m].index,n=r,r=r+o;r>n;n+=3)o=3*(E+p[n]),a=3*(E+p[n+1]),s=3*(E+p[n+2]),h.fromArray(e,o),l.fromArray(e,a),c.fromArray(e,s),u.subVectors(c,l),d.subVectors(h,l),u.cross(d),i[o]+=u.x,i[o+1]+=u.y,i[o+2]+=u.z,i[a]+=u.x,i[a+1]+=u.y,i[a+2]+=u.z,i[s]+=u.x,i[s+1]+=u.y,i[s+2]+=u.z}else for(n=0,r=e.length;r>n;n+=9)h.fromArray(e,n),l.fromArray(e,n+3),c.fromArray(e,n+6),u.subVectors(c,l),d.subVectors(h,l),u.cross(d),i[n]=u.x,i[n+1]=u.y,i[n+2]=u.z,i[n+3]=u.x,i[n+4]=u.y,i[n+5]=u.z,i[n+6]=u.x,i[n+7]=u.y,i[n+8]=u.z;
this.normalizeNormals(),t.normal.needsUpdate=!0}},computeTangents:function(){function t(t,e,i){M.fromArray(n,3*t),S.fromArray(n,3*e),C.fromArray(n,3*i),L.fromArray(o,2*t),A.fromArray(o,2*e),P.fromArray(o,2*i),u=S.x-M.x,d=C.x-M.x,p=S.y-M.y,f=C.y-M.y,m=S.z-M.z,g=C.z-M.z,E=A.x-L.x,v=P.x-L.x,y=A.y-L.y,_=P.y-L.y,T=1/(E*_-v*y),k.set((_*u-y*d)*T,(_*p-y*f)*T,(_*m-y*g)*T),D.set((E*d-v*u)*T,(E*f-v*p)*T,(E*g-v*m)*T),h[t].add(k),h[e].add(k),h[i].add(k),l[t].add(D),l[e].add(D),l[i].add(D)}function e(t){I.fromArray(r,3*t),j.copy(I),U=h[t],V.copy(U),V.sub(I.multiplyScalar(I.dot(U))).normalize(),z.crossVectors(j,U),F=z.dot(l[t]),N=0>F?-1:1,s[4*t]=V.x,s[4*t+1]=V.y,s[4*t+2]=V.z,s[4*t+3]=N}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var i=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,o=this.attributes.uv.array,a=n.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*a),4));for(var s=this.attributes.tangent.array,h=[],l=[],c=0;a>c;c++)h[c]=new THREE.Vector3,l[c]=new THREE.Vector3;var u,d,p,f,m,g,E,v,y,_,T,x,b,R,w,H,M=new THREE.Vector3,S=new THREE.Vector3,C=new THREE.Vector3,L=new THREE.Vector2,A=new THREE.Vector2,P=new THREE.Vector2,k=new THREE.Vector3,D=new THREE.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,i.length,0);var O=this.drawcalls,c=0;for(b=O.length;b>c;++c){x=O[c].start,R=O[c].count;var B=O[c].index,a=x;for(x+=R;x>a;a+=3)R=B+i[a],w=B+i[a+1],H=B+i[a+2],t(R,w,H)}var N,U,F,V=new THREE.Vector3,z=new THREE.Vector3,I=new THREE.Vector3,j=new THREE.Vector3,c=0;for(b=O.length;b>c;++c)for(x=O[c].start,R=O[c].count,B=O[c].index,a=x,x+=R;x>a;a+=3)R=B+i[a],w=B+i[a+1],H=B+i[a+2],e(R),e(w),e(H)}},computeOffsets:function(t){var e=t;void 0===t&&(e=65535),Date.now(),t=this.attributes.index.array;for(var i=this.attributes.position.array,n=t.length/3,r=new Uint16Array(t.length),o=0,a=0,s=[{start:0,count:0,index:0}],h=s[0],l=0,c=0,u=new Int32Array(6),d=new Int32Array(i.length),p=new Int32Array(i.length),f=0;f<i.length;f++)d[f]=-1,p[f]=-1;for(i=0;n>i;i++){for(var m=c=0;3>m;m++)f=t[3*i+m],-1==d[f]?(u[2*m]=f,u[2*m+1]=-1,c++):d[f]<h.index?(u[2*m]=f,u[2*m+1]=-1,l++):(u[2*m]=f,u[2*m+1]=d[f]);if(a+c>h.index+e)for(h={start:o,count:0,index:a},s.push(h),c=0;6>c;c+=2)m=u[c+1],m>-1&&m<h.index&&(u[c+1]=-1);for(c=0;6>c;c+=2)f=u[c],m=u[c+1],-1===m&&(m=a++),d[f]=m,p[m]=f,r[o++]=m-h.index,h.count++}return this.reorderBuffers(r,p,a),this.offsets=s},merge:function(t,e){if(!1!=t instanceof THREE.BufferGeometry){void 0===e&&(e=0);var i,n=this.attributes;for(i in n)if(void 0!==t.attributes[i])for(var r=n[i].array,o=t.attributes[i],a=o.array,s=0,o=o.itemSize*e;s<a.length;s++,o++)r[o]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,i,n=this.attributes.normal.array,r=0,o=n.length;o>r;r+=3)t=n[r],e=n[r+1],i=n[r+2],t=1/Math.sqrt(t*t+e*e+i*i),n[r]*=t,n[r+1]*=t,n[r+2]*=t},reorderBuffers:function(t,e,i){var n,r={};for(n in this.attributes)"index"!=n&&(r[n]=new this.attributes[n].array.constructor(this.attributes[n].itemSize*i));for(var o=0;i>o;o++){var a=e[o];for(n in this.attributes)if("index"!=n)for(var s=this.attributes[n].array,h=this.attributes[n].itemSize,l=r[n],c=0;h>c;c++)l[o*h+c]=s[a*h+c]}this.attributes.index.array=t;for(n in this.attributes)"index"!=n&&(this.attributes[n].array=r[n],this.attributes[n].numItems=this.attributes[n].itemSize*i)},toJSON:function(){var t,e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},i=this.attributes,n=this.offsets,r=this.boundingSphere;for(t in i){for(var o=i[t],a=[],s=o.array,h=0,l=s.length;l>h;h++)a[h]=s[h];e.data.attributes[t]={itemSize:o.itemSize,type:o.array.constructor.name,array:a}}return 0<n.length&&(e.data.offsets=JSON.parse(JSON.stringify(n))),null!==r&&(e.data.boundingSphere={center:r.center.toArray(),radius:r.radius}),e},clone:function(){var t,e=new THREE.BufferGeometry;for(t in this.attributes)e.addAttribute(t,this.attributes[t].clone());t=0;for(var i=this.offsets.length;i>t;t++){var n=this.offsets[t];e.offsets.push({start:n.start,index:n.index,count:n.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.dynamic=!0,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(t){for(var e=(new THREE.Matrix3).getNormalMatrix(t),i=0,n=this.vertices.length;n>i;i++)this.vertices[i].applyMatrix4(t);for(i=0,n=this.faces.length;n>i;i++){t=this.faces[i],t.normal.applyMatrix3(e).normalize();for(var r=0,o=t.vertexNormals.length;o>r;r++)t.vertexNormals[r].applyMatrix3(e).normalize()}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},fromBufferGeometry:function(t){for(var e=this,i=t.attributes,n=i.position.array,r=void 0!==i.index?i.index.array:void 0,o=void 0!==i.normal?i.normal.array:void 0,a=void 0!==i.color?i.color.array:void 0,s=void 0!==i.uv?i.uv.array:void 0,h=[],l=[],c=i=0;i<n.length;i+=3,c+=2)e.vertices.push(new THREE.Vector3(n[i],n[i+1],n[i+2])),void 0!==o&&h.push(new THREE.Vector3(o[i],o[i+1],o[i+2])),void 0!==a&&e.colors.push(new THREE.Color(a[i],a[i+1],a[i+2])),void 0!==s&&l.push(new THREE.Vector2(s[c],s[c+1]));if(c=function(t,i,n){var r=void 0!==o?[h[t].clone(),h[i].clone(),h[n].clone()]:[],c=void 0!==a?[e.colors[t].clone(),e.colors[i].clone(),e.colors[n].clone()]:[];e.faces.push(new THREE.Face3(t,i,n,r,c)),void 0!==s&&e.faceVertexUvs[0].push([l[t].clone(),l[i].clone(),l[n].clone()])},void 0!==r)for(i=0;i<r.length;i+=3)c(r[i],r[i+1],r[i+2]);else for(i=0;i<n.length/3;i+=3)c(i,i+1,i+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=new THREE.Vector3;return t.addVectors(this.boundingBox.min,this.boundingBox.max),t.multiplyScalar(-.5),this.applyMatrix((new THREE.Matrix4).makeTranslation(t.x,t.y,t.z)),this.computeBoundingBox(),t},computeFaceNormals:function(){for(var t=new THREE.Vector3,e=new THREE.Vector3,i=0,n=this.faces.length;n>i;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b];t.subVectors(this.vertices[r.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n;for(n=Array(this.vertices.length),e=0,i=this.vertices.length;i>e;e++)n[e]=new THREE.Vector3;if(t){var r,o,a,s=new THREE.Vector3,h=new THREE.Vector3;for(new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,t=0,e=this.faces.length;e>t;t++)i=this.faces[t],r=this.vertices[i.a],o=this.vertices[i.b],a=this.vertices[i.c],s.subVectors(a,o),h.subVectors(r,o),s.cross(h),n[i.a].add(s),n[i.b].add(s),n[i.c].add(s)}else for(t=0,e=this.faces.length;e>t;t++)i=this.faces[t],n[i.a].add(i.normal),n[i.b].add(i.normal),n[i.c].add(i.normal);for(e=0,i=this.vertices.length;i>e;e++)n[e].normalize();for(t=0,e=this.faces.length;e>t;t++)i=this.faces[t],i.vertexNormals[0]=n[i.a].clone(),i.vertexNormals[1]=n[i.b].clone(),i.vertexNormals[2]=n[i.c].clone()},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;n>i;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;e>t;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new THREE.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],r=this.morphNormals[t].faceNormals;var a,s,h=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;n>i;i++)a=new THREE.Vector3,s={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},r.push(a),h.push(s)}for(h=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,n=this.faces.length;n>i;i++)r=this.faces[i],a=h.faceNormals[i],s=h.vertexNormals[i],a.copy(r.normal),s.a.copy(r.vertexNormals[0]),s.b.copy(r.vertexNormals[1]),s.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;n>i;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){var t,e,i,n,r,o,a,s,h,l,c,u,d,p,f,m,g,E=[],v=[];i=new THREE.Vector3;var y=new THREE.Vector3,_=new THREE.Vector3,T=new THREE.Vector3,x=new THREE.Vector3;for(t=0,e=this.vertices.length;e>t;t++)E[t]=new THREE.Vector3,v[t]=new THREE.Vector3;for(t=0,e=this.faces.length;e>t;t++)r=this.faces[t],o=this.faceVertexUvs[0][t],n=r.a,g=r.b,r=r.c,a=this.vertices[n],s=this.vertices[g],h=this.vertices[r],l=o[0],c=o[1],u=o[2],o=s.x-a.x,d=h.x-a.x,p=s.y-a.y,f=h.y-a.y,s=s.z-a.z,a=h.z-a.z,h=c.x-l.x,m=u.x-l.x,c=c.y-l.y,l=u.y-l.y,u=1/(h*l-m*c),i.set((l*o-c*d)*u,(l*p-c*f)*u,(l*s-c*a)*u),y.set((h*d-m*o)*u,(h*f-m*p)*u,(h*a-m*s)*u),E[n].add(i),E[g].add(i),E[r].add(i),v[n].add(y),v[g].add(y),v[r].add(y);for(y=["a","b","c","d"],t=0,e=this.faces.length;e>t;t++)for(r=this.faces[t],i=0;i<Math.min(r.vertexNormals.length,3);i++)x.copy(r.vertexNormals[i]),n=r[y[i]],g=E[n],_.copy(g),_.sub(x.multiplyScalar(x.dot(g))).normalize(),T.crossVectors(r.vertexNormals[i],g),n=T.dot(v[n]),n=0>n?-1:1,r.vertexTangents[i]=new THREE.Vector4(_.x,_.y,_.z,n);this.hasTangents=!0},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;n>i;i++)i>0&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(!1==t instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);else{var n,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,h=t.faces,l=this.faceVertexUvs[0];t=t.faceVertexUvs[0],void 0===i&&(i=0),void 0!==e&&(n=(new THREE.Matrix3).getNormalMatrix(e));for(var c=0,u=a.length;u>c;c++){var d=a[c].clone();void 0!==e&&d.applyMatrix4(e),o.push(d)}for(c=0,u=h.length;u>c;c++){var p,a=h[c],f=a.vertexNormals,m=a.vertexColors,d=new THREE.Face3(a.a+r,a.b+r,a.c+r);for(d.normal.copy(a.normal),void 0!==n&&d.normal.applyMatrix3(n).normalize(),e=0,o=f.length;o>e;e++)p=f[e].clone(),void 0!==n&&p.applyMatrix3(n).normalize(),d.vertexNormals.push(p);for(d.color.copy(a.color),e=0,o=m.length;o>e;e++)p=m[e],d.vertexColors.push(p.clone());d.materialIndex=a.materialIndex+i,s.push(d)}for(c=0,u=t.length;u>c;c++)if(i=t[c],n=[],void 0!==i){for(e=0,o=i.length;o>e;e++)n.push(i[e].clone());l.push(n)}}},mergeMesh:function(t){!1==t instanceof THREE.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t):(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,n={},r=[],o=[],a=Math.pow(10,4);for(e=0,i=this.vertices.length;i>e;e++)t=this.vertices[e],t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a),void 0===n[t]?(n[t]=e,r.push(this.vertices[e]),o[e]=r.length-1):o[e]=o[n[t]];for(n=[],e=0,i=this.faces.length;i>e;e++)for(a=this.faces[e],a.a=o[a.a],a.b=o[a.b],a.c=o[a.c],a=[a.a,a.b,a.c],t=0;3>t;t++)if(a[t]==a[(t+1)%3]){n.push(e);break}for(e=n.length-1;e>=0;e--)for(a=n[e],this.faces.splice(a,1),o=0,i=this.faceVertexUvs.length;i>o;o++)this.faceVertexUvs[o].splice(a,1);return e=this.vertices.length-r.length,this.vertices=r,e},toJSON:function(){function t(t,e,i){return i?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]?l[e]:(l[e]=h.length/3,h.push(t.x,t.y,t.z),l[e])}function i(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=c.length,c.push(t.getHex()),u[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/2,d.push(t.x,t.y),p[e])}var r={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(r.name=this.name),void 0!==this.parameters){var o,a=this.parameters;for(o in a)void 0!==a[o]&&(r[o]=a[o]);return r}for(a=[],o=0;o<this.vertices.length;o++){var s=this.vertices[o];a.push(s.x,s.y,s.z)}var s=[],h=[],l={},c=[],u={},d=[],p={};for(o=0;o<this.faces.length;o++){var f=this.faces[o],m=void 0!==this.faceVertexUvs[0][o],g=0<f.normal.length(),E=0<f.vertexNormals.length,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=0<f.vertexColors.length,_=0,_=t(_,0,0),_=t(_,1,!1),_=t(_,2,!1),_=t(_,3,m),_=t(_,4,g),_=t(_,5,E),_=t(_,6,v),_=t(_,7,y);s.push(_),s.push(f.a,f.b,f.c),m&&(m=this.faceVertexUvs[0][o],s.push(n(m[0]),n(m[1]),n(m[2]))),g&&s.push(e(f.normal)),E&&(g=f.vertexNormals,s.push(e(g[0]),e(g[1]),e(g[2]))),v&&s.push(i(f.color)),y&&(f=f.vertexColors,s.push(i(f[0]),i(f[1]),i(f[2])))}return r.data={},r.data.vertices=a,r.data.normals=h,0<c.length&&(r.data.colors=c),0<d.length&&(r.data.uvs=[d]),r.data.faces=s,r},clone:function(){for(var t=new THREE.Geometry,e=this.vertices,i=0,n=e.length;n>i;i++)t.vertices.push(e[i].clone());for(e=this.faces,i=0,n=e.length;n>i;i++)t.faces.push(e[i].clone());for(i=0,n=this.faceVertexUvs.length;n>i;i++){e=this.faceVertexUvs[i],void 0===t.faceVertexUvs[i]&&(t.faceVertexUvs[i]=[]);for(var r=0,o=e.length;o>r;r++){for(var a=e[r],s=[],h=0,l=a.length;l>h;h++)s.push(a[h].clone());t.faceVertexUvs[i].push(s)}}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.Camera=function(){THREE.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.getWorldDirection=function(){var t=new THREE.Quaternion;return function(e){return e=e||new THREE.Vector3,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),THREE.Camera.prototype.clone=function(t){return void 0===t&&(t=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,t),t.matrixWorldInverse.copy(this.matrixWorldInverse),t.projectionMatrix.copy(this.projectionMatrix),t},THREE.CubeCamera=function(t,e,i){THREE.Object3D.call(this),this.type="CubeCamera";var n=new THREE.PerspectiveCamera(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new THREE.Vector3(1,0,0)),this.add(n);var r=new THREE.PerspectiveCamera(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new THREE.Vector3(-1,0,0)),this.add(r);var o=new THREE.PerspectiveCamera(90,1,t,e);o.up.set(0,0,1),o.lookAt(new THREE.Vector3(0,1,0)),this.add(o);var a=new THREE.PerspectiveCamera(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new THREE.Vector3(0,-1,0)),this.add(a);var s=new THREE.PerspectiveCamera(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new THREE.Vector3(0,0,1)),this.add(s);var h=new THREE.PerspectiveCamera(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new THREE.Vector3(0,0,-1)),this.add(h),this.renderTarget=new THREE.WebGLRenderTargetCube(i,i,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(t,e){var i=this.renderTarget,l=i.generateMipmaps;i.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,r,i),i.activeCubeFace=2,t.render(e,o,i),i.activeCubeFace=3,t.render(e,a,i),i.activeCubeFace=4,t.render(e,s,i),i.generateMipmaps=l,i.activeCubeFace=5,t.render(e,h,i)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor=THREE.CubeCamera,THREE.OrthographicCamera=function(t,e,i,n,r,o){THREE.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(i-t,i+t,n+e,n-e,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var t=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,t),t.zoom=this.zoom,t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t.projectionMatrix.copy(this.projectionMatrix),t},THREE.PerspectiveCamera=function(t,e,i,n){THREE.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*THREE.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,n,r,o){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=n,this.width=r,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(THREE.Math.degToRad(.5*t))*this.near,i=-t,n=e*i,e=Math.abs(e*t-n),i=Math.abs(t-i);this.projectionMatrix.makeFrustum(n+this.x*e/this.fullWidth,n+(this.x+this.width)*e/this.fullWidth,t-(this.y+this.height)*i/this.fullHeight,t-this.y*i/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var t=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,t),t.zoom=this.zoom,t.fov=this.fov,t.aspect=this.aspect,t.near=this.near,t.far=this.far,t.projectionMatrix.copy(this.projectionMatrix),t},THREE.Light=function(t){THREE.Object3D.call(this),this.type="Light",this.color=new THREE.Color(t)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.clone=function(t){return void 0===t&&(t=new THREE.Light),THREE.Object3D.prototype.clone.call(this,t),t.color.copy(this.color),t},THREE.AmbientLight=function(t){THREE.Light.call(this,t),this.type="AmbientLight"},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.AmbientLight.prototype.clone=function(){var t=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,t),t},THREE.AreaLight=function(t,e){THREE.Light.call(this,t),this.type="AreaLight",this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==e?e:1,this.height=this.width=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.AreaLight.prototype.constructor=THREE.AreaLight,THREE.DirectionalLight=function(t,e){THREE.Light.call(this,t),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraTop=this.shadowCameraRight=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.DirectionalLight.prototype.clone=function(){var t=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t.shadowCameraNear=this.shadowCameraNear,t.shadowCameraFar=this.shadowCameraFar,t.shadowCameraLeft=this.shadowCameraLeft,t.shadowCameraRight=this.shadowCameraRight,t.shadowCameraTop=this.shadowCameraTop,t.shadowCameraBottom=this.shadowCameraBottom,t.shadowCameraVisible=this.shadowCameraVisible,t.shadowBias=this.shadowBias,t.shadowDarkness=this.shadowDarkness,t.shadowMapWidth=this.shadowMapWidth,t.shadowMapHeight=this.shadowMapHeight,t.shadowCascade=this.shadowCascade,t.shadowCascadeOffset.copy(this.shadowCascadeOffset),t.shadowCascadeCount=this.shadowCascadeCount,t.shadowCascadeBias=this.shadowCascadeBias.slice(0),t.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),t.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),t.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),t.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),t},THREE.HemisphereLight=function(t,e,i){THREE.Light.call(this,t),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new THREE.Color(e),this.intensity=void 0!==i?i:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight,THREE.HemisphereLight.prototype.clone=function(){var t=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,t),t.groundColor.copy(this.groundColor),t.intensity=this.intensity,t},THREE.PointLight=function(t,e,i){THREE.Light.call(this,t),this.type="PointLight",this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.constructor=THREE.PointLight,THREE.PointLight.prototype.clone=function(){var t=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,t),t.intensity=this.intensity,t.distance=this.distance,t},THREE.SpotLight=function(t,e,i,n,r){THREE.Light.call(this,t),this.type="SpotLight",this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==e?e:1,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.exponent=void 0!==r?r:10,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.constructor=THREE.SpotLight,THREE.SpotLight.prototype.clone=function(){var t=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,t),t.target=this.target.clone(),t.intensity=this.intensity,t.distance=this.distance,t.angle=this.angle,t.exponent=this.exponent,t.castShadow=this.castShadow,t.onlyShadow=this.onlyShadow,t.shadowCameraNear=this.shadowCameraNear,t.shadowCameraFar=this.shadowCameraFar,t.shadowCameraFov=this.shadowCameraFov,t.shadowCameraVisible=this.shadowCameraVisible,t.shadowBias=this.shadowBias,t.shadowDarkness=this.shadowDarkness,t.shadowMapWidth=this.shadowMapWidth,t.shadowMapHeight=this.shadowMapHeight,t},THREE.Cache=function(){this.files={}},THREE.Cache.prototype={constructor:THREE.Cache,add:function(t,e){this.files[t]=e},get:function(t){return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},THREE.Loader=function(t){this.statusDomElement=(this.showStatus=t)?THREE.Loader.prototype.addStatusElement():null,this.imageLoader=new THREE.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.fontSize="0.8em",t.style.textAlign="left",t.style.background="rgba(0,0,0,0.25)",t.style.color="#fff",t.style.width="120px",t.style.padding="0.5em 0.5em 0.5em 0.5em",t.style.zIndex=1e3,t.innerHTML="Loading ...",t},updateProgress:function(t){var e="Loaded ",e=t.total?e+((100*t.loaded/t.total).toFixed(0)+"%"):e+((t.loaded/1024).toFixed(2)+" KB");this.statusDomElement.innerHTML=e},extractUrlBase:function(t){return t=t.split("/"),1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(t,e){for(var i=[],n=0;n<t.length;++n)i[n]=this.createMaterial(t[n],e);return i},needsTangents:function(t){for(var e=0,i=t.length;i>e;e++)if(t[e]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(t,e){function i(t){return t=Math.log(t)/Math.LN2,Math.pow(2,Math.round(t))}function n(t,n,r,a,s,h,l){var c,u=e+r,d=THREE.Loader.Handlers.get(u);null!==d?c=d.load(u):(c=new THREE.Texture,d=o.imageLoader,d.crossOrigin=o.crossOrigin,d.load(u,function(t){if(!1===THREE.Math.isPowerOfTwo(t.width)||!1===THREE.Math.isPowerOfTwo(t.height)){var e=i(t.width),n=i(t.height),r=document.createElement("canvas");r.width=e,r.height=n,r.getContext("2d").drawImage(t,0,0,e,n),c.image=r}else c.image=t;c.needsUpdate=!0})),c.sourceFile=r,a&&(c.repeat.set(a[0],a[1]),1!==a[0]&&(c.wrapS=THREE.RepeatWrapping),1!==a[1]&&(c.wrapT=THREE.RepeatWrapping)),s&&c.offset.set(s[0],s[1]),h&&(r={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==r[h[0]]&&(c.wrapS=r[h[0]]),void 0!==r[h[1]]&&(c.wrapT=r[h[1]])),l&&(c.anisotropy=l),t[n]=c}function r(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var o=this,a="MeshLambertMaterial",s={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var h=t.shading.toLowerCase();"phong"===h?a="MeshPhongMaterial":"basic"===h&&(a="MeshBasicMaterial")}return void 0!==t.blending&&void 0!==THREE[t.blending]&&(s.blending=THREE[t.blending]),(void 0!==t.transparent||1>t.opacity)&&(s.transparent=t.transparent),void 0!==t.depthTest&&(s.depthTest=t.depthTest),void 0!==t.depthWrite&&(s.depthWrite=t.depthWrite),void 0!==t.visible&&(s.visible=t.visible),void 0!==t.flipSided&&(s.side=THREE.BackSide),void 0!==t.doubleSided&&(s.side=THREE.DoubleSide),void 0!==t.wireframe&&(s.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?s.vertexColors=THREE.FaceColors:t.vertexColors&&(s.vertexColors=THREE.VertexColors)),t.colorDiffuse?s.color=r(t.colorDiffuse):t.DbgColor&&(s.color=t.DbgColor),t.colorSpecular&&(s.specular=r(t.colorSpecular)),t.colorAmbient&&(s.ambient=r(t.colorAmbient)),t.colorEmissive&&(s.emissive=r(t.colorEmissive)),t.transparency&&(s.opacity=t.transparency),t.specularCoef&&(s.shininess=t.specularCoef),t.mapDiffuse&&e&&n(s,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e&&n(s,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapBump&&e&&n(s,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e&&n(s,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e&&n(s,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapAlpha&&e&&n(s,"alphaMap",t.mapAlpha,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy),t.mapBumpScale&&(s.bumpScale=t.mapBumpScale),t.mapNormalFactor&&(s.normalScale=new THREE.Vector2(t.mapNormalFactor,t.mapNormalFactor)),a=new THREE[a](s),void 0!==t.DbgName&&(a.name=t.DbgName),a}},THREE.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=0,i=this.handlers.length;i>e;e+=2){var n=this.handlers[e+1];if(this.handlers[e].test(t))return n}return null}},THREE.XHRLoader=function(t){this.cache=new THREE.Cache,this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(t,e,i,n){var r=this,o=r.cache.get(t);void 0!==o?e&&e(o):(o=new XMLHttpRequest,o.open("GET",t,!0),o.addEventListener("load",function(){r.cache.add(t,this.response),e&&e(this.response),r.manager.itemEnd(t)},!1),void 0!==i&&o.addEventListener("progress",function(t){i(t)},!1),void 0!==n&&o.addEventListener("error",function(t){n(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(o.responseType=this.responseType),o.send(null),r.manager.itemStart(t))},setResponseType:function(t){this.responseType=t},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.ImageLoader=function(t){this.cache=new THREE.Cache,this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(t,e,i,n){var r=this,o=r.cache.get(t);return void 0===o?(o=document.createElement("img"),void 0!==e&&o.addEventListener("load",function(){r.cache.add(t,this),e(this),r.manager.itemEnd(t)},!1),void 0!==i&&o.addEventListener("progress",function(t){i(t)},!1),void 0!==n&&o.addEventListener("error",function(t){n(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=t,r.manager.itemStart(t),o):void e(o)},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.JSONLoader=function(t){THREE.Loader.call(this,t),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.constructor=THREE.JSONLoader,THREE.JSONLoader.prototype.load=function(t,e,i){i=i&&"string"==typeof i?i:this.extractUrlBase(t),this.onLoadStart(),this.loadAjaxJSON(this,t,e,i)},THREE.JSONLoader.prototype.loadAjaxJSON=function(t,e,i,n,r){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText);if(void 0!==s.metadata&&"scene"===s.metadata.type)return void console.error('THREE.JSONLoader: "'+e+'" seems to be a Scene. Use THREE.SceneLoader instead.');s=t.parse(s,n),i(s.geometry,s.materials)}else console.error('THREE.JSONLoader: "'+e+'" seems to be unreachable or the file is empty.');t.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load \""+e+'" ('+o.status+")");else o.readyState===o.LOADING?r&&(0===a&&(a=o.getResponseHeader("Content-Length")),r({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==r&&(a=o.getResponseHeader("Content-Length"))
},o.open("GET",e,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(t,e){var i=new THREE.Geometry,n=void 0!==t.scale?1/t.scale:1;return function(e){var n,r,o,a,s,h,l,c,u,d,p,f,m,g=t.faces;h=t.vertices;var E=t.normals,v=t.colors,y=0;if(void 0!==t.uvs){for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&y++;for(n=0;y>n;n++)i.faceVertexUvs[n]=[]}for(a=0,s=h.length;s>a;)n=new THREE.Vector3,n.x=h[a++]*e,n.y=h[a++]*e,n.z=h[a++]*e,i.vertices.push(n);for(a=0,s=g.length;s>a;)if(e=g[a++],u=1&e,o=2&e,n=8&e,l=16&e,d=32&e,h=64&e,e&=128,u){if(u=new THREE.Face3,u.a=g[a],u.b=g[a+1],u.c=g[a+3],p=new THREE.Face3,p.a=g[a+1],p.b=g[a+2],p.c=g[a+3],a+=4,o&&(o=g[a++],u.materialIndex=o,p.materialIndex=o),o=i.faces.length,n)for(n=0;y>n;n++)for(f=t.uvs[n],i.faceVertexUvs[n][o]=[],i.faceVertexUvs[n][o+1]=[],r=0;4>r;r++)c=g[a++],m=f[2*c],c=f[2*c+1],m=new THREE.Vector2(m,c),2!==r&&i.faceVertexUvs[n][o].push(m),0!==r&&i.faceVertexUvs[n][o+1].push(m);if(l&&(l=3*g[a++],u.normal.set(E[l++],E[l++],E[l]),p.normal.copy(u.normal)),d)for(n=0;4>n;n++)l=3*g[a++],d=new THREE.Vector3(E[l++],E[l++],E[l]),2!==n&&u.vertexNormals.push(d),0!==n&&p.vertexNormals.push(d);if(h&&(h=g[a++],h=v[h],u.color.setHex(h),p.color.setHex(h)),e)for(n=0;4>n;n++)h=g[a++],h=v[h],2!==n&&u.vertexColors.push(new THREE.Color(h)),0!==n&&p.vertexColors.push(new THREE.Color(h));i.faces.push(u),i.faces.push(p)}else{if(u=new THREE.Face3,u.a=g[a++],u.b=g[a++],u.c=g[a++],o&&(o=g[a++],u.materialIndex=o),o=i.faces.length,n)for(n=0;y>n;n++)for(f=t.uvs[n],i.faceVertexUvs[n][o]=[],r=0;3>r;r++)c=g[a++],m=f[2*c],c=f[2*c+1],m=new THREE.Vector2(m,c),i.faceVertexUvs[n][o].push(m);if(l&&(l=3*g[a++],u.normal.set(E[l++],E[l++],E[l])),d)for(n=0;3>n;n++)l=3*g[a++],d=new THREE.Vector3(E[l++],E[l++],E[l]),u.vertexNormals.push(d);if(h&&(h=g[a++],u.color.setHex(v[h])),e)for(n=0;3>n;n++)h=g[a++],u.vertexColors.push(new THREE.Color(v[h]));i.faces.push(u)}}(n),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,r=t.skinWeights.length;r>n;n+=e)i.skinWeights.push(new THREE.Vector4(t.skinWeights[n],e>1?t.skinWeights[n+1]:0,e>2?t.skinWeights[n+2]:0,e>3?t.skinWeights[n+3]:0));if(t.skinIndices)for(n=0,r=t.skinIndices.length;r>n;n+=e)i.skinIndices.push(new THREE.Vector4(t.skinIndices[n],e>1?t.skinIndices[n+1]:0,e>2?t.skinIndices[n+2]:0,e>3?t.skinIndices[n+3]:0));i.bones=t.bones,i.bones&&0<i.bones.length&&(i.skinWeights.length!==i.skinIndices.length||i.skinIndices.length!==i.vertices.length)&&console.warn("When skinning, number of vertices ("+i.vertices.length+"), skinIndices ("+i.skinIndices.length+"), and skinWeights ("+i.skinWeights.length+") should match."),i.animation=t.animation,i.animations=t.animations}(),function(e){if(void 0!==t.morphTargets){var n,r,o,a,s,h;for(n=0,r=t.morphTargets.length;r>n;n++)for(i.morphTargets[n]={},i.morphTargets[n].name=t.morphTargets[n].name,i.morphTargets[n].vertices=[],s=i.morphTargets[n].vertices,h=t.morphTargets[n].vertices,o=0,a=h.length;a>o;o+=3){var l=new THREE.Vector3;l.x=h[o]*e,l.y=h[o+1]*e,l.z=h[o+2]*e,s.push(l)}}if(void 0!==t.morphColors)for(n=0,r=t.morphColors.length;r>n;n++)for(i.morphColors[n]={},i.morphColors[n].name=t.morphColors[n].name,i.morphColors[n].colors=[],a=i.morphColors[n].colors,s=t.morphColors[n].colors,e=0,o=s.length;o>e;e+=3)h=new THREE.Color(16755200),h.setRGB(s[e],s[e+1],s[e+2]),a.push(h)}(n),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:i}:(n=this.initMaterials(t.materials,e),this.needsTangents(n)&&i.computeTangents(),{geometry:i,materials:n})},THREE.LoadingManager=function(t,e,i){var n=this,r=0,o=0;this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(){o++},this.itemEnd=function(t){r++,void 0!==n.onProgress&&n.onProgress(t,r,o),r===o&&void 0!==n.onLoad&&n.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(t,e,i,n){var r=this,o=new THREE.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e,i=new THREE.BufferGeometry,n=t.attributes;for(e in n){var r=n[e],o=new self[r.type](r.array);i.addAttribute(e,new THREE.BufferAttribute(o,r.itemSize))}return n=t.offsets,void 0!==n&&(i.offsets=JSON.parse(JSON.stringify(n))),t=t.boundingSphere,void 0!==t&&(n=new THREE.Vector3,void 0!==t.center&&n.fromArray(t.center),i.boundingSphere=new THREE.Sphere(n,t.radius)),i}},THREE.MaterialLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(t,e,i,n){var r=this,o=new THREE.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new THREE[t.type];if(void 0!==t.color&&e.color.setHex(t.color),void 0!==t.ambient&&e.ambient.setHex(t.ambient),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.materials)for(var i=0,n=t.materials.length;n>i;i++)e.materials.push(this.parse(t.materials[i]));return e}},THREE.ObjectLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(t,e,i,n){var r=this,o=new THREE.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=this.parseGeometries(t.geometries),i=this.parseMaterials(t.materials);return this.parseObject(t.object,e,i)},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new THREE.JSONLoader,n=new THREE.BufferGeometryLoader,r=0,o=t.length;o>r;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":a=new THREE.PlaneGeometry(s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new THREE.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":a=new THREE.CircleGeometry(s.radius,s.segments);break;case"CylinderGeometry":a=new THREE.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded);break;case"SphereGeometry":a=new THREE.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"TorusGeometry":a=new THREE.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new THREE.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=n.parse(s.data);break;case"Geometry":a=i.parse(s.data).geometry}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t){var e={};if(void 0!==t)for(var i=new THREE.MaterialLoader,n=0,r=t.length;r>n;n++){var o=t[n],a=i.parse(o);a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),e[o.uuid]=a}return e},parseObject:function(){var t=new THREE.Matrix4;return function(e,i,n){var r;switch(e.type){case"Scene":r=new THREE.Scene;break;case"PerspectiveCamera":r=new THREE.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":r=new THREE.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":r=new THREE.AmbientLight(e.color);break;case"DirectionalLight":r=new THREE.DirectionalLight(e.color,e.intensity);break;case"PointLight":r=new THREE.PointLight(e.color,e.intensity,e.distance);break;case"SpotLight":r=new THREE.SpotLight(e.color,e.intensity,e.distance,e.angle,e.exponent);break;case"HemisphereLight":r=new THREE.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":r=i[e.geometry];var o=n[e.material];void 0===r&&console.warn("THREE.ObjectLoader: Undefined geometry",e.geometry),void 0===o&&console.warn("THREE.ObjectLoader: Undefined material",e.material),r=new THREE.Mesh(r,o);break;case"Line":r=i[e.geometry],o=n[e.material],void 0===r&&console.warn("THREE.ObjectLoader: Undefined geometry",e.geometry),void 0===o&&console.warn("THREE.ObjectLoader: Undefined material",e.material),r=new THREE.Line(r,o);break;case"Sprite":o=n[e.material],void 0===o&&console.warn("THREE.ObjectLoader: Undefined material",e.material),r=new THREE.Sprite(o);break;case"Group":r=new THREE.Group;break;default:r=new THREE.Object3D}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.children)for(var a in e.children)r.add(this.parseObject(e.children[a],i,n));return r}}()},THREE.TextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(t,e,i,n){var r=new THREE.ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin),r.load(t,function(t){t=new THREE.Texture(t),t.needsUpdate=!0,void 0!==e&&e(t)},i,n)},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(){this._parser=null},THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(t,e,i,n){var r=this,o=new THREE.DataTexture,a=new THREE.XHRLoader;return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=r._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:THREE.ClampToEdgeWrapping,o.wrapT=void 0!==t.wrapT?t.wrapT:THREE.ClampToEdgeWrapping,o.magFilter=void 0!==t.magFilter?t.magFilter:THREE.LinearFilter,o.minFilter=void 0!==t.minFilter?t.minFilter:THREE.LinearMipMapLinearFilter,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.needsUpdate=!0,e&&e(o,t))},i,n),o}},THREE.CompressedTextureLoader=function(){this._parser=null},THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(t,e,i){var n=this,r=[],o=new THREE.CompressedTexture;o.image=r;var a=new THREE.XHRLoader;if(a.setResponseType("arraybuffer"),t instanceof Array){var s=0;i=function(i){a.load(t[i],function(t){t=n._parser(t,!0),r[i]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},s+=1,6===s&&(1==t.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.format=t.format,o.needsUpdate=!0,e&&e(o))})};for(var h=0,l=t.length;l>h;++h)i(h)}else a.load(t,function(t){if(t=n._parser(t,!0),t.isCubemap)for(var i=t.mipmaps.length/t.mipmapCount,a=0;i>a;a++){r[a]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++)r[a].mipmaps.push(t.mipmaps[a*t.mipmapCount+s]),r[a].format=t.format,r[a].width=t.width,r[a].height=t.height}else o.image.width=t.width,o.image.height=t.height,o.mipmaps=t.mipmaps;1===t.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.format=t.format,o.needsUpdate=!0,e&&e(o)});return o}},THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.type="Material",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthWrite=this.depthTest=!0,this.polygonOffset=!1,this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.needsUpdate=this.visible=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0===i)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if(e in this){var n=this[e];n instanceof THREE.Color?n.set(i):n instanceof THREE.Vector3&&i instanceof THREE.Vector3?n.copy(i):this[e]="overdraw"==e?Number(i):i}}},toJSON:function(){var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(t.name=this.name),this instanceof THREE.MeshBasicMaterial?(t.color=this.color.getHex(),this.vertexColors!==THREE.NoColors&&(t.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(t.blending=this.blending),this.side!==THREE.FrontSide&&(t.side=this.side)):this instanceof THREE.MeshLambertMaterial?(t.color=this.color.getHex(),t.ambient=this.ambient.getHex(),t.emissive=this.emissive.getHex(),this.vertexColors!==THREE.NoColors&&(t.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(t.blending=this.blending),this.side!==THREE.FrontSide&&(t.side=this.side)):this instanceof THREE.MeshPhongMaterial?(t.color=this.color.getHex(),t.ambient=this.ambient.getHex(),t.emissive=this.emissive.getHex(),t.specular=this.specular.getHex(),t.shininess=this.shininess,this.vertexColors!==THREE.NoColors&&(t.vertexColors=this.vertexColors),this.blending!==THREE.NormalBlending&&(t.blending=this.blending),this.side!==THREE.FrontSide&&(t.side=this.side)):this instanceof THREE.MeshNormalMaterial?(this.shading!==THREE.FlatShading&&(t.shading=this.shading),this.blending!==THREE.NormalBlending&&(t.blending=this.blending),this.side!==THREE.FrontSide&&(t.side=this.side)):this instanceof THREE.MeshDepthMaterial?(this.blending!==THREE.NormalBlending&&(t.blending=this.blending),this.side!==THREE.FrontSide&&(t.side=this.side)):this instanceof THREE.ShaderMaterial?(t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader):this instanceof THREE.SpriteMaterial&&(t.color=this.color.getHex()),1>this.opacity&&(t.opacity=this.opacity),!1!==this.transparent&&(t.transparent=this.transparent),!1!==this.wireframe&&(t.wireframe=this.wireframe),t},clone:function(t){return void 0===t&&(t=new THREE.Material),t.name=this.name,t.side=this.side,t.opacity=this.opacity,t.transparent=this.transparent,t.blending=this.blending,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.polygonOffset=this.polygonOffset,t.polygonOffsetFactor=this.polygonOffsetFactor,t.polygonOffsetUnits=this.polygonOffsetUnits,t.alphaTest=this.alphaTest,t.overdraw=this.overdraw,t.visible=this.visible,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.type="LineBasicMaterial",this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.clone=function(){var t=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.linecap=this.linecap,t.linejoin=this.linejoin,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.LineDashedMaterial=function(t){THREE.Material.call(this),this.type="LineDashedMaterial",this.color=new THREE.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.clone=function(){var t=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.scale=this.scale,t.dashSize=this.dashSize,t.gapSize=this.gapSize,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.type="MeshBasicMaterial",this.color=new THREE.Color(16777215),this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.clone=function(){var t=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.type="MeshLambertMaterial",this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.envMap=this.alphaMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshLambertMaterial.prototype.clone=function(){var t=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.type="MeshPhongMaterial",this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.wrapAround=this.metal=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.bumpMap=this.lightMap=this.map=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.envMap=this.alphaMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.clone=function(){var t=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.specular.copy(this.specular),t.shininess=this.shininess,t.metal=this.metal,t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.bumpMap=this.bumpMap,t.bumpScale=this.bumpScale,t.normalMap=this.normalMap,t.normalScale.copy(this.normalScale),t.specularMap=this.specularMap,t.alphaMap=this.alphaMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshDepthMaterial=function(t){THREE.Material.call(this),this.type="MeshDepthMaterial",this.wireframe=this.morphTargets=!1,this.wireframeLinewidth=1,this.setValues(t)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.clone=function(){var t=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,t),t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.type="MeshNormalMaterial",this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.clone=function(){var t=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,t),t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshFaceMaterial=function(t){this.uuid=THREE.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=t instanceof Array?t:[]},THREE.MeshFaceMaterial.prototype={constructor:THREE.MeshFaceMaterial,toJSON:function(){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},e=0,i=this.materials.length;i>e;e++)t.materials.push(this.materials[e].toJSON());return t},clone:function(){for(var t=new THREE.MeshFaceMaterial,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t}},THREE.PointCloudMaterial=function(t){THREE.Material.call(this),this.type="PointCloudMaterial",this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(t)},THREE.PointCloudMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointCloudMaterial.prototype.constructor=THREE.PointCloudMaterial,THREE.PointCloudMaterial.prototype.clone=function(){var t=new THREE.PointCloudMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.size=this.size,t.sizeAttenuation=this.sizeAttenuation,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(t)},THREE.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(t)},THREE.ShaderMaterial=function(t){THREE.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(t)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.clone=function(){var t=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,t),t.fragmentShader=this.fragmentShader,t.vertexShader=this.vertexShader,t.uniforms=THREE.UniformsUtils.clone(this.uniforms),t.attributes=this.attributes,t.defines=this.defines,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.fog=this.fog,t.lights=this.lights,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.RawShaderMaterial=function(t){THREE.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial,THREE.RawShaderMaterial.prototype.clone=function(){var t=new THREE.RawShaderMaterial;return THREE.ShaderMaterial.prototype.clone.call(this,t),t},THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.type="SpriteMaterial",this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.clone=function(){var t=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.rotation=this.rotation,t.fog=this.fog,t},THREE.Texture=function(t,e,i,n,r,o,a,s,h){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++}),this.uuid=THREE.Math.generateUUID(),this.name="",this.image=void 0!==t?t:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==h?h:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},clone:function(t){return void 0===t&&(t=new THREE.Texture),t.image=this.image,t.mipmaps=this.mipmaps.slice(0),t.mapping=this.mapping,t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.format=this.format,t.type=this.type,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.generateMipmaps=this.generateMipmaps,t.premultiplyAlpha=this.premultiplyAlpha,t.flipY=this.flipY,t.unpackAlignment=this.unpackAlignment,t},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CubeTexture=function(t,e,i,n,r,o,a,s,h){e=void 0!==e?e:THREE.CubeReflectionMapping,THREE.Texture.call(this,t,e,i,n,r,o,a,s,h),this.images=t},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor=THREE.CubeTexture,THREE.CubeTexture.clone=function(t){return void 0===t&&(t=new THREE.CubeTexture),THREE.Texture.prototype.clone.call(this,t),t.images=this.images,t},THREE.CompressedTexture=function(t,e,i,n,r,o,a,s,h,l,c){THREE.Texture.call(this,null,o,a,s,h,l,n,r,c),this.image={width:e,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture,THREE.CompressedTexture.prototype.clone=function(){var t=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.DataTexture=function(t,e,i,n,r,o,a,s,h,l,c){THREE.Texture.call(this,null,o,a,s,h,l,n,r,c),this.image={data:t,width:e,height:i}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.DataTexture.prototype.clone=function(){var t=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.VideoTexture=function(t,e,i,n,r,o,a,s,h){THREE.Texture.call(this,t,e,i,n,r,o,a,s,h),this.generateMipmaps=!1;var l=this,c=function(){requestAnimationFrame(c),t.readyState===t.HAVE_ENOUGH_DATA&&(l.needsUpdate=!0)};c()},THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor=THREE.VideoTexture,THREE.Group=function(){THREE.Object3D.call(this),this.type="Group"},THREE.Group.prototype=Object.create(THREE.Object3D.prototype),THREE.Group.prototype.constructor=THREE.Group,THREE.PointCloud=function(t,e){THREE.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.PointCloudMaterial({color:16777215*Math.random()})},THREE.PointCloud.prototype=Object.create(THREE.Object3D.prototype),THREE.PointCloud.prototype.constructor=THREE.PointCloud,THREE.PointCloud.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray;return function(i,n){var r=this,o=r.geometry,a=i.params.PointCloud.threshold;if(t.getInverse(this.matrixWorld),e.copy(i.ray).applyMatrix4(t),null===o.boundingBox||!1!==e.isIntersectionBox(o.boundingBox)){var s=a/((this.scale.x+this.scale.y+this.scale.z)/3),h=new THREE.Vector3,a=function(t,o){var a=e.distanceToPoint(t);if(s>a){var h=e.closestPointToPoint(t);h.applyMatrix4(r.matrixWorld);var l=i.ray.origin.distanceTo(h);n.push({distance:l,distanceToRay:a,point:h.clone(),index:o,face:null,object:r})}};if(o instanceof THREE.BufferGeometry){var l=o.attributes,c=l.position.array;if(void 0!==l.index){var l=l.index.array,u=o.offsets;0===u.length&&(u=[{start:0,count:l.length,index:0}]);for(var d=0,p=u.length;p>d;++d)for(var f=u[d].start,m=u[d].index,o=f,f=f+u[d].count;f>o;o++){var g=m+l[o];h.fromArray(c,3*g),a(h,g)}}else for(l=c.length/3,o=0;l>o;o++)h.set(c[3*o],c[3*o+1],c[3*o+2]),a(h,o)}else for(h=this.geometry.vertices,o=0;o<h.length;o++)a(h[o],o)}}}(),THREE.PointCloud.prototype.clone=function(t){return void 0===t&&(t=new THREE.PointCloud(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new THREE.PointCloud(t,e)
},THREE.Line=function(t,e,i){THREE.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==i?i:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.constructor=THREE.Line,THREE.Line.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray,i=new THREE.Sphere;return function(n,r){var o=n.linePrecision,o=o*o,a=this.geometry;if(null===a.boundingSphere&&a.computeBoundingSphere(),i.copy(a.boundingSphere),i.applyMatrix4(this.matrixWorld),!1!==n.ray.isIntersectionSphere(i)){t.getInverse(this.matrixWorld),e.copy(n.ray).applyMatrix4(t);var s=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3,u=this.mode===THREE.LineStrip?1:2;if(a instanceof THREE.BufferGeometry){var d=a.attributes;if(void 0!==d.index){var p=d.index.array,d=d.position.array,f=a.offsets;0===f.length&&(f=[{start:0,count:p.length,index:0}]);for(var m=0;m<f.length;m++)for(var g=f[m].start,E=f[m].count,v=f[m].index,a=g;g+E-1>a;a+=u){var y=v+p[a+1];s.fromArray(d,3*(v+p[a])),h.fromArray(d,3*y),y=e.distanceSqToSegment(s,h,c,l),y>o||(y=e.origin.distanceTo(c),y<n.near||y>n.far||r.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this}))}}else for(d=d.position.array,a=0;a<d.length/3-1;a+=u)s.fromArray(d,3*a),h.fromArray(d,3*a+3),y=e.distanceSqToSegment(s,h,c,l),y>o||(y=e.origin.distanceTo(c),y<n.near||y>n.far||r.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this}))}else if(a instanceof THREE.Geometry)for(s=a.vertices,h=s.length,a=0;h-1>a;a+=u)y=e.distanceSqToSegment(s[a],s[a+1],c,l),y>o||(y=e.origin.distanceTo(c),y<n.near||y>n.far||r.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this}))}}}(),THREE.Line.prototype.clone=function(t){return void 0===t&&(t=new THREE.Line(this.geometry,this.material,this.mode)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.raycast=function(){var t=new THREE.Matrix4,e=new THREE.Ray,i=new THREE.Sphere,n=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3;return function(a,s){var h=this.geometry;if(null===h.boundingSphere&&h.computeBoundingSphere(),i.copy(h.boundingSphere),i.applyMatrix4(this.matrixWorld),!1!==a.ray.isIntersectionSphere(i)&&(t.getInverse(this.matrixWorld),e.copy(a.ray).applyMatrix4(t),null===h.boundingBox||!1!==e.isIntersectionBox(h.boundingBox)))if(h instanceof THREE.BufferGeometry){var l=this.material;if(void 0!==l){var c,u,d=h.attributes,p=a.precision;if(void 0!==d.index){var f=d.index.array,m=d.position.array,g=h.offsets;0===g.length&&(g=[{start:0,count:f.length,index:0}]);for(var E=0,v=g.length;v>E;++E)for(var d=g[E].start,y=g[E].index,h=d,_=d+g[E].count;_>h;h+=3){d=y+f[h],c=y+f[h+1],u=y+f[h+2],n.fromArray(m,3*d),r.fromArray(m,3*c),o.fromArray(m,3*u);var T=l.side===THREE.BackSide?e.intersectTriangle(o,r,n,!0):e.intersectTriangle(n,r,o,l.side!==THREE.DoubleSide);if(null!==T){T.applyMatrix4(this.matrixWorld);var x=a.ray.origin.distanceTo(T);p>x||x<a.near||x>a.far||s.push({distance:x,point:T,face:new THREE.Face3(d,c,u,THREE.Triangle.normal(n,r,o)),faceIndex:null,object:this})}}}else for(m=d.position.array,f=h=0,_=m.length;_>h;h+=3,f+=9)d=h,c=h+1,u=h+2,n.fromArray(m,f),r.fromArray(m,f+3),o.fromArray(m,f+6),T=l.side===THREE.BackSide?e.intersectTriangle(o,r,n,!0):e.intersectTriangle(n,r,o,l.side!==THREE.DoubleSide),null!==T&&(T.applyMatrix4(this.matrixWorld),x=a.ray.origin.distanceTo(T),p>x||x<a.near||x>a.far||s.push({distance:x,point:T,face:new THREE.Face3(d,c,u,THREE.Triangle.normal(n,r,o)),faceIndex:null,object:this}))}}else if(h instanceof THREE.Geometry)for(f=this.material instanceof THREE.MeshFaceMaterial,m=!0===f?this.material.materials:null,p=a.precision,g=h.vertices,E=0,v=h.faces.length;v>E;E++)if(y=h.faces[E],l=!0===f?m[y.materialIndex]:this.material,void 0!==l){if(d=g[y.a],c=g[y.b],u=g[y.c],!0===l.morphTargets){T=h.morphTargets,x=this.morphTargetInfluences,n.set(0,0,0),r.set(0,0,0),o.set(0,0,0);for(var _=0,b=T.length;b>_;_++){var R=x[_];if(0!==R){var w=T[_].vertices;n.x+=(w[y.a].x-d.x)*R,n.y+=(w[y.a].y-d.y)*R,n.z+=(w[y.a].z-d.z)*R,r.x+=(w[y.b].x-c.x)*R,r.y+=(w[y.b].y-c.y)*R,r.z+=(w[y.b].z-c.z)*R,o.x+=(w[y.c].x-u.x)*R,o.y+=(w[y.c].y-u.y)*R,o.z+=(w[y.c].z-u.z)*R}}n.add(d),r.add(c),o.add(u),d=n,c=r,u=o}T=l.side===THREE.BackSide?e.intersectTriangle(u,c,d,!0):e.intersectTriangle(d,c,u,l.side!==THREE.DoubleSide),null!==T&&(T.applyMatrix4(this.matrixWorld),x=a.ray.origin.distanceTo(T),p>x||x<a.near||x>a.far||s.push({distance:x,point:T,face:y,faceIndex:E,object:this}))}}}(),THREE.Mesh.prototype.clone=function(t,e){return void 0===t&&(t=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t,e),t},THREE.Bone=function(t){THREE.Object3D.call(this),this.skin=t},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.constructor=THREE.Bone,THREE.Skeleton=function(t,e,i){if(this.useVertexTexture=void 0!==i?i:!0,this.identityMatrix=new THREE.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=t=256<this.bones.length?64:64<this.bones.length?32:16<this.bones.length?16:8,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;t>e;e++)this.boneInverses.push(new THREE.Matrix4)},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;e>t;t++){var i=new THREE.Matrix4;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},THREE.Skeleton.prototype.pose=function(){for(var t,e=0,i=this.bones.length;i>e;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;i>e;e++)(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},THREE.Skeleton.prototype.update=function(){var t=new THREE.Matrix4;return function(){for(var e=0,i=this.bones.length;i>e;e++)t.multiplyMatrices(this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix,this.boneInverses[e]),t.flattenToArrayOffset(this.boneMatrices,16*e);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.SkinnedMesh=function(t,e,i){if(THREE.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new THREE.Matrix4,this.bindMatrixInverse=new THREE.Matrix4,t=[],this.geometry&&void 0!==this.geometry.bones){for(var n,r,o,a,s=0,h=this.geometry.bones.length;h>s;++s)n=this.geometry.bones[s],r=n.pos,o=n.rotq,a=n.scl,e=new THREE.Bone(this),t.push(e),e.name=n.name,e.position.set(r[0],r[1],r[2]),e.quaternion.set(o[0],o[1],o[2],o[3]),void 0!==a?e.scale.set(a[0],a[1],a[2]):e.scale.set(1,1,1);for(s=0,h=this.geometry.bones.length;h>s;++s)n=this.geometry.bones[s],-1!==n.parent?t[n.parent].add(t[s]):this.add(t[s])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(t,void 0,i))},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh,THREE.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var t=0;t<this.geometry.skinIndices.length;t++){var e=this.geometry.skinWeights[t],i=1/e.lengthManhattan();1/0!==i?e.multiplyScalar(i):e.set(1)}},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},THREE.SkinnedMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,t),t},THREE.MorphAnimMesh=function(t,e){THREE.Mesh.call(this,t,e),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.currentKeyframe=this.lastKeyframe=this.time=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.constructor=THREE.MorphAnimMesh,THREE.MorphAnimMesh.prototype.setFrameRange=function(t,e){this.startKeyframe=t,this.endKeyframe=e,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var t=this.geometry;t.animations||(t.animations={});for(var e,i=t.animations,n=/([a-z]+)_?(\d+)/,r=0,o=t.morphTargets.length;o>r;r++){var a=t.morphTargets[r].name.match(n);if(a&&1<a.length){a=a[1],i[a]||(i[a]={start:1/0,end:-1/0});var s=i[a];r<s.start&&(s.start=r),r>s.end&&(s.end=r),e||(e=a)}}t.firstAnimation=e},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(t,e,i){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[t]={start:e,end:i}},THREE.MorphAnimMesh.prototype.playAnimation=function(t,e){var i=this.geometry.animations[t];i?(this.setFrameRange(i.start,i.end),this.duration=(i.end-i.start)/e*1e3,this.time=0):console.warn("animation["+t+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(t){var e=this.duration/this.length;this.time+=this.direction*t,this.mirroredLoop?(this.time>this.duration||0>this.time)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)):(this.time%=this.duration,0>this.time&&(this.time+=this.duration)),t=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/e),0,this.length-1),t!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[t]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=t),e=this.time%e/e,this.directionBackwards&&(e=1-e),this.morphTargetInfluences[this.currentKeyframe]=e,this.morphTargetInfluences[this.lastKeyframe]=1-e},THREE.MorphAnimMesh.prototype.interpolateTargets=function(t,e,i){for(var n=this.morphTargetInfluences,r=0,o=n.length;o>r;r++)n[r]=0;t>-1&&(n[t]=1-i),e>-1&&(n[e]=i)},THREE.MorphAnimMesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.MorphAnimMesh(this.geometry,this.material)),t.duration=this.duration,t.mirroredLoop=this.mirroredLoop,t.time=this.time,t.lastKeyframe=this.lastKeyframe,t.currentKeyframe=this.currentKeyframe,t.direction=this.direction,t.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,t),t},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=0;i<this.objects.length&&!(e<this.objects[i].distance);i++);this.objects.splice(i,0,{distance:e,object:t}),this.add(t)},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=1,i=this.objects.length;i>e&&!(t<this.objects[e].distance);e++);return this.objects[e-1].object},THREE.LOD.prototype.raycast=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),THREE.LOD.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(i){if(1<this.objects.length){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),i=t.distanceTo(e),this.objects[0].object.visible=!0;for(var n=1,r=this.objects.length;r>n&&i>=this.objects[n].distance;n++)this.objects[n-1].object.visible=!1,this.objects[n].object.visible=!0;for(;r>n;n++)this.objects[n].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(t){void 0===t&&(t=new THREE.LOD),THREE.Object3D.prototype.clone.call(this,t);for(var e=0,i=this.objects.length;i>e;e++){var n=this.objects[e].object.clone();n.visible=0===e,t.addLevel(n,this.objects[e].distance)}return t},THREE.Sprite=function(){var t=new Uint16Array([0,1,2,0,2,3]),e=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),i=new Float32Array([0,0,1,0,1,1,0,1]),n=new THREE.BufferGeometry;return n.addAttribute("index",new THREE.BufferAttribute(t,1)),n.addAttribute("position",new THREE.BufferAttribute(e,3)),n.addAttribute("uv",new THREE.BufferAttribute(i,2)),function(t){THREE.Object3D.call(this),this.type="Sprite",this.geometry=n,this.material=void 0!==t?t:new THREE.SpriteMaterial}}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.raycast=function(){var t=new THREE.Vector3;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.distanceToPoint(t);n>this.scale.x||i.push({distance:n,point:this.position,face:null,object:this})}}(),THREE.Sprite.prototype.clone=function(t){return void 0===t&&(t=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Particle=THREE.Sprite,THREE.LensFlare=function(t,e,i,n,r){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,i,n,r)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.constructor=THREE.LensFlare,THREE.LensFlare.prototype.add=function(t,e,i,n,r,o){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new THREE.Color(16777215)),void 0===n&&(n=THREE.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:r,blending:n})},THREE.LensFlare.prototype.updateLensFlares=function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;i>t;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},THREE.Scene=function(){THREE.Object3D.call(this),this.type="Scene",this.overrideMaterial=this.fog=null,this.autoUpdate=!0},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.clone=function(t){return void 0===t&&(t=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,t),null!==this.fog&&(t.fog=this.fog.clone()),null!==this.overrideMaterial&&(t.overrideMaterial=this.overrideMaterial.clone()),t.autoUpdate=this.autoUpdate,t.matrixAutoUpdate=this.matrixAutoUpdate,t},THREE.Fog=function(t,e,i){this.name="",this.color=new THREE.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(t,e){this.name="",this.color=new THREE.Color(t),this.density=void 0!==e?e:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.ShaderChunk={},THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n",THREE.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n	vec3 dirVector = normalize( lDirection.xyz );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float lDistance = 1.0;\n			if ( spotLightDistance[ i ] > 0.0 )\n				lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif",THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",THREE.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n	vec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n	vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",THREE.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",THREE.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif",THREE.ShaderChunk.lights_phong_fragment="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n	normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	vec3 pointDiffuse = vec3( 0.0 );\n	vec3 pointSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n				// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		pointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	vec3 spotDiffuse = vec3( 0.0 );\n	vec3 spotSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( spotLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n					// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n					// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	vec3 dirDiffuse = vec3( 0.0 );\n	vec3 dirSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n		vec3 dirVector = normalize( lDirection.xyz );\n\n				// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		dirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	vec3 hemiDiffuse = vec3( 0.0 );\n	vec3 hemiSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		hemiDiffuse += diffuse * hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n	totalDiffuse += dirDiffuse;\n	totalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	totalDiffuse += hemiDiffuse;\n	totalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	totalDiffuse += pointDiffuse;\n	totalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	totalDiffuse += spotDiffuse;\n	totalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif",THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif",THREE.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n			// Per-Pixel Tangent Space Normal Mapping\n			// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",THREE.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif",THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",THREE.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif",THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	#ifdef GAMMA_INPUT\n\n		texelColor.xyz *= texelColor.xyz;\n\n	#endif\n\n	gl_FragColor = gl_FragColor * texelColor;\n\n#endif",THREE.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif",THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif",THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	#ifdef GAMMA_INPUT\n\n		vColor = color * color;\n\n	#else\n\n		vColor = color;\n\n	#endif\n\n#endif",THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n\n#endif\n",THREE.ShaderChunk.linear_to_gamma_fragment="#ifdef GAMMA_OUTPUT\n\n	gl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif",THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",THREE.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n",THREE.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n		// Transforming Normal Vectors with the Inverse Transformation\n\n		vec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n		#ifdef ENVMAP_MODE_REFLECTION\n\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n		#else\n\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		#endif\n\n	#else\n\n		vec3 reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n	#else\n		float flipNormal = 1.0;\n	#endif\n\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = clamp( flipNormal * reflectVec.y * 0.5 + 0.5, 0.0, 1.0);\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * 0.15915494309189533576888376337251 + 0.5; // reciprocal( 2 PI ) + 0.5\n		vec4 envColor = texture2D( envMap, sampleUV );\n		\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n\n	#ifdef GAMMA_INPUT\n\n		envColor.xyz *= envColor.xyz;\n\n	#endif\n\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_MIX )\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, envColor.xyz, specularStrength * reflectivity );\n\n	#elif defined( ENVMAP_BLENDING_ADD )\n\n		gl_FragColor.xyz += envColor.xyz * specularStrength * reflectivity;\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		const float LOG2 = 1.442695;\n		float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n		fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif",THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n			// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n			//	http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n			// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif",THREE.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n	vec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n	vec3 objectNormal = morphedNormal;\n\n#else\n\n	vec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",THREE.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",THREE.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif",THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif",THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif",THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n	vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n	worldNormal = normalize( worldNormal );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	#ifdef ENVMAP_MODE_REFLECTION\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	#else\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	#ifdef GAMMA_OUTPUT\n\n		shadowColor *= shadowColor;\n\n	#endif\n\n	gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n",THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#elif defined( USE_MORPHTARGETS )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif",THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	gl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",THREE.UniformsUtils={merge:function(t){for(var e={},i=0;i<t.length;i++){var n,r=this.clone(t[i]);
for(n in r)e[n]=r[n]}return e},clone:function(t){var e,i={};for(e in t){i[e]={};for(var n in t[e]){var r=t[e][n];i[e][n]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r}}return i}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED\n		if ( gl_FrontFacing )\n			gl_FragColor.xyz *= vLightFront;\n		else\n			gl_FragColor.xyz *= vLightBack;\n	#else\n		gl_FragColor.xyz *= vLightFront;\n	#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	#ifdef USE_SIZEATTENUATION\n		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n	#else\n		gl_PointSize = size;\n	#endif\n	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	#else\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n	#endif\n	float color = 1.0 - smoothstep( mNear, mFar, depth );\n	gl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n	vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n	vWorldPosition = worldPosition.xyz;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n	vWorldPosition = worldPosition.xyz;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = clamp( tFlip * direction.y * -0.5 + 0.5, 0.0, 1.0);\nsampleUV.x = atan( direction.z, direction.x ) * 0.15915494309189533576888376337251 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n	res -= res.xxyz * bit_mask;\n	return res;\n}\nvoid main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT\n		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n	#else\n		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n	#endif\n}"].join("\n")}},THREE.WebGLRenderer=function(t){function e(t){var e=t.geometry;t=t.material;var i=e.vertices.length;if(t.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var n in t.attributes){var r=t.attributes[n];if(!r.__webglInitialized||r.createUniqueBuffers){r.__webglInitialized=!0;var o=1;"v2"===r.type?o=2:"v3"===r.type?o=3:"v4"===r.type?o=4:"c"===r.type&&(o=3),r.size=o,r.array=new Float32Array(i*o),r.buffer=Le.createBuffer(),r.buffer.belongsToAttribute=n,r.needsUpdate=!0}e.__webglCustomAttributesList.push(r)}}}function i(t,e){var i=e.geometry,r=t.faces3,o=3*r.length,a=1*r.length,s=3*r.length,r=n(e,t);t.__vertexArray=new Float32Array(3*o),t.__normalArray=new Float32Array(3*o),t.__colorArray=new Float32Array(3*o),t.__uvArray=new Float32Array(2*o),1<i.faceVertexUvs.length&&(t.__uv2Array=new Float32Array(2*o)),i.hasTangents&&(t.__tangentArray=new Float32Array(4*o)),e.geometry.skinWeights.length&&e.geometry.skinIndices.length&&(t.__skinIndexArray=new Float32Array(4*o),t.__skinWeightArray=new Float32Array(4*o)),i=null!==Ne.get("OES_element_index_uint")&&a>21845?Uint32Array:Uint16Array,t.__typeArray=i,t.__faceArray=new i(3*a),t.__lineArray=new i(2*s);var h=t.numMorphTargets;if(h)for(t.__morphTargetsArrays=[],i=0;h>i;i++)t.__morphTargetsArrays.push(new Float32Array(3*o));if(h=t.numMorphNormals)for(t.__morphNormalsArrays=[],i=0;h>i;i++)t.__morphNormalsArrays.push(new Float32Array(3*o));if(t.__webglFaceCount=3*a,t.__webglLineCount=2*s,r.attributes){void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]);for(var l in r.attributes){var c,a=r.attributes[l],s={};for(c in a)s[c]=a[c];(!s.__webglInitialized||s.createUniqueBuffers)&&(s.__webglInitialized=!0,i=1,"v2"===s.type?i=2:"v3"===s.type?i=3:"v4"===s.type?i=4:"c"===s.type&&(i=3),s.size=i,s.array=new Float32Array(o*i),s.buffer=Le.createBuffer(),s.buffer.belongsToAttribute=l,a.needsUpdate=!0,s.__original=a),t.__webglCustomAttributesList.push(s)}}t.__inittedArrays=!0}function n(t,e){return t.material instanceof THREE.MeshFaceMaterial?t.material.materials[e.materialIndex]:t.material}function r(t,e,i,n){i=i.attributes;var r=e.attributes;e=e.attributesKeys;for(var o=0,h=e.length;h>o;o++){var l=e[o],c=r[l];if(c>=0){var u=i[l];void 0!==u?(l=u.itemSize,Le.bindBuffer(Le.ARRAY_BUFFER,u.buffer),a(c),Le.vertexAttribPointer(c,l,Le.FLOAT,!1,0,n*l*4)):void 0!==t.defaultAttributeValues&&(2===t.defaultAttributeValues[l].length?Le.vertexAttrib2fv(c,t.defaultAttributeValues[l]):3===t.defaultAttributeValues[l].length&&Le.vertexAttrib3fv(c,t.defaultAttributeValues[l]))}}s()}function o(){for(var t=0,e=He.length;e>t;t++)He[t]=0}function a(t){He[t]=1,0===Me[t]&&(Le.enableVertexAttribArray(t),Me[t]=1)}function s(){for(var t=0,e=Me.length;e>t;t++)Me[t]!==He[t]&&(Le.disableVertexAttribArray(t),Me[t]=0)}function h(t,e){return t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function l(t,e){return t.z!==e.z?e.z-t.z:t.id-e.id}function c(t,e){return e[0]-t[0]}function u(t){if(!1!==t.visible){if(!(t instanceof THREE.Scene||t instanceof THREE.Group)){void 0===t.__webglInit&&(t.__webglInit=!0,t._modelViewMatrix=new THREE.Matrix4,t._normalMatrix=new THREE.Matrix3,t.addEventListener("removed",ii));var i=t.geometry;if(void 0!==i&&void 0===i.__webglInit)if(i.__webglInit=!0,i.addEventListener("dispose",ni),i instanceof THREE.BufferGeometry)te.info.memory.geometries++;else if(t instanceof THREE.Mesh)m(t,i);else if(t instanceof THREE.Line){if(void 0===i.__webglVertexBuffer){i.__webglVertexBuffer=Le.createBuffer(),i.__webglColorBuffer=Le.createBuffer(),i.__webglLineDistanceBuffer=Le.createBuffer(),te.info.memory.geometries++;var n=i.vertices.length;i.__vertexArray=new Float32Array(3*n),i.__colorArray=new Float32Array(3*n),i.__lineDistanceArray=new Float32Array(1*n),i.__webglLineCount=n,e(t),i.verticesNeedUpdate=!0,i.colorsNeedUpdate=!0,i.lineDistancesNeedUpdate=!0}}else t instanceof THREE.PointCloud&&void 0===i.__webglVertexBuffer&&(i.__webglVertexBuffer=Le.createBuffer(),i.__webglColorBuffer=Le.createBuffer(),te.info.memory.geometries++,n=i.vertices.length,i.__vertexArray=new Float32Array(3*n),i.__colorArray=new Float32Array(3*n),i.__sortArray=[],i.__webglParticleCount=n,e(t),i.verticesNeedUpdate=!0,i.colorsNeedUpdate=!0);if(void 0===t.__webglActive)if(t.__webglActive=!0,t instanceof THREE.Mesh){if(i instanceof THREE.BufferGeometry)g(Y,i,t);else if(i instanceof THREE.Geometry)for(var i=li[i.id],n=0,r=i.length;r>n;n++)g(Y,i[n],t)}else t instanceof THREE.Line||t instanceof THREE.PointCloud?g(Y,i,t):(t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback)&&$.push({id:null,object:t,opaque:null,transparent:null,z:0});if(t instanceof THREE.Light)X.push(t);else if(t instanceof THREE.Sprite)J.push(t);else if(t instanceof THREE.LensFlare)Q.push(t);else if((i=Y[t.id])&&(!1===t.frustumCulled||!0===Se.intersectsObject(t)))for(n=0,r=i.length;r>n;n++){var o=i[n],a=o,s=a.object,h=a.buffer,l=s.geometry,s=s.material;s instanceof THREE.MeshFaceMaterial?(s=s.materials[l instanceof THREE.BufferGeometry?0:h.materialIndex],a.material=s,s.transparent?K.push(a):Z.push(a)):s&&(a.material=s,s.transparent?K.push(a):Z.push(a)),o.render=!0,!0===te.sortObjects&&(Ae.setFromMatrixPosition(t.matrixWorld),Ae.applyProjection(Ce),o.z=Ae.z)}}for(n=0,r=t.children.length;r>n;n++)u(t.children[n])}}function d(t,e,i,n,r,o){for(var a,s=0,h=t.length;h>s;s++){a=t[s];var l=a.object,c=a.buffer;if(b(l,e),o)a=o;else{if(a=a.material,!a)continue;r&&te.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),te.setDepthTest(a.depthTest),te.setDepthWrite(a.depthWrite),M(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}te.setMaterialFaces(a),c instanceof THREE.BufferGeometry?te.renderBufferDirect(e,i,n,a,c,l):te.renderBuffer(e,i,n,a,c,l)}}function p(t,e,i,n,r,o,a){for(var s,h=0,l=t.length;l>h;h++){s=t[h];var c=s.object;if(c.visible){if(a)s=a;else{if(s=s[e],!s)continue;o&&te.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst),te.setDepthTest(s.depthTest),te.setDepthWrite(s.depthWrite),M(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}te.renderImmediateObject(i,n,r,s,c)}}}function f(t){var e=t.object.material;e.transparent?(t.transparent=e,t.opaque=null):(t.opaque=e,t.transparent=null)}function m(t,e){var n=t.material,r=!1;if(void 0===li[e.id]||!0===e.groupsNeedUpdate){delete Y[t.id];for(var o,a,s=li,h=e.id,n=n instanceof THREE.MeshFaceMaterial,l=Ne.get("OES_element_index_uint")?4294967296:65535,r={},c=e.morphTargets.length,u=e.morphNormals.length,d={},p=[],f=0,m=e.faces.length;m>f;f++){o=e.faces[f];var E=n?o.materialIndex:0;E in r||(r[E]={hash:E,counter:0}),o=r[E].hash+"_"+r[E].counter,o in d||(a={id:ci++,faces3:[],materialIndex:E,vertices:0,numMorphTargets:c,numMorphNormals:u},d[o]=a,p.push(a)),d[o].vertices+3>l&&(r[E].counter+=1,o=r[E].hash+"_"+r[E].counter,o in d||(a={id:ci++,faces3:[],materialIndex:E,vertices:0,numMorphTargets:c,numMorphNormals:u},d[o]=a,p.push(a))),d[o].faces3.push(f),d[o].vertices+=3}s[h]=p,e.groupsNeedUpdate=!1}for(s=li[e.id],h=0,n=s.length;n>h;h++){if(l=s[h],void 0===l.__webglVertexBuffer){if(r=l,r.__webglVertexBuffer=Le.createBuffer(),r.__webglNormalBuffer=Le.createBuffer(),r.__webglTangentBuffer=Le.createBuffer(),r.__webglColorBuffer=Le.createBuffer(),r.__webglUVBuffer=Le.createBuffer(),r.__webglUV2Buffer=Le.createBuffer(),r.__webglSkinIndicesBuffer=Le.createBuffer(),r.__webglSkinWeightsBuffer=Le.createBuffer(),r.__webglFaceBuffer=Le.createBuffer(),r.__webglLineBuffer=Le.createBuffer(),u=r.numMorphTargets)for(r.__webglMorphTargetsBuffers=[],c=0;u>c;c++)r.__webglMorphTargetsBuffers.push(Le.createBuffer());if(u=r.numMorphNormals)for(r.__webglMorphNormalsBuffers=[],c=0;u>c;c++)r.__webglMorphNormalsBuffers.push(Le.createBuffer());te.info.memory.geometries++,i(l,t),e.verticesNeedUpdate=!0,e.morphTargetsNeedUpdate=!0,e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0,e.normalsNeedUpdate=!0,e.tangentsNeedUpdate=!0,r=e.colorsNeedUpdate=!0}else r=!1;(r||void 0===t.__webglActive)&&g(Y,l,t)}t.__webglActive=!0}function g(t,e,i){var n=i.id;t[n]=t[n]||[],t[n].push({id:n,buffer:e,object:i,material:null,z:0})}function E(t){var e=t.geometry;if(e instanceof THREE.BufferGeometry)for(var r=e.attributes,o=e.attributesKeys,a=0,s=o.length;s>a;a++){var h=o[a],l=r[h];if(void 0===l.buffer&&(l.buffer=Le.createBuffer(),l.needsUpdate=!0),!0===l.needsUpdate){var c="index"===h?Le.ELEMENT_ARRAY_BUFFER:Le.ARRAY_BUFFER;Le.bindBuffer(c,l.buffer),Le.bufferData(c,l.array,Le.STATIC_DRAW),l.needsUpdate=!1}}else if(t instanceof THREE.Mesh){!0===e.groupsNeedUpdate&&m(t,e);for(var u=li[e.id],a=0,d=u.length;d>a;a++){var p=u[a],f=n(t,p);!0===e.groupsNeedUpdate&&i(p,t);var g=f.attributes&&v(f);if(e.verticesNeedUpdate||e.morphTargetsNeedUpdate||e.elementsNeedUpdate||e.uvsNeedUpdate||e.normalsNeedUpdate||e.colorsNeedUpdate||e.tangentsNeedUpdate||g){var E=p,_=t,T=Le.DYNAMIC_DRAW,x=!e.dynamic,b=f;if(E.__inittedArrays){var R=b&&void 0!==b.shading&&b.shading===THREE.SmoothShading,w=void 0,H=void 0,M=void 0,S=void 0,C=void 0,L=void 0,A=void 0,P=void 0,k=void 0,D=void 0,O=void 0,B=void 0,N=void 0,U=void 0,F=void 0,V=void 0,z=void 0,I=void 0,j=void 0,G=void 0,W=void 0,q=void 0,X=void 0,Y=void 0,$=void 0,Z=void 0,K=void 0,J=void 0,Q=void 0,te=void 0,ee=void 0,ie=void 0,ne=void 0,re=void 0,oe=void 0,ae=void 0,se=void 0,he=void 0,le=void 0,ce=void 0,ue=0,de=0,pe=0,fe=0,me=0,ge=0,Ee=0,ve=0,ye=0,_e=0,Te=0,xe=0,be=void 0,Re=E.__vertexArray,we=E.__uvArray,He=E.__uv2Array,Me=E.__normalArray,Se=E.__tangentArray,Ce=E.__colorArray,Ae=E.__skinIndexArray,Pe=E.__skinWeightArray,ke=E.__morphTargetsArrays,De=E.__morphNormalsArrays,Oe=E.__webglCustomAttributesList,Be=void 0,Ne=E.__faceArray,Ue=E.__lineArray,Fe=_.geometry,Ve=Fe.elementsNeedUpdate,ze=Fe.uvsNeedUpdate,Ie=Fe.normalsNeedUpdate,je=Fe.tangentsNeedUpdate,Ge=Fe.colorsNeedUpdate,We=Fe.morphTargetsNeedUpdate,qe=Fe.vertices,Xe=E.faces3,Ye=Fe.faces,$e=Fe.faceVertexUvs[0],Ze=Fe.faceVertexUvs[1],Ke=Fe.skinIndices,Je=Fe.skinWeights,Qe=Fe.morphTargets,ti=Fe.morphNormals;if(Fe.verticesNeedUpdate){for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],B=qe[S.a],N=qe[S.b],U=qe[S.c],Re[de]=B.x,Re[de+1]=B.y,Re[de+2]=B.z,Re[de+3]=N.x,Re[de+4]=N.y,Re[de+5]=N.z,Re[de+6]=U.x,Re[de+7]=U.y,Re[de+8]=U.z,de+=9;Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,Re,T)}if(We)for(oe=0,ae=Qe.length;ae>oe;oe++){for(w=Te=0,H=Xe.length;H>w;w++)le=Xe[w],S=Ye[le],B=Qe[oe].vertices[S.a],N=Qe[oe].vertices[S.b],U=Qe[oe].vertices[S.c],se=ke[oe],se[Te]=B.x,se[Te+1]=B.y,se[Te+2]=B.z,se[Te+3]=N.x,se[Te+4]=N.y,se[Te+5]=N.z,se[Te+6]=U.x,se[Te+7]=U.y,se[Te+8]=U.z,b.morphNormals&&(R?(ce=ti[oe].vertexNormals[le],I=ce.a,j=ce.b,G=ce.c):G=j=I=ti[oe].faceNormals[le],he=De[oe],he[Te]=I.x,he[Te+1]=I.y,he[Te+2]=I.z,he[Te+3]=j.x,he[Te+4]=j.y,he[Te+5]=j.z,he[Te+6]=G.x,he[Te+7]=G.y,he[Te+8]=G.z),Te+=9;Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglMorphTargetsBuffers[oe]),Le.bufferData(Le.ARRAY_BUFFER,ke[oe],T),b.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglMorphNormalsBuffers[oe]),Le.bufferData(Le.ARRAY_BUFFER,De[oe],T))}if(Je.length){for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],Y=Je[S.a],$=Je[S.b],Z=Je[S.c],Pe[_e]=Y.x,Pe[_e+1]=Y.y,Pe[_e+2]=Y.z,Pe[_e+3]=Y.w,Pe[_e+4]=$.x,Pe[_e+5]=$.y,Pe[_e+6]=$.z,Pe[_e+7]=$.w,Pe[_e+8]=Z.x,Pe[_e+9]=Z.y,Pe[_e+10]=Z.z,Pe[_e+11]=Z.w,K=Ke[S.a],J=Ke[S.b],Q=Ke[S.c],Ae[_e]=K.x,Ae[_e+1]=K.y,Ae[_e+2]=K.z,Ae[_e+3]=K.w,Ae[_e+4]=J.x,Ae[_e+5]=J.y,Ae[_e+6]=J.z,Ae[_e+7]=J.w,Ae[_e+8]=Q.x,Ae[_e+9]=Q.y,Ae[_e+10]=Q.z,Ae[_e+11]=Q.w,_e+=12;_e>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglSkinIndicesBuffer),Le.bufferData(Le.ARRAY_BUFFER,Ae,T),Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglSkinWeightsBuffer),Le.bufferData(Le.ARRAY_BUFFER,Pe,T))}if(Ge){for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],A=S.vertexColors,P=S.color,3===A.length&&b.vertexColors===THREE.VertexColors?(W=A[0],q=A[1],X=A[2]):X=q=W=P,Ce[ye]=W.r,Ce[ye+1]=W.g,Ce[ye+2]=W.b,Ce[ye+3]=q.r,Ce[ye+4]=q.g,Ce[ye+5]=q.b,Ce[ye+6]=X.r,Ce[ye+7]=X.g,Ce[ye+8]=X.b,ye+=9;ye>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,Ce,T))}if(je&&Fe.hasTangents){for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],k=S.vertexTangents,F=k[0],V=k[1],z=k[2],Se[Ee]=F.x,Se[Ee+1]=F.y,Se[Ee+2]=F.z,Se[Ee+3]=F.w,Se[Ee+4]=V.x,Se[Ee+5]=V.y,Se[Ee+6]=V.z,Se[Ee+7]=V.w,Se[Ee+8]=z.x,Se[Ee+9]=z.y,Se[Ee+10]=z.z,Se[Ee+11]=z.w,Ee+=12;Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglTangentBuffer),Le.bufferData(Le.ARRAY_BUFFER,Se,T)}if(Ie){for(w=0,H=Xe.length;H>w;w++)if(S=Ye[Xe[w]],C=S.vertexNormals,L=S.normal,3===C.length&&R)for(te=0;3>te;te++)ie=C[te],Me[ge]=ie.x,Me[ge+1]=ie.y,Me[ge+2]=ie.z,ge+=3;else for(te=0;3>te;te++)Me[ge]=L.x,Me[ge+1]=L.y,Me[ge+2]=L.z,ge+=3;Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglNormalBuffer),Le.bufferData(Le.ARRAY_BUFFER,Me,T)}if(ze&&$e){for(w=0,H=Xe.length;H>w;w++)if(M=Xe[w],D=$e[M],void 0!==D)for(te=0;3>te;te++)ne=D[te],we[pe]=ne.x,we[pe+1]=ne.y,pe+=2;pe>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglUVBuffer),Le.bufferData(Le.ARRAY_BUFFER,we,T))}if(ze&&Ze){for(w=0,H=Xe.length;H>w;w++)if(M=Xe[w],O=Ze[M],void 0!==O)for(te=0;3>te;te++)re=O[te],He[fe]=re.x,He[fe+1]=re.y,fe+=2;fe>0&&(Le.bindBuffer(Le.ARRAY_BUFFER,E.__webglUV2Buffer),Le.bufferData(Le.ARRAY_BUFFER,He,T))}if(Ve){for(w=0,H=Xe.length;H>w;w++)Ne[me]=ue,Ne[me+1]=ue+1,Ne[me+2]=ue+2,me+=3,Ue[ve]=ue,Ue[ve+1]=ue+1,Ue[ve+2]=ue,Ue[ve+3]=ue+2,Ue[ve+4]=ue+1,Ue[ve+5]=ue+2,ve+=6,ue+=3;Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),Le.bufferData(Le.ELEMENT_ARRAY_BUFFER,Ne,T),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,E.__webglLineBuffer),Le.bufferData(Le.ELEMENT_ARRAY_BUFFER,Ue,T)}if(Oe)for(te=0,ee=Oe.length;ee>te;te++)if(Be=Oe[te],Be.__original.needsUpdate){if(xe=0,1===Be.size){if(void 0===Be.boundTo||"vertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],Be.array[xe]=Be.value[S.a],Be.array[xe+1]=Be.value[S.b],Be.array[xe+2]=Be.value[S.c],xe+=3;else if("faces"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)be=Be.value[Xe[w]],Be.array[xe]=be,Be.array[xe+1]=be,Be.array[xe+2]=be,xe+=3}else if(2===Be.size){if(void 0===Be.boundTo||"vertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],B=Be.value[S.a],N=Be.value[S.b],U=Be.value[S.c],Be.array[xe]=B.x,Be.array[xe+1]=B.y,Be.array[xe+2]=N.x,Be.array[xe+3]=N.y,Be.array[xe+4]=U.x,Be.array[xe+5]=U.y,xe+=6;else if("faces"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)U=N=B=be=Be.value[Xe[w]],Be.array[xe]=B.x,Be.array[xe+1]=B.y,Be.array[xe+2]=N.x,Be.array[xe+3]=N.y,Be.array[xe+4]=U.x,Be.array[xe+5]=U.y,xe+=6}else if(3===Be.size){var ei;if(ei="c"===Be.type?["r","g","b"]:["x","y","z"],void 0===Be.boundTo||"vertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],B=Be.value[S.a],N=Be.value[S.b],U=Be.value[S.c],Be.array[xe]=B[ei[0]],Be.array[xe+1]=B[ei[1]],Be.array[xe+2]=B[ei[2]],Be.array[xe+3]=N[ei[0]],Be.array[xe+4]=N[ei[1]],Be.array[xe+5]=N[ei[2]],Be.array[xe+6]=U[ei[0]],Be.array[xe+7]=U[ei[1]],Be.array[xe+8]=U[ei[2]],xe+=9;else if("faces"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)U=N=B=be=Be.value[Xe[w]],Be.array[xe]=B[ei[0]],Be.array[xe+1]=B[ei[1]],Be.array[xe+2]=B[ei[2]],Be.array[xe+3]=N[ei[0]],Be.array[xe+4]=N[ei[1]],Be.array[xe+5]=N[ei[2]],Be.array[xe+6]=U[ei[0]],Be.array[xe+7]=U[ei[1]],Be.array[xe+8]=U[ei[2]],xe+=9;else if("faceVertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)be=Be.value[Xe[w]],B=be[0],N=be[1],U=be[2],Be.array[xe]=B[ei[0]],Be.array[xe+1]=B[ei[1]],Be.array[xe+2]=B[ei[2]],Be.array[xe+3]=N[ei[0]],Be.array[xe+4]=N[ei[1]],Be.array[xe+5]=N[ei[2]],Be.array[xe+6]=U[ei[0]],Be.array[xe+7]=U[ei[1]],Be.array[xe+8]=U[ei[2]],xe+=9}else if(4===Be.size)if(void 0===Be.boundTo||"vertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)S=Ye[Xe[w]],B=Be.value[S.a],N=Be.value[S.b],U=Be.value[S.c],Be.array[xe]=B.x,Be.array[xe+1]=B.y,Be.array[xe+2]=B.z,Be.array[xe+3]=B.w,Be.array[xe+4]=N.x,Be.array[xe+5]=N.y,Be.array[xe+6]=N.z,Be.array[xe+7]=N.w,Be.array[xe+8]=U.x,Be.array[xe+9]=U.y,Be.array[xe+10]=U.z,Be.array[xe+11]=U.w,xe+=12;else if("faces"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)U=N=B=be=Be.value[Xe[w]],Be.array[xe]=B.x,Be.array[xe+1]=B.y,Be.array[xe+2]=B.z,Be.array[xe+3]=B.w,Be.array[xe+4]=N.x,Be.array[xe+5]=N.y,Be.array[xe+6]=N.z,Be.array[xe+7]=N.w,Be.array[xe+8]=U.x,Be.array[xe+9]=U.y,Be.array[xe+10]=U.z,Be.array[xe+11]=U.w,xe+=12;else if("faceVertices"===Be.boundTo)for(w=0,H=Xe.length;H>w;w++)be=Be.value[Xe[w]],B=be[0],N=be[1],U=be[2],Be.array[xe]=B.x,Be.array[xe+1]=B.y,Be.array[xe+2]=B.z,Be.array[xe+3]=B.w,Be.array[xe+4]=N.x,Be.array[xe+5]=N.y,Be.array[xe+6]=N.z,Be.array[xe+7]=N.w,Be.array[xe+8]=U.x,Be.array[xe+9]=U.y,Be.array[xe+10]=U.z,Be.array[xe+11]=U.w,xe+=12;
Le.bindBuffer(Le.ARRAY_BUFFER,Be.buffer),Le.bufferData(Le.ARRAY_BUFFER,Be.array,T)}x&&(delete E.__inittedArrays,delete E.__colorArray,delete E.__normalArray,delete E.__tangentArray,delete E.__uvArray,delete E.__uv2Array,delete E.__faceArray,delete E.__vertexArray,delete E.__lineArray,delete E.__skinIndexArray,delete E.__skinWeightArray)}}}e.verticesNeedUpdate=!1,e.morphTargetsNeedUpdate=!1,e.elementsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.tangentsNeedUpdate=!1,f.attributes&&y(f)}else if(t instanceof THREE.Line){if(f=n(t,e),g=f.attributes&&v(f),e.verticesNeedUpdate||e.colorsNeedUpdate||e.lineDistancesNeedUpdate||g){var ii,ni,ri,oi,ai,si,hi,ci,ui,di,pi,fi,mi=Le.DYNAMIC_DRAW,gi=e.vertices,Ei=e.colors,vi=e.lineDistances,yi=gi.length,_i=Ei.length,Ti=vi.length,xi=e.__vertexArray,bi=e.__colorArray,Ri=e.__lineDistanceArray,wi=e.colorsNeedUpdate,Hi=e.lineDistancesNeedUpdate,Mi=e.__webglCustomAttributesList;if(e.verticesNeedUpdate){for(ii=0;yi>ii;ii++)oi=gi[ii],ai=3*ii,xi[ai]=oi.x,xi[ai+1]=oi.y,xi[ai+2]=oi.z;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,xi,mi)}if(wi){for(ni=0;_i>ni;ni++)si=Ei[ni],ai=3*ni,bi[ai]=si.r,bi[ai+1]=si.g,bi[ai+2]=si.b;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,bi,mi)}if(Hi){for(ri=0;Ti>ri;ri++)Ri[ri]=vi[ri];Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglLineDistanceBuffer),Le.bufferData(Le.ARRAY_BUFFER,Ri,mi)}if(Mi)for(hi=0,ci=Mi.length;ci>hi;hi++)if(fi=Mi[hi],fi.needsUpdate&&(void 0===fi.boundTo||"vertices"===fi.boundTo)){if(ai=0,di=fi.value.length,1===fi.size)for(ui=0;di>ui;ui++)fi.array[ui]=fi.value[ui];else if(2===fi.size)for(ui=0;di>ui;ui++)pi=fi.value[ui],fi.array[ai]=pi.x,fi.array[ai+1]=pi.y,ai+=2;else if(3===fi.size)if("c"===fi.type)for(ui=0;di>ui;ui++)pi=fi.value[ui],fi.array[ai]=pi.r,fi.array[ai+1]=pi.g,fi.array[ai+2]=pi.b,ai+=3;else for(ui=0;di>ui;ui++)pi=fi.value[ui],fi.array[ai]=pi.x,fi.array[ai+1]=pi.y,fi.array[ai+2]=pi.z,ai+=3;else if(4===fi.size)for(ui=0;di>ui;ui++)pi=fi.value[ui],fi.array[ai]=pi.x,fi.array[ai+1]=pi.y,fi.array[ai+2]=pi.z,fi.array[ai+3]=pi.w,ai+=4;Le.bindBuffer(Le.ARRAY_BUFFER,fi.buffer),Le.bufferData(Le.ARRAY_BUFFER,fi.array,mi),fi.needsUpdate=!1}}e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,e.lineDistancesNeedUpdate=!1,f.attributes&&y(f)}else if(t instanceof THREE.PointCloud){if(f=n(t,e),g=f.attributes&&v(f),e.verticesNeedUpdate||e.colorsNeedUpdate||g){var Si,Ci,Li,Ai,Pi,ki,Di,Oi,Bi,Ni,Ui,Fi=Le.DYNAMIC_DRAW,Vi=e.vertices,zi=Vi.length,Ii=e.colors,ji=Ii.length,Gi=e.__vertexArray,Wi=e.__colorArray,qi=e.colorsNeedUpdate,Xi=e.__webglCustomAttributesList;if(e.verticesNeedUpdate){for(Si=0;zi>Si;Si++)Li=Vi[Si],Ai=3*Si,Gi[Ai]=Li.x,Gi[Ai+1]=Li.y,Gi[Ai+2]=Li.z;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,Gi,Fi)}if(qi){for(Ci=0;ji>Ci;Ci++)Pi=Ii[Ci],Ai=3*Ci,Wi[Ai]=Pi.r,Wi[Ai+1]=Pi.g,Wi[Ai+2]=Pi.b;Le.bindBuffer(Le.ARRAY_BUFFER,e.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,Wi,Fi)}if(Xi)for(ki=0,Di=Xi.length;Di>ki;ki++){if(Ui=Xi[ki],Ui.needsUpdate&&(void 0===Ui.boundTo||"vertices"===Ui.boundTo))if(Bi=Ui.value.length,Ai=0,1===Ui.size)for(Oi=0;Bi>Oi;Oi++)Ui.array[Oi]=Ui.value[Oi];else if(2===Ui.size)for(Oi=0;Bi>Oi;Oi++)Ni=Ui.value[Oi],Ui.array[Ai]=Ni.x,Ui.array[Ai+1]=Ni.y,Ai+=2;else if(3===Ui.size)if("c"===Ui.type)for(Oi=0;Bi>Oi;Oi++)Ni=Ui.value[Oi],Ui.array[Ai]=Ni.r,Ui.array[Ai+1]=Ni.g,Ui.array[Ai+2]=Ni.b,Ai+=3;else for(Oi=0;Bi>Oi;Oi++)Ni=Ui.value[Oi],Ui.array[Ai]=Ni.x,Ui.array[Ai+1]=Ni.y,Ui.array[Ai+2]=Ni.z,Ai+=3;else if(4===Ui.size)for(Oi=0;Bi>Oi;Oi++)Ni=Ui.value[Oi],Ui.array[Ai]=Ni.x,Ui.array[Ai+1]=Ni.y,Ui.array[Ai+2]=Ni.z,Ui.array[Ai+3]=Ni.w,Ai+=4;Le.bindBuffer(Le.ARRAY_BUFFER,Ui.buffer),Le.bufferData(Le.ARRAY_BUFFER,Ui.array,Fi),Ui.needsUpdate=!1}}e.verticesNeedUpdate=!1,e.colorsNeedUpdate=!1,f.attributes&&y(f)}}function v(t){for(var e in t.attributes)if(t.attributes[e].needsUpdate)return!0;return!1}function y(t){for(var e in t.attributes)t.attributes[e].needsUpdate=!1}function _(t,e,i,n,r){var o,a,s,h;if(se=0,n.needsUpdate){n.program&&hi(n),n.addEventListener("dispose",ai);var l=ui[n.type];if(l){var c=THREE.ShaderLib[l];n.__webglShader={uniforms:THREE.UniformsUtils.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else n.__webglShader={uniforms:n.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader};for(var u=0,d=0,p=0,f=0,m=0,g=e.length;g>m;m++){var E=e[m];E.onlyShadow||!1===E.visible||(E instanceof THREE.DirectionalLight&&u++,E instanceof THREE.PointLight&&d++,E instanceof THREE.SpotLight&&p++,E instanceof THREE.HemisphereLight&&f++)}o=u,a=d,s=p,h=f;for(var v,y=0,_=0,b=e.length;b>_;_++){var H=e[_];H.castShadow&&(H instanceof THREE.SpotLight&&y++,H instanceof THREE.DirectionalLight&&!H.shadowCascade&&y++)}v=y;var M;if(We&&r&&r.skeleton&&r.skeleton.useVertexTexture)M=1024;else{var L=Le.getParameter(Le.MAX_VERTEX_UNIFORM_VECTORS),A=Math.floor((L-20)/4);void 0!==r&&r instanceof THREE.SkinnedMesh&&(A=Math.min(r.skeleton.bones.length,A),A<r.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+r.skeleton.bones.length+", this GPU supports just "+A+" (try OpenGL instead of ANGLE)")),M=A}var P={precision:N,supportsVertexTextures:Ge,map:!!n.map,envMap:!!n.envMap,envMapMode:n.envMap&&n.envMap.mapping,lightMap:!!n.lightMap,bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,combine:n.combine,vertexColors:n.vertexColors,fog:i,useFog:n.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:G,skinning:n.skinning,maxBones:M,useVertexTexture:We&&r&&r.skeleton&&r.skeleton.useVertexTexture,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:te.maxMorphTargets,maxMorphNormals:te.maxMorphNormals,maxDirLights:o,maxPointLights:a,maxSpotLights:s,maxHemiLights:h,maxShadows:v,shadowMapEnabled:te.shadowMapEnabled&&r.receiveShadow&&v>0,shadowMapType:te.shadowMapType,shadowMapDebug:te.shadowMapDebug,shadowMapCascade:te.shadowMapCascade,alphaTest:n.alphaTest,metal:n.metal,wrapAround:n.wrapAround,doubleSided:n.side===THREE.DoubleSide,flipSided:n.side===THREE.BackSide},O=[];if(l?O.push(l):(O.push(n.fragmentShader),O.push(n.vertexShader)),void 0!==n.defines)for(var B in n.defines)O.push(B),O.push(n.defines[B]);for(B in P)O.push(B),O.push(P[B]);for(var U,F=O.join(),V=0,z=ee.length;z>V;V++){var I=ee[V];if(I.code===F){U=I,U.usedTimes++;break}}void 0===U&&(U=new THREE.WebGLProgram(te,F,n,P),ee.push(U),te.info.memory.programs=ee.length),n.program=U;var j=U.attributes;if(n.morphTargets){n.numSupportedMorphTargets=0;for(var W,q="morphTarget",X=0;X<te.maxMorphTargets;X++)W=q+X,0<=j[W]&&n.numSupportedMorphTargets++}if(n.morphNormals)for(n.numSupportedMorphNormals=0,q="morphNormal",X=0;X<te.maxMorphNormals;X++)W=q+X,0<=j[W]&&n.numSupportedMorphNormals++;n.uniformsList=[];for(var Y in n.__webglShader.uniforms){var $=n.program.uniforms[Y];$&&n.uniformsList.push([n.__webglShader.uniforms[Y],$])}n.needsUpdate=!1}n.morphTargets&&!r.__webglMorphTargetInfluences&&(r.__webglMorphTargetInfluences=new Float32Array(te.maxMorphTargets));var Z=!1,K=!1,J=!1,Q=n.program,ne=Q.uniforms,oe=n.__webglShader.uniforms;if(Q.id!==ie&&(Le.useProgram(Q.program),ie=Q.id,J=K=Z=!0),n.id!==re&&(-1===re&&(J=!0),re=n.id,K=!0),(Z||t!==ae)&&(Le.uniformMatrix4fv(ne.projectionMatrix,!1,t.projectionMatrix.elements),G&&Le.uniform1f(ne.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==ae&&(ae=t),(n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n.envMap)&&null!==ne.cameraPosition&&(Ae.setFromMatrixPosition(t.matrixWorld),Le.uniform3f(ne.cameraPosition,Ae.x,Ae.y,Ae.z)),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshBasicMaterial||n instanceof THREE.ShaderMaterial||n.skinning)&&null!==ne.viewMatrix&&Le.uniformMatrix4fv(ne.viewMatrix,!1,t.matrixWorldInverse.elements)),n.skinning)if(r.bindMatrix&&null!==ne.bindMatrix&&Le.uniformMatrix4fv(ne.bindMatrix,!1,r.bindMatrix.elements),r.bindMatrixInverse&&null!==ne.bindMatrixInverse&&Le.uniformMatrix4fv(ne.bindMatrixInverse,!1,r.bindMatrixInverse.elements),We&&r.skeleton&&r.skeleton.useVertexTexture){if(null!==ne.boneTexture){var he=x();Le.uniform1i(ne.boneTexture,he),te.setTexture(r.skeleton.boneTexture,he)}null!==ne.boneTextureWidth&&Le.uniform1i(ne.boneTextureWidth,r.skeleton.boneTextureWidth),null!==ne.boneTextureHeight&&Le.uniform1i(ne.boneTextureHeight,r.skeleton.boneTextureHeight)}else r.skeleton&&r.skeleton.boneMatrices&&null!==ne.boneGlobalMatrices&&Le.uniformMatrix4fv(ne.boneGlobalMatrices,!1,r.skeleton.boneMatrices);if(K){if(i&&n.fog&&(oe.fogColor.value=i.color,i instanceof THREE.Fog?(oe.fogNear.value=i.near,oe.fogFar.value=i.far):i instanceof THREE.FogExp2&&(oe.fogDensity.value=i.density)),n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n.lights){if(ke){var le,ce,ue,de,pe,fe,me,ge,Ee,J=!0,ve=0,ye=0,_e=0,Te=De,xe=Te.directional.colors,be=Te.directional.positions,Re=Te.point.colors,we=Te.point.positions,He=Te.point.distances,Me=Te.spot.colors,Se=Te.spot.positions,Ce=Te.spot.distances,Oe=Te.spot.directions,Be=Te.spot.anglesCos,Ne=Te.spot.exponents,Ue=Te.hemi.skyColors,Fe=Te.hemi.groundColors,Ve=Te.hemi.positions,ze=0,Ie=0,qe=0,Xe=0,Ye=0,$e=0,Ke=0,Je=0,Qe=0,ti=0,ei=0,ii=0;for(le=0,ce=e.length;ce>le;le++)ue=e[le],ue.onlyShadow||(de=ue.color,me=ue.intensity,Ee=ue.distance,ue instanceof THREE.AmbientLight?ue.visible&&(te.gammaInput?(ve+=de.r*de.r,ye+=de.g*de.g,_e+=de.b*de.b):(ve+=de.r,ye+=de.g,_e+=de.b)):ue instanceof THREE.DirectionalLight?(Ye+=1,ue.visible&&(Pe.setFromMatrixPosition(ue.matrixWorld),Ae.setFromMatrixPosition(ue.target.matrixWorld),Pe.sub(Ae),Pe.normalize(),Qe=3*ze,be[Qe]=Pe.x,be[Qe+1]=Pe.y,be[Qe+2]=Pe.z,te.gammaInput?R(xe,Qe,de,me*me):w(xe,Qe,de,me),ze+=1)):ue instanceof THREE.PointLight?($e+=1,ue.visible&&(ti=3*Ie,te.gammaInput?R(Re,ti,de,me*me):w(Re,ti,de,me),Ae.setFromMatrixPosition(ue.matrixWorld),we[ti]=Ae.x,we[ti+1]=Ae.y,we[ti+2]=Ae.z,He[Ie]=Ee,Ie+=1)):ue instanceof THREE.SpotLight?(Ke+=1,ue.visible&&(ei=3*qe,te.gammaInput?R(Me,ei,de,me*me):w(Me,ei,de,me),Pe.setFromMatrixPosition(ue.matrixWorld),Se[ei]=Pe.x,Se[ei+1]=Pe.y,Se[ei+2]=Pe.z,Ce[qe]=Ee,Ae.setFromMatrixPosition(ue.target.matrixWorld),Pe.sub(Ae),Pe.normalize(),Oe[ei]=Pe.x,Oe[ei+1]=Pe.y,Oe[ei+2]=Pe.z,Be[qe]=Math.cos(ue.angle),Ne[qe]=ue.exponent,qe+=1)):ue instanceof THREE.HemisphereLight&&(Je+=1,ue.visible&&(Pe.setFromMatrixPosition(ue.matrixWorld),Pe.normalize(),ii=3*Xe,Ve[ii]=Pe.x,Ve[ii+1]=Pe.y,Ve[ii+2]=Pe.z,pe=ue.color,fe=ue.groundColor,te.gammaInput?(ge=me*me,R(Ue,ii,pe,ge),R(Fe,ii,fe,ge)):(w(Ue,ii,pe,me),w(Fe,ii,fe,me)),Xe+=1)));for(le=3*ze,ce=Math.max(xe.length,3*Ye);ce>le;le++)xe[le]=0;for(le=3*Ie,ce=Math.max(Re.length,3*$e);ce>le;le++)Re[le]=0;for(le=3*qe,ce=Math.max(Me.length,3*Ke);ce>le;le++)Me[le]=0;for(le=3*Xe,ce=Math.max(Ue.length,3*Je);ce>le;le++)Ue[le]=0;for(le=3*Xe,ce=Math.max(Fe.length,3*Je);ce>le;le++)Fe[le]=0;Te.directional.length=ze,Te.point.length=Ie,Te.spot.length=qe,Te.hemi.length=Xe,Te.ambient[0]=ve,Te.ambient[1]=ye,Te.ambient[2]=_e,ke=!1}if(J){var ni=De;oe.ambientLightColor.value=ni.ambient,oe.directionalLightColor.value=ni.directional.colors,oe.directionalLightDirection.value=ni.directional.positions,oe.pointLightColor.value=ni.point.colors,oe.pointLightPosition.value=ni.point.positions,oe.pointLightDistance.value=ni.point.distances,oe.spotLightColor.value=ni.spot.colors,oe.spotLightPosition.value=ni.spot.positions,oe.spotLightDistance.value=ni.spot.distances,oe.spotLightDirection.value=ni.spot.directions,oe.spotLightAngleCos.value=ni.spot.anglesCos,oe.spotLightExponent.value=ni.spot.exponents,oe.hemisphereLightSkyColor.value=ni.hemi.skyColors,oe.hemisphereLightGroundColor.value=ni.hemi.groundColors,oe.hemisphereLightDirection.value=ni.hemi.positions,T(oe,!0)}else T(oe,!1)}if(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial){oe.opacity.value=n.opacity,te.gammaInput?oe.diffuse.value.copyGammaToLinear(n.color):oe.diffuse.value=n.color,oe.map.value=n.map,oe.lightMap.value=n.lightMap,oe.specularMap.value=n.specularMap,oe.alphaMap.value=n.alphaMap,n.bumpMap&&(oe.bumpMap.value=n.bumpMap,oe.bumpScale.value=n.bumpScale),n.normalMap&&(oe.normalMap.value=n.normalMap,oe.normalScale.value.copy(n.normalScale));var oi;if(n.map?oi=n.map:n.specularMap?oi=n.specularMap:n.normalMap?oi=n.normalMap:n.bumpMap?oi=n.bumpMap:n.alphaMap&&(oi=n.alphaMap),void 0!==oi){var si=oi.offset,li=oi.repeat;oe.offsetRepeat.value.set(si.x,si.y,li.x,li.y)}oe.envMap.value=n.envMap,oe.flipEnvMap.value=n.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,oe.reflectivity.value=n.reflectivity,oe.refractionRatio.value=n.refractionRatio}if(n instanceof THREE.LineBasicMaterial?(oe.diffuse.value=n.color,oe.opacity.value=n.opacity):n instanceof THREE.LineDashedMaterial?(oe.diffuse.value=n.color,oe.opacity.value=n.opacity,oe.dashSize.value=n.dashSize,oe.totalSize.value=n.dashSize+n.gapSize,oe.scale.value=n.scale):n instanceof THREE.PointCloudMaterial?(oe.psColor.value=n.color,oe.opacity.value=n.opacity,oe.size.value=n.size,oe.scale.value=D.height/2,oe.map.value=n.map):n instanceof THREE.MeshPhongMaterial?(oe.shininess.value=n.shininess,te.gammaInput?(oe.ambient.value.copyGammaToLinear(n.ambient),oe.emissive.value.copyGammaToLinear(n.emissive),oe.specular.value.copyGammaToLinear(n.specular)):(oe.ambient.value=n.ambient,oe.emissive.value=n.emissive,oe.specular.value=n.specular),n.wrapAround&&oe.wrapRGB.value.copy(n.wrapRGB)):n instanceof THREE.MeshLambertMaterial?(te.gammaInput?(oe.ambient.value.copyGammaToLinear(n.ambient),oe.emissive.value.copyGammaToLinear(n.emissive)):(oe.ambient.value=n.ambient,oe.emissive.value=n.emissive),n.wrapAround&&oe.wrapRGB.value.copy(n.wrapRGB)):n instanceof THREE.MeshDepthMaterial?(oe.mNear.value=t.near,oe.mFar.value=t.far,oe.opacity.value=n.opacity):n instanceof THREE.MeshNormalMaterial&&(oe.opacity.value=n.opacity),r.receiveShadow&&!n._shadowPass&&oe.shadowMatrix)for(var ci=0,di=0,pi=e.length;pi>di;di++){var fi=e[di];fi.castShadow&&(fi instanceof THREE.SpotLight||fi instanceof THREE.DirectionalLight&&!fi.shadowCascade)&&(oe.shadowMap.value[ci]=fi.shadowMap,oe.shadowMapSize.value[ci]=fi.shadowMapSize,oe.shadowMatrix.value[ci]=fi.shadowMatrix,oe.shadowDarkness.value[ci]=fi.shadowDarkness,oe.shadowBias.value[ci]=fi.shadowBias,ci++)}for(var mi,gi,Ei,vi=n.uniformsList,yi=0,_i=vi.length;_i>yi;yi++){var Ti=vi[yi][0];if(!1!==Ti.needsUpdate){var xi=Ti.type,bi=Ti.value,Ri=vi[yi][1];switch(xi){case"1i":Le.uniform1i(Ri,bi);break;case"1f":Le.uniform1f(Ri,bi);break;case"2f":Le.uniform2f(Ri,bi[0],bi[1]);break;case"3f":Le.uniform3f(Ri,bi[0],bi[1],bi[2]);break;case"4f":Le.uniform4f(Ri,bi[0],bi[1],bi[2],bi[3]);break;case"1iv":Le.uniform1iv(Ri,bi);break;case"3iv":Le.uniform3iv(Ri,bi);break;case"1fv":Le.uniform1fv(Ri,bi);break;case"2fv":Le.uniform2fv(Ri,bi);break;case"3fv":Le.uniform3fv(Ri,bi);break;case"4fv":Le.uniform4fv(Ri,bi);break;case"Matrix3fv":Le.uniformMatrix3fv(Ri,!1,bi);break;case"Matrix4fv":Le.uniformMatrix4fv(Ri,!1,bi);break;case"i":Le.uniform1i(Ri,bi);break;case"f":Le.uniform1f(Ri,bi);break;case"v2":Le.uniform2f(Ri,bi.x,bi.y);break;case"v3":Le.uniform3f(Ri,bi.x,bi.y,bi.z);break;case"v4":Le.uniform4f(Ri,bi.x,bi.y,bi.z,bi.w);break;case"c":Le.uniform3f(Ri,bi.r,bi.g,bi.b);break;case"iv1":Le.uniform1iv(Ri,bi);break;case"iv":Le.uniform3iv(Ri,bi);break;case"fv1":Le.uniform1fv(Ri,bi);break;case"fv":Le.uniform3fv(Ri,bi);break;case"v2v":void 0===Ti._array&&(Ti._array=new Float32Array(2*bi.length));for(var wi=0,Hi=bi.length;Hi>wi;wi++)Ei=2*wi,Ti._array[Ei]=bi[wi].x,Ti._array[Ei+1]=bi[wi].y;Le.uniform2fv(Ri,Ti._array);break;case"v3v":for(void 0===Ti._array&&(Ti._array=new Float32Array(3*bi.length)),wi=0,Hi=bi.length;Hi>wi;wi++)Ei=3*wi,Ti._array[Ei]=bi[wi].x,Ti._array[Ei+1]=bi[wi].y,Ti._array[Ei+2]=bi[wi].z;Le.uniform3fv(Ri,Ti._array);break;case"v4v":for(void 0===Ti._array&&(Ti._array=new Float32Array(4*bi.length)),wi=0,Hi=bi.length;Hi>wi;wi++)Ei=4*wi,Ti._array[Ei]=bi[wi].x,Ti._array[Ei+1]=bi[wi].y,Ti._array[Ei+2]=bi[wi].z,Ti._array[Ei+3]=bi[wi].w;Le.uniform4fv(Ri,Ti._array);break;case"m3":Le.uniformMatrix3fv(Ri,!1,bi.elements);break;case"m3v":for(void 0===Ti._array&&(Ti._array=new Float32Array(9*bi.length)),wi=0,Hi=bi.length;Hi>wi;wi++)bi[wi].flattenToArrayOffset(Ti._array,9*wi);Le.uniformMatrix3fv(Ri,!1,Ti._array);break;case"m4":Le.uniformMatrix4fv(Ri,!1,bi.elements);break;case"m4v":for(void 0===Ti._array&&(Ti._array=new Float32Array(16*bi.length)),wi=0,Hi=bi.length;Hi>wi;wi++)bi[wi].flattenToArrayOffset(Ti._array,16*wi);Le.uniformMatrix4fv(Ri,!1,Ti._array);break;case"t":if(mi=bi,gi=x(),Le.uniform1i(Ri,gi),!mi)continue;if(mi instanceof THREE.CubeTexture||mi.image instanceof Array&&6===mi.image.length){var Mi=mi,Si=gi;if(6===Mi.image.length)if(Mi.needsUpdate){Mi.image.__webglTextureCube||(Mi.addEventListener("dispose",ri),Mi.image.__webglTextureCube=Le.createTexture(),te.info.memory.textures++),Le.activeTexture(Le.TEXTURE0+Si),Le.bindTexture(Le.TEXTURE_CUBE_MAP,Mi.image.__webglTextureCube),Le.pixelStorei(Le.UNPACK_FLIP_Y_WEBGL,Mi.flipY);for(var Ci=Mi instanceof THREE.CompressedTexture,Li=Mi.image[0]instanceof THREE.DataTexture,Ai=[],Pi=0;6>Pi;Pi++)Ai[Pi]=!te.autoScaleCubemaps||Ci||Li?Li?Mi.image[Pi].image:Mi.image[Pi]:C(Mi.image[Pi],je);var ki=Ai[0],Di=THREE.Math.isPowerOfTwo(ki.width)&&THREE.Math.isPowerOfTwo(ki.height),Oi=k(Mi.format),Bi=k(Mi.type);for(S(Le.TEXTURE_CUBE_MAP,Mi,Di),Pi=0;6>Pi;Pi++)if(Ci)for(var Ni,Ui=Ai[Pi].mipmaps,Fi=0,Vi=Ui.length;Vi>Fi;Fi++)Ni=Ui[Fi],Mi.format!==THREE.RGBAFormat&&Mi.format!==THREE.RGBFormat?-1<Ze().indexOf(Oi)?Le.compressedTexImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+Pi,Fi,Oi,Ni.width,Ni.height,0,Ni.data):console.warn("Attempt to load unsupported compressed texture format"):Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+Pi,Fi,Oi,Ni.width,Ni.height,0,Oi,Bi,Ni.data);else Li?Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+Pi,0,Oi,Ai[Pi].width,Ai[Pi].height,0,Oi,Bi,Ai[Pi].data):Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+Pi,0,Oi,Oi,Bi,Ai[Pi]);Mi.generateMipmaps&&Di&&Le.generateMipmap(Le.TEXTURE_CUBE_MAP),Mi.needsUpdate=!1,Mi.onUpdate&&Mi.onUpdate()}else Le.activeTexture(Le.TEXTURE0+Si),Le.bindTexture(Le.TEXTURE_CUBE_MAP,Mi.image.__webglTextureCube)}else if(mi instanceof THREE.WebGLRenderTargetCube){var zi=mi;Le.activeTexture(Le.TEXTURE0+gi),Le.bindTexture(Le.TEXTURE_CUBE_MAP,zi.__webglTexture)}else te.setTexture(mi,gi);break;case"tv":for(void 0===Ti._array&&(Ti._array=[]),wi=0,Hi=Ti.value.length;Hi>wi;wi++)Ti._array[wi]=x();for(Le.uniform1iv(Ri,Ti._array),wi=0,Hi=Ti.value.length;Hi>wi;wi++)mi=Ti.value[wi],gi=Ti._array[wi],mi&&te.setTexture(mi,gi);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+xi)}}}}return Le.uniformMatrix4fv(ne.modelViewMatrix,!1,r._modelViewMatrix.elements),ne.normalMatrix&&Le.uniformMatrix3fv(ne.normalMatrix,!1,r._normalMatrix.elements),null!==ne.modelMatrix&&Le.uniformMatrix4fv(ne.modelMatrix,!1,r.matrixWorld.elements),Q}function T(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLightColor.needsUpdate=e,t.directionalLightDirection.needsUpdate=e,t.pointLightColor.needsUpdate=e,t.pointLightPosition.needsUpdate=e,t.pointLightDistance.needsUpdate=e,t.spotLightColor.needsUpdate=e,t.spotLightPosition.needsUpdate=e,t.spotLightDistance.needsUpdate=e,t.spotLightDirection.needsUpdate=e,t.spotLightAngleCos.needsUpdate=e,t.spotLightExponent.needsUpdate=e,t.hemisphereLightSkyColor.needsUpdate=e,t.hemisphereLightGroundColor.needsUpdate=e,t.hemisphereLightDirection.needsUpdate=e}function x(){var t=se;return t>=Ve&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+Ve),se+=1,t}function b(t,e){t._modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,t.matrixWorld),t._normalMatrix.getNormalMatrix(t._modelViewMatrix)}function R(t,e,i,n){t[e]=i.r*i.r*n,t[e+1]=i.g*i.g*n,t[e+2]=i.b*i.b*n}function w(t,e,i,n){t[e]=i.r*n,t[e+1]=i.g*n,t[e+2]=i.b*n}function H(t){t*=B,t!==ye&&(Le.lineWidth(t),ye=t)}function M(t,e,i){ge!==t&&(t?Le.enable(Le.POLYGON_OFFSET_FILL):Le.disable(Le.POLYGON_OFFSET_FILL),ge=t),!t||Ee===e&&ve===i||(Le.polygonOffset(e,i),Ee=e,ve=i)}function S(t,e,i){i?(Le.texParameteri(t,Le.TEXTURE_WRAP_S,k(e.wrapS)),Le.texParameteri(t,Le.TEXTURE_WRAP_T,k(e.wrapT)),Le.texParameteri(t,Le.TEXTURE_MAG_FILTER,k(e.magFilter)),Le.texParameteri(t,Le.TEXTURE_MIN_FILTER,k(e.minFilter))):(Le.texParameteri(t,Le.TEXTURE_WRAP_S,Le.CLAMP_TO_EDGE),Le.texParameteri(t,Le.TEXTURE_WRAP_T,Le.CLAMP_TO_EDGE),e.wrapS===THREE.ClampToEdgeWrapping&&e.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT is set to THREE.ClampToEdgeWrapping. ( "+e.sourceFile+" )"),Le.texParameteri(t,Le.TEXTURE_MAG_FILTER,P(e.magFilter)),Le.texParameteri(t,Le.TEXTURE_MIN_FILTER,P(e.minFilter)),e.minFilter!==THREE.NearestFilter&&e.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter is set to THREE.LinearFilter or THREE.NearestFilter. ( "+e.sourceFile+" )")),(i=Ne.get("EXT_texture_filter_anisotropic"))&&e.type!==THREE.FloatType&&(1<e.anisotropy||e.__oldAnisotropy)&&(Le.texParameterf(t,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,te.getMaxAnisotropy())),e.__oldAnisotropy=e.anisotropy)}function C(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElement("canvas");return n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.log("THREE.WebGLRenderer:",t,"is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height+"."),n}return t}function L(t,e){Le.bindRenderbuffer(Le.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(Le.renderbufferStorage(Le.RENDERBUFFER,Le.DEPTH_COMPONENT16,e.width,e.height),Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_ATTACHMENT,Le.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(Le.renderbufferStorage(Le.RENDERBUFFER,Le.DEPTH_STENCIL,e.width,e.height),Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_STENCIL_ATTACHMENT,Le.RENDERBUFFER,t)):Le.renderbufferStorage(Le.RENDERBUFFER,Le.RGBA4,e.width,e.height)}function A(t){t instanceof THREE.WebGLRenderTargetCube?(Le.bindTexture(Le.TEXTURE_CUBE_MAP,t.__webglTexture),Le.generateMipmap(Le.TEXTURE_CUBE_MAP),Le.bindTexture(Le.TEXTURE_CUBE_MAP,null)):(Le.bindTexture(Le.TEXTURE_2D,t.__webglTexture),Le.generateMipmap(Le.TEXTURE_2D),Le.bindTexture(Le.TEXTURE_2D,null))}function P(t){return t===THREE.NearestFilter||t===THREE.NearestMipMapNearestFilter||t===THREE.NearestMipMapLinearFilter?Le.NEAREST:Le.LINEAR}function k(t){var e;if(t===THREE.RepeatWrapping)return Le.REPEAT;if(t===THREE.ClampToEdgeWrapping)return Le.CLAMP_TO_EDGE;if(t===THREE.MirroredRepeatWrapping)return Le.MIRRORED_REPEAT;if(t===THREE.NearestFilter)return Le.NEAREST;if(t===THREE.NearestMipMapNearestFilter)return Le.NEAREST_MIPMAP_NEAREST;if(t===THREE.NearestMipMapLinearFilter)return Le.NEAREST_MIPMAP_LINEAR;if(t===THREE.LinearFilter)return Le.LINEAR;if(t===THREE.LinearMipMapNearestFilter)return Le.LINEAR_MIPMAP_NEAREST;if(t===THREE.LinearMipMapLinearFilter)return Le.LINEAR_MIPMAP_LINEAR;if(t===THREE.UnsignedByteType)return Le.UNSIGNED_BYTE;if(t===THREE.UnsignedShort4444Type)return Le.UNSIGNED_SHORT_4_4_4_4;if(t===THREE.UnsignedShort5551Type)return Le.UNSIGNED_SHORT_5_5_5_1;if(t===THREE.UnsignedShort565Type)return Le.UNSIGNED_SHORT_5_6_5;if(t===THREE.ByteType)return Le.BYTE;if(t===THREE.ShortType)return Le.SHORT;if(t===THREE.UnsignedShortType)return Le.UNSIGNED_SHORT;if(t===THREE.IntType)return Le.INT;if(t===THREE.UnsignedIntType)return Le.UNSIGNED_INT;if(t===THREE.FloatType)return Le.FLOAT;if(t===THREE.AlphaFormat)return Le.ALPHA;if(t===THREE.RGBFormat)return Le.RGB;if(t===THREE.RGBAFormat)return Le.RGBA;if(t===THREE.LuminanceFormat)return Le.LUMINANCE;if(t===THREE.LuminanceAlphaFormat)return Le.LUMINANCE_ALPHA;if(t===THREE.AddEquation)return Le.FUNC_ADD;if(t===THREE.SubtractEquation)return Le.FUNC_SUBTRACT;if(t===THREE.ReverseSubtractEquation)return Le.FUNC_REVERSE_SUBTRACT;if(t===THREE.ZeroFactor)return Le.ZERO;if(t===THREE.OneFactor)return Le.ONE;if(t===THREE.SrcColorFactor)return Le.SRC_COLOR;if(t===THREE.OneMinusSrcColorFactor)return Le.ONE_MINUS_SRC_COLOR;if(t===THREE.SrcAlphaFactor)return Le.SRC_ALPHA;if(t===THREE.OneMinusSrcAlphaFactor)return Le.ONE_MINUS_SRC_ALPHA;if(t===THREE.DstAlphaFactor)return Le.DST_ALPHA;if(t===THREE.OneMinusDstAlphaFactor)return Le.ONE_MINUS_DST_ALPHA;if(t===THREE.DstColorFactor)return Le.DST_COLOR;if(t===THREE.OneMinusDstColorFactor)return Le.ONE_MINUS_DST_COLOR;if(t===THREE.SrcAlphaSaturateFactor)return Le.SRC_ALPHA_SATURATE;if(e=Ne.get("WEBGL_compressed_texture_s3tc"),null!==e){if(t===THREE.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===THREE.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===THREE.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e=Ne.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(t===THREE.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===THREE.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===THREE.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===THREE.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e=Ne.get("EXT_blend_minmax"),null!==e){if(t===THREE.MinEquation)return e.MIN_EXT;if(t===THREE.MaxEquation)return e.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION),t=t||{};var D=void 0!==t.canvas?t.canvas:document.createElement("canvas"),O=void 0!==t.context?t.context:null,B=1,N=void 0!==t.precision?t.precision:"highp",U=void 0!==t.alpha?t.alpha:!1,F=void 0!==t.depth?t.depth:!0,V=void 0!==t.stencil?t.stencil:!0,z=void 0!==t.antialias?t.antialias:!1,I=void 0!==t.premultipliedAlpha?t.premultipliedAlpha:!0,j=void 0!==t.preserveDrawingBuffer?t.preserveDrawingBuffer:!1,G=void 0!==t.logarithmicDepthBuffer?t.logarithmicDepthBuffer:!1,W=new THREE.Color(0),q=0,X=[],Y={},$=[],Z=[],K=[],J=[],Q=[];this.domElement=D,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapCascade=this.shadowMapDebug=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var te=this,ee=[],ie=null,ne=null,re=-1,oe="",ae=null,se=0,he=-1,le=-1,ce=-1,ue=-1,de=-1,pe=-1,fe=-1,me=-1,ge=null,Ee=null,ve=null,ye=null,_e=0,Te=0,xe=D.width,be=D.height,Re=0,we=0,He=new Uint8Array(16),Me=new Uint8Array(16),Se=new THREE.Frustum,Ce=new THREE.Matrix4;new THREE.Matrix4;var Le,Ae=new THREE.Vector3,Pe=new THREE.Vector3,ke=!0,De={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var Oe={alpha:U,depth:F,stencil:V,antialias:z,premultipliedAlpha:I,preserveDrawingBuffer:j};if(Le=O||D.getContext("webgl",Oe)||D.getContext("experimental-webgl",Oe),null===Le){if(null!==D.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}D.addEventListener("webglcontextlost",function(t){t.preventDefault(),Fe(),Ue(),Y={}},!1)}catch(Be){console.error(Be)}void 0===Le.getShaderPrecisionFormat&&(Le.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var Ne=new THREE.WebGLExtensions(Le);Ne.get("OES_texture_float"),Ne.get("OES_texture_float_linear"),Ne.get("OES_standard_derivatives"),G&&Ne.get("EXT_frag_depth");var Ue=function(){Le.clearColor(0,0,0,1),Le.clearDepth(1),Le.clearStencil(0),Le.enable(Le.DEPTH_TEST),Le.depthFunc(Le.LEQUAL),Le.frontFace(Le.CCW),Le.cullFace(Le.BACK),Le.enable(Le.CULL_FACE),Le.enable(Le.BLEND),Le.blendEquation(Le.FUNC_ADD),Le.blendFunc(Le.SRC_ALPHA,Le.ONE_MINUS_SRC_ALPHA),Le.viewport(_e,Te,xe,be),Le.clearColor(W.r,W.g,W.b,q)},Fe=function(){ae=ie=null,le=he=me=fe=ce=-1,oe="",re=-1,ke=!0;for(var t=0;t<Me.length;t++)Me[t]=0};Ue(),this.context=Le;var Ve=Le.getParameter(Le.MAX_TEXTURE_IMAGE_UNITS),ze=Le.getParameter(Le.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ie=Le.getParameter(Le.MAX_TEXTURE_SIZE),je=Le.getParameter(Le.MAX_CUBE_MAP_TEXTURE_SIZE),Ge=ze>0,We=Ge&&Ne.get("OES_texture_float"),qe=Le.getShaderPrecisionFormat(Le.VERTEX_SHADER,Le.HIGH_FLOAT),Xe=Le.getShaderPrecisionFormat(Le.VERTEX_SHADER,Le.MEDIUM_FLOAT);Le.getShaderPrecisionFormat(Le.VERTEX_SHADER,Le.LOW_FLOAT);var Ye=Le.getShaderPrecisionFormat(Le.FRAGMENT_SHADER,Le.HIGH_FLOAT),$e=Le.getShaderPrecisionFormat(Le.FRAGMENT_SHADER,Le.MEDIUM_FLOAT);Le.getShaderPrecisionFormat(Le.FRAGMENT_SHADER,Le.LOW_FLOAT);var Ze=function(){var t;return function(){if(void 0!==t)return t;if(t=[],Ne.get("WEBGL_compressed_texture_pvrtc")||Ne.get("WEBGL_compressed_texture_s3tc"))for(var e=Le.getParameter(Le.COMPRESSED_TEXTURE_FORMATS),i=0;i<e.length;i++)t.push(e[i]);return t}}(),Ke=0<qe.precision&&0<Ye.precision,Je=0<Xe.precision&&0<$e.precision;"highp"!==N||Ke||(Je?(N="mediump",console.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(N="lowp",console.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==N||Je||(N="lowp",console.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var Qe=new THREE.ShadowMapPlugin(this,X,Y,$),ti=new THREE.SpritePlugin(this,J),ei=new THREE.LensFlarePlugin(this,Q);this.getContext=function(){return Le},this.forceContextLoss=function(){Ne.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return Ge},this.supportsFloatTextures=function(){return Ne.get("OES_texture_float")},this.supportsStandardDerivatives=function(){return Ne.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return Ne.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return Ne.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return Ne.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var t;return function(){if(void 0!==t)return t;var e=Ne.get("EXT_texture_filter_anisotropic");return t=null!==e?Le.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return N},this.getPixelRatio=function(){return B},this.setPixelRatio=function(t){B=t},this.setSize=function(t,e,i){D.width=t*B,D.height=e*B,!1!==i&&(D.style.width=t+"px",D.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,i,n){_e=t*B,Te=e*B,xe=i*B,be=n*B,Le.viewport(_e,Te,xe,be)},this.setScissor=function(t,e,i,n){Le.scissor(t*B,e*B,i*B,n*B)},this.enableScissorTest=function(t){t?Le.enable(Le.SCISSOR_TEST):Le.disable(Le.SCISSOR_TEST)},this.getClearColor=function(){return W},this.setClearColor=function(t,e){W.set(t),q=void 0!==e?e:1,Le.clearColor(W.r,W.g,W.b,q)},this.getClearAlpha=function(){return q},this.setClearAlpha=function(t){q=t,Le.clearColor(W.r,W.g,W.b,q)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=Le.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=Le.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Le.STENCIL_BUFFER_BIT),Le.clear(n)},this.clearColor=function(){Le.clear(Le.COLOR_BUFFER_BIT)},this.clearDepth=function(){Le.clear(Le.DEPTH_BUFFER_BIT)},this.clearStencil=function(){Le.clear(Le.STENCIL_BUFFER_BIT)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.resetGLState=Fe;var ii=function(t){t.target.traverse(function(t){if(t.removeEventListener("remove",ii),t instanceof THREE.Mesh||t instanceof THREE.PointCloud||t instanceof THREE.Line)delete Y[t.id];
else if(t instanceof THREE.ImmediateRenderObject||t.immediateRenderCallback)for(var e=$,i=e.length-1;i>=0;i--)e[i].object===t&&e.splice(i,1);delete t.__webglInit,delete t._modelViewMatrix,delete t._normalMatrix,delete t.__webglActive})},ni=function(t){if(t=t.target,t.removeEventListener("dispose",ni),delete t.__webglInit,t instanceof THREE.BufferGeometry){for(var e in t.attributes){var i=t.attributes[e];void 0!==i.buffer&&(Le.deleteBuffer(i.buffer),delete i.buffer)}te.info.memory.geometries--}else if(e=li[t.id],void 0!==e){for(var i=0,n=e.length;n>i;i++){var r=e[i];if(void 0!==r.numMorphTargets){for(var o=0,a=r.numMorphTargets;a>o;o++)Le.deleteBuffer(r.__webglMorphTargetsBuffers[o]);delete r.__webglMorphTargetsBuffers}if(void 0!==r.numMorphNormals){for(o=0,a=r.numMorphNormals;a>o;o++)Le.deleteBuffer(r.__webglMorphNormalsBuffers[o]);delete r.__webglMorphNormalsBuffers}si(r)}delete li[t.id]}else si(t);oe=""},ri=function(t){t=t.target,t.removeEventListener("dispose",ri),t.image&&t.image.__webglTextureCube?(Le.deleteTexture(t.image.__webglTextureCube),delete t.image.__webglTextureCube):void 0!==t.__webglInit&&(Le.deleteTexture(t.__webglTexture),delete t.__webglTexture,delete t.__webglInit),te.info.memory.textures--},oi=function(t){if(t=t.target,t.removeEventListener("dispose",oi),t&&void 0!==t.__webglTexture){if(Le.deleteTexture(t.__webglTexture),delete t.__webglTexture,t instanceof THREE.WebGLRenderTargetCube)for(var e=0;6>e;e++)Le.deleteFramebuffer(t.__webglFramebuffer[e]),Le.deleteRenderbuffer(t.__webglRenderbuffer[e]);else Le.deleteFramebuffer(t.__webglFramebuffer),Le.deleteRenderbuffer(t.__webglRenderbuffer);delete t.__webglFramebuffer,delete t.__webglRenderbuffer}te.info.memory.textures--},ai=function(t){t=t.target,t.removeEventListener("dispose",ai),hi(t)},si=function(t){for(var e="__webglVertexBuffer __webglNormalBuffer __webglTangentBuffer __webglColorBuffer __webglUVBuffer __webglUV2Buffer __webglSkinIndicesBuffer __webglSkinWeightsBuffer __webglFaceBuffer __webglLineBuffer __webglLineDistanceBuffer".split(" "),i=0,n=e.length;n>i;i++){var r=e[i];void 0!==t[r]&&(Le.deleteBuffer(t[r]),delete t[r])}if(void 0!==t.__webglCustomAttributesList){for(r in t.__webglCustomAttributesList)Le.deleteBuffer(t.__webglCustomAttributesList[r].buffer);delete t.__webglCustomAttributesList}te.info.memory.geometries--},hi=function(t){var e=t.program.program;if(void 0!==e){t.program=void 0;var i,n,r=!1;for(t=0,i=ee.length;i>t;t++)if(n=ee[t],n.program===e){n.usedTimes--,0===n.usedTimes&&(r=!0);break}if(!0===r){for(r=[],t=0,i=ee.length;i>t;t++)n=ee[t],n.program!==e&&r.push(n);ee=r,Le.deleteProgram(e),te.info.memory.programs--}}};this.renderBufferImmediate=function(t,e,i){if(o(),t.hasPositions&&!t.__webglVertexBuffer&&(t.__webglVertexBuffer=Le.createBuffer()),t.hasNormals&&!t.__webglNormalBuffer&&(t.__webglNormalBuffer=Le.createBuffer()),t.hasUvs&&!t.__webglUvBuffer&&(t.__webglUvBuffer=Le.createBuffer()),t.hasColors&&!t.__webglColorBuffer&&(t.__webglColorBuffer=Le.createBuffer()),t.hasPositions&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglVertexBuffer),Le.bufferData(Le.ARRAY_BUFFER,t.positionArray,Le.DYNAMIC_DRAW),a(e.attributes.position),Le.vertexAttribPointer(e.attributes.position,3,Le.FLOAT,!1,0,0)),t.hasNormals){if(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglNormalBuffer),i.shading===THREE.FlatShading){var n,r,h,l,c,u,d,p,f,m,g,E=3*t.count;for(g=0;E>g;g+=9)m=t.normalArray,n=m[g],r=m[g+1],h=m[g+2],l=m[g+3],u=m[g+4],p=m[g+5],c=m[g+6],d=m[g+7],f=m[g+8],n=(n+l+c)/3,r=(r+u+d)/3,h=(h+p+f)/3,m[g]=n,m[g+1]=r,m[g+2]=h,m[g+3]=n,m[g+4]=r,m[g+5]=h,m[g+6]=n,m[g+7]=r,m[g+8]=h}Le.bufferData(Le.ARRAY_BUFFER,t.normalArray,Le.DYNAMIC_DRAW),a(e.attributes.normal),Le.vertexAttribPointer(e.attributes.normal,3,Le.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglUvBuffer),Le.bufferData(Le.ARRAY_BUFFER,t.uvArray,Le.DYNAMIC_DRAW),a(e.attributes.uv),Le.vertexAttribPointer(e.attributes.uv,2,Le.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==THREE.NoColors&&(Le.bindBuffer(Le.ARRAY_BUFFER,t.__webglColorBuffer),Le.bufferData(Le.ARRAY_BUFFER,t.colorArray,Le.DYNAMIC_DRAW),a(e.attributes.color),Le.vertexAttribPointer(e.attributes.color,3,Le.FLOAT,!1,0,0)),s(),Le.drawArrays(Le.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,a,s){if(!1!==n.visible)if(E(s),t=_(t,e,i,n,s),e=!1,i="direct_"+a.id+"_"+t.id+"_"+(n.wireframe?1:0),i!==oe&&(oe=i,e=!0),e&&o(),s instanceof THREE.Mesh){s=!0===n.wireframe?Le.LINES:Le.TRIANGLES;var h=a.attributes.index;if(h){var l,c;if(h.array instanceof Uint32Array&&Ne.get("OES_element_index_uint")?(l=Le.UNSIGNED_INT,c=4):(l=Le.UNSIGNED_SHORT,c=2),i=a.offsets,0===i.length)e&&(r(n,t,a,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,h.array.length,l,0),te.info.render.calls++,te.info.render.vertices+=h.array.length,te.info.render.faces+=h.array.length/3;else{e=!0;for(var u=0,d=i.length;d>u;u++){var p=i[u].index;e&&(r(n,t,a,p),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,i[u].count,l,i[u].start*c),te.info.render.calls++,te.info.render.vertices+=i[u].count,te.info.render.faces+=i[u].count/3}}}else e&&r(n,t,a,0),n=a.attributes.position,Le.drawArrays(s,0,n.array.length/3),te.info.render.calls++,te.info.render.vertices+=n.array.length/3,te.info.render.faces+=n.array.length/9}else if(s instanceof THREE.PointCloud)if(s=Le.POINTS,h=a.attributes.index)if(h.array instanceof Uint32Array&&Ne.get("OES_element_index_uint")?(l=Le.UNSIGNED_INT,c=4):(l=Le.UNSIGNED_SHORT,c=2),i=a.offsets,0===i.length)e&&(r(n,t,a,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,h.array.length,l,0),te.info.render.calls++,te.info.render.points+=h.array.length;else for(1<i.length&&(e=!0),u=0,d=i.length;d>u;u++)p=i[u].index,e&&(r(n,t,a,p),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,i[u].count,l,i[u].start*c),te.info.render.calls++,te.info.render.points+=i[u].count;else if(e&&r(n,t,a,0),n=a.attributes.position,i=a.offsets,0===i.length)Le.drawArrays(s,0,n.array.length/3),te.info.render.calls++,te.info.render.points+=n.array.length/3;else for(u=0,d=i.length;d>u;u++)Le.drawArrays(s,i[u].index,i[u].count),te.info.render.calls++,te.info.render.points+=i[u].count;else if(s instanceof THREE.Line)if(s=s.mode===THREE.LineStrip?Le.LINE_STRIP:Le.LINES,H(n.linewidth),h=a.attributes.index)if(h.array instanceof Uint32Array?(l=Le.UNSIGNED_INT,c=4):(l=Le.UNSIGNED_SHORT,c=2),i=a.offsets,0===i.length)e&&(r(n,t,a,0),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,h.array.length,l,0),te.info.render.calls++,te.info.render.vertices+=h.array.length;else for(1<i.length&&(e=!0),u=0,d=i.length;d>u;u++)p=i[u].index,e&&(r(n,t,a,p),Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,h.buffer)),Le.drawElements(s,i[u].count,l,i[u].start*c),te.info.render.calls++,te.info.render.vertices+=i[u].count;else if(e&&r(n,t,a,0),n=a.attributes.position,i=a.offsets,0===i.length)Le.drawArrays(s,0,n.array.length/3),te.info.render.calls++,te.info.render.vertices+=n.array.length/3;else for(u=0,d=i.length;d>u;u++)Le.drawArrays(s,i[u].index,i[u].count),te.info.render.calls++,te.info.render.vertices+=i[u].count},this.renderBuffer=function(t,e,i,n,r,h){if(!1!==n.visible){if(E(h),i=_(t,e,i,n,h),e=i.attributes,t=!1,i=r.id+"_"+i.id+"_"+(n.wireframe?1:0),i!==oe&&(oe=i,t=!0),t&&o(),!n.morphTargets&&0<=e.position)t&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglVertexBuffer),a(e.position),Le.vertexAttribPointer(e.position,3,Le.FLOAT,!1,0,0));else if(h.morphTargetBase){if(i=n.program.attributes,-1!==h.morphTargetBase&&0<=i.position?(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[h.morphTargetBase]),a(i.position),Le.vertexAttribPointer(i.position,3,Le.FLOAT,!1,0,0)):0<=i.position&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglVertexBuffer),a(i.position),Le.vertexAttribPointer(i.position,3,Le.FLOAT,!1,0,0)),h.morphTargetForcedOrder.length)for(var l,u=0,d=h.morphTargetForcedOrder,p=h.morphTargetInfluences;u<n.numSupportedMorphTargets&&u<d.length;)l=i["morphTarget"+u],l>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[d[u]]),a(l),Le.vertexAttribPointer(l,3,Le.FLOAT,!1,0,0)),l=i["morphNormal"+u],l>=0&&n.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglMorphNormalsBuffers[d[u]]),a(l),Le.vertexAttribPointer(l,3,Le.FLOAT,!1,0,0)),h.__webglMorphTargetInfluences[u]=p[d[u]],u++;else{for(d=[],p=h.morphTargetInfluences,u=0,l=p.length;l>u;u++)d.push([p[u],u]);d.length>n.numSupportedMorphTargets?(d.sort(c),d.length=n.numSupportedMorphTargets):d.length>n.numSupportedMorphNormals?d.sort(c):0===d.length&&d.push([0,0]);for(var u=0,f=n.numSupportedMorphTargets;f>u;u++)if(d[u]){var m=d[u][1];l=i["morphTarget"+u],l>=0&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[m]),a(l),Le.vertexAttribPointer(l,3,Le.FLOAT,!1,0,0)),l=i["morphNormal"+u],l>=0&&n.morphNormals&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglMorphNormalsBuffers[m]),a(l),Le.vertexAttribPointer(l,3,Le.FLOAT,!1,0,0)),h.__webglMorphTargetInfluences[u]=p[m]}else h.__webglMorphTargetInfluences[u]=0}null!==n.program.uniforms.morphTargetInfluences&&Le.uniform1fv(n.program.uniforms.morphTargetInfluences,h.__webglMorphTargetInfluences)}if(t){if(r.__webglCustomAttributesList)for(i=0,p=r.__webglCustomAttributesList.length;p>i;i++)d=r.__webglCustomAttributesList[i],0<=e[d.buffer.belongsToAttribute]&&(Le.bindBuffer(Le.ARRAY_BUFFER,d.buffer),a(e[d.buffer.belongsToAttribute]),Le.vertexAttribPointer(e[d.buffer.belongsToAttribute],d.size,Le.FLOAT,!1,0,0));0<=e.color&&(0<h.geometry.colors.length||0<h.geometry.faces.length?(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglColorBuffer),a(e.color),Le.vertexAttribPointer(e.color,3,Le.FLOAT,!1,0,0)):void 0!==n.defaultAttributeValues&&Le.vertexAttrib3fv(e.color,n.defaultAttributeValues.color)),0<=e.normal&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglNormalBuffer),a(e.normal),Le.vertexAttribPointer(e.normal,3,Le.FLOAT,!1,0,0)),0<=e.tangent&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglTangentBuffer),a(e.tangent),Le.vertexAttribPointer(e.tangent,4,Le.FLOAT,!1,0,0)),0<=e.uv&&(h.geometry.faceVertexUvs[0]?(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglUVBuffer),a(e.uv),Le.vertexAttribPointer(e.uv,2,Le.FLOAT,!1,0,0)):void 0!==n.defaultAttributeValues&&Le.vertexAttrib2fv(e.uv,n.defaultAttributeValues.uv)),0<=e.uv2&&(h.geometry.faceVertexUvs[1]?(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglUV2Buffer),a(e.uv2),Le.vertexAttribPointer(e.uv2,2,Le.FLOAT,!1,0,0)):void 0!==n.defaultAttributeValues&&Le.vertexAttrib2fv(e.uv2,n.defaultAttributeValues.uv2)),n.skinning&&0<=e.skinIndex&&0<=e.skinWeight&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),a(e.skinIndex),Le.vertexAttribPointer(e.skinIndex,4,Le.FLOAT,!1,0,0),Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),a(e.skinWeight),Le.vertexAttribPointer(e.skinWeight,4,Le.FLOAT,!1,0,0)),0<=e.lineDistance&&(Le.bindBuffer(Le.ARRAY_BUFFER,r.__webglLineDistanceBuffer),a(e.lineDistance),Le.vertexAttribPointer(e.lineDistance,1,Le.FLOAT,!1,0,0))}s(),h instanceof THREE.Mesh?(h=r.__typeArray===Uint32Array?Le.UNSIGNED_INT:Le.UNSIGNED_SHORT,n.wireframe?(H(n.wireframeLinewidth),t&&Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),Le.drawElements(Le.LINES,r.__webglLineCount,h,0)):(t&&Le.bindBuffer(Le.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),Le.drawElements(Le.TRIANGLES,r.__webglFaceCount,h,0)),te.info.render.calls++,te.info.render.vertices+=r.__webglFaceCount,te.info.render.faces+=r.__webglFaceCount/3):h instanceof THREE.Line?(h=h.mode===THREE.LineStrip?Le.LINE_STRIP:Le.LINES,H(n.linewidth),Le.drawArrays(h,0,r.__webglLineCount),te.info.render.calls++):h instanceof THREE.PointCloud&&(Le.drawArrays(Le.POINTS,0,r.__webglParticleCount),te.info.render.calls++,te.info.render.points+=r.__webglParticleCount)}},this.render=function(t,e,i,n){if(!1==e instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var r=t.fog;oe="",re=-1,ae=null,ke=!0,!0===t.autoUpdate&&t.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),t.traverse(function(t){t instanceof THREE.SkinnedMesh&&t.skeleton.update()}),e.matrixWorldInverse.getInverse(e.matrixWorld),Ce.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Se.setFromMatrix(Ce),X.length=0,Z.length=0,K.length=0,J.length=0,Q.length=0,u(t),!0===te.sortObjects&&(Z.sort(h),K.sort(l)),Qe.render(t,e),te.info.render.calls=0,te.info.render.vertices=0,te.info.render.faces=0,te.info.render.points=0,this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),n=0;for(var o=$.length;o>n;n++){var a=$[n],s=a.object;s.visible&&(b(s,e),f(a))}t.overrideMaterial?(n=t.overrideMaterial,this.setBlending(n.blending,n.blendEquation,n.blendSrc,n.blendDst),this.setDepthTest(n.depthTest),this.setDepthWrite(n.depthWrite),M(n.polygonOffset,n.polygonOffsetFactor,n.polygonOffsetUnits),d(Z,e,X,r,!0,n),d(K,e,X,r,!0,n),p($,"",e,X,r,!1,n)):(n=null,this.setBlending(THREE.NoBlending),d(Z,e,X,r,!1,n),p($,"opaque",e,X,r,!1,n),d(K,e,X,r,!0,n),p($,"transparent",e,X,r,!0,n)),ti.render(t,e),ei.render(t,e,Re,we),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&A(i),this.setDepthTest(!0),this.setDepthWrite(!0)}},this.renderImmediateObject=function(t,e,i,n,r){var o=_(t,e,i,n,r);oe="",te.setMaterialFaces(n),r.immediateRenderCallback?r.immediateRenderCallback(o,Le,Se):r.render(function(t){te.renderBufferImmediate(t,o,n)})};var li={},ci=0,ui={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(t,e){t===THREE.CullFaceNone?Le.disable(Le.CULL_FACE):(Le.frontFace(e===THREE.FrontFaceDirectionCW?Le.CW:Le.CCW),Le.cullFace(t===THREE.CullFaceBack?Le.BACK:t===THREE.CullFaceFront?Le.FRONT:Le.FRONT_AND_BACK),Le.enable(Le.CULL_FACE))},this.setMaterialFaces=function(t){var e=t.side===THREE.DoubleSide;t=t.side===THREE.BackSide,he!==e&&(e?Le.disable(Le.CULL_FACE):Le.enable(Le.CULL_FACE),he=e),le!==t&&(Le.frontFace(t?Le.CW:Le.CCW),le=t)},this.setDepthTest=function(t){fe!==t&&(t?Le.enable(Le.DEPTH_TEST):Le.disable(Le.DEPTH_TEST),fe=t)},this.setDepthWrite=function(t){me!==t&&(Le.depthMask(t),me=t)},this.setBlending=function(t,e,i,n){t!==ce&&(t===THREE.NoBlending?Le.disable(Le.BLEND):t===THREE.AdditiveBlending?(Le.enable(Le.BLEND),Le.blendEquation(Le.FUNC_ADD),Le.blendFunc(Le.SRC_ALPHA,Le.ONE)):t===THREE.SubtractiveBlending?(Le.enable(Le.BLEND),Le.blendEquation(Le.FUNC_ADD),Le.blendFunc(Le.ZERO,Le.ONE_MINUS_SRC_COLOR)):t===THREE.MultiplyBlending?(Le.enable(Le.BLEND),Le.blendEquation(Le.FUNC_ADD),Le.blendFunc(Le.ZERO,Le.SRC_COLOR)):t===THREE.CustomBlending?Le.enable(Le.BLEND):(Le.enable(Le.BLEND),Le.blendEquationSeparate(Le.FUNC_ADD,Le.FUNC_ADD),Le.blendFuncSeparate(Le.SRC_ALPHA,Le.ONE_MINUS_SRC_ALPHA,Le.ONE,Le.ONE_MINUS_SRC_ALPHA)),ce=t),t===THREE.CustomBlending?(e!==ue&&(Le.blendEquation(k(e)),ue=e),(i!==de||n!==pe)&&(Le.blendFunc(k(i),k(n)),de=i,pe=n)):pe=de=ue=null},this.uploadTexture=function(t){void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",ri),t.__webglTexture=Le.createTexture(),te.info.memory.textures++),Le.bindTexture(Le.TEXTURE_2D,t.__webglTexture),Le.pixelStorei(Le.UNPACK_FLIP_Y_WEBGL,t.flipY),Le.pixelStorei(Le.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Le.pixelStorei(Le.UNPACK_ALIGNMENT,t.unpackAlignment),t.image=C(t.image,Ie);var e=t.image,i=THREE.Math.isPowerOfTwo(e.width)&&THREE.Math.isPowerOfTwo(e.height),n=k(t.format),r=k(t.type);S(Le.TEXTURE_2D,t,i);var o=t.mipmaps;if(t instanceof THREE.DataTexture)if(0<o.length&&i){for(var a=0,s=o.length;s>a;a++)e=o[a],Le.texImage2D(Le.TEXTURE_2D,a,n,e.width,e.height,0,n,r,e.data);t.generateMipmaps=!1}else Le.texImage2D(Le.TEXTURE_2D,0,n,e.width,e.height,0,n,r,e.data);else if(t instanceof THREE.CompressedTexture)for(a=0,s=o.length;s>a;a++)e=o[a],t.format!==THREE.RGBAFormat&&t.format!==THREE.RGBFormat?-1<Ze().indexOf(n)?Le.compressedTexImage2D(Le.TEXTURE_2D,a,n,e.width,e.height,0,e.data):console.warn("Attempt to load unsupported compressed texture format"):Le.texImage2D(Le.TEXTURE_2D,a,n,e.width,e.height,0,n,r,e.data);else if(0<o.length&&i){for(a=0,s=o.length;s>a;a++)e=o[a],Le.texImage2D(Le.TEXTURE_2D,a,n,n,r,e);t.generateMipmaps=!1}else Le.texImage2D(Le.TEXTURE_2D,0,n,n,r,t.image);t.generateMipmaps&&i&&Le.generateMipmap(Le.TEXTURE_2D),t.needsUpdate=!1,t.onUpdate&&t.onUpdate()},this.setTexture=function(t,e){Le.activeTexture(Le.TEXTURE0+e),t.needsUpdate?te.uploadTexture(t):Le.bindTexture(Le.TEXTURE_2D,t.__webglTexture)},this.setRenderTarget=function(t){var e=t instanceof THREE.WebGLRenderTargetCube;if(t&&void 0===t.__webglFramebuffer){void 0===t.depthBuffer&&(t.depthBuffer=!0),void 0===t.stencilBuffer&&(t.stencilBuffer=!0),t.addEventListener("dispose",oi),t.__webglTexture=Le.createTexture(),te.info.memory.textures++;var i=THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height),n=k(t.format),r=k(t.type);if(e){t.__webglFramebuffer=[],t.__webglRenderbuffer=[],Le.bindTexture(Le.TEXTURE_CUBE_MAP,t.__webglTexture),S(Le.TEXTURE_CUBE_MAP,t,i);for(var o=0;6>o;o++){t.__webglFramebuffer[o]=Le.createFramebuffer(),t.__webglRenderbuffer[o]=Le.createRenderbuffer(),Le.texImage2D(Le.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,n,t.width,t.height,0,n,r,null);var a=t,s=Le.TEXTURE_CUBE_MAP_POSITIVE_X+o;Le.bindFramebuffer(Le.FRAMEBUFFER,t.__webglFramebuffer[o]),Le.framebufferTexture2D(Le.FRAMEBUFFER,Le.COLOR_ATTACHMENT0,s,a.__webglTexture,0),L(t.__webglRenderbuffer[o],t)}i&&Le.generateMipmap(Le.TEXTURE_CUBE_MAP)}else t.__webglFramebuffer=Le.createFramebuffer(),t.__webglRenderbuffer=t.shareDepthFrom?t.shareDepthFrom.__webglRenderbuffer:Le.createRenderbuffer(),Le.bindTexture(Le.TEXTURE_2D,t.__webglTexture),S(Le.TEXTURE_2D,t,i),Le.texImage2D(Le.TEXTURE_2D,0,n,t.width,t.height,0,n,r,null),n=Le.TEXTURE_2D,Le.bindFramebuffer(Le.FRAMEBUFFER,t.__webglFramebuffer),Le.framebufferTexture2D(Le.FRAMEBUFFER,Le.COLOR_ATTACHMENT0,n,t.__webglTexture,0),t.shareDepthFrom?t.depthBuffer&&!t.stencilBuffer?Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_ATTACHMENT,Le.RENDERBUFFER,t.__webglRenderbuffer):t.depthBuffer&&t.stencilBuffer&&Le.framebufferRenderbuffer(Le.FRAMEBUFFER,Le.DEPTH_STENCIL_ATTACHMENT,Le.RENDERBUFFER,t.__webglRenderbuffer):L(t.__webglRenderbuffer,t),i&&Le.generateMipmap(Le.TEXTURE_2D);e?Le.bindTexture(Le.TEXTURE_CUBE_MAP,null):Le.bindTexture(Le.TEXTURE_2D,null),Le.bindRenderbuffer(Le.RENDERBUFFER,null),Le.bindFramebuffer(Le.FRAMEBUFFER,null)}t?(e=e?t.__webglFramebuffer[t.activeCubeFace]:t.__webglFramebuffer,i=t.width,t=t.height,r=n=0):(e=null,i=xe,t=be,n=_e,r=Te),e!==ne&&(Le.bindFramebuffer(Le.FRAMEBUFFER,e),Le.viewport(n,r,i,t),ne=e),Re=i,we=t},this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},THREE.WebGLRenderTarget=function(t,e,i){this.width=t,this.height=e,i=i||{},this.wrapS=void 0!==i.wrapS?i.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i.wrapT?i.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i.magFilter?i.magFilter:THREE.LinearFilter,this.minFilter=void 0!==i.minFilter?i.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==i.format?i.format:THREE.RGBAFormat,this.type=void 0!==i.type?i.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==i.depthBuffer?i.depthBuffer:!0,this.stencilBuffer=void 0!==i.stencilBuffer?i.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(t,e){this.width=t,this.height=e},clone:function(){var t=new THREE.WebGLRenderTarget(this.width,this.height);return t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.format=this.format,t.type=this.type,t.depthBuffer=this.depthBuffer,t.stencilBuffer=this.stencilBuffer,t.generateMipmaps=this.generateMipmaps,t.shareDepthFrom=this.shareDepthFrom,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(t,e,i){THREE.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.WebGLExtensions=function(t){var e={};this.get=function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return null===n&&console.log("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n}},THREE.WebGLProgram=function(){var t=0;return function(e,i,n,r){var o=e.context,a=n.defines,s=n.__webglShader.uniforms,h=n.attributes,l=n.__webglShader.vertexShader,c=n.__webglShader.fragmentShader,u=n.index0AttributeName;void 0===u&&!0===r.morphTargets&&(u="position");var d="SHADOWMAP_TYPE_BASIC";r.shadowMapType===THREE.PCFShadowMap?d="SHADOWMAP_TYPE_PCF":r.shadowMapType===THREE.PCFSoftShadowMap&&(d="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(n.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:p="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:p="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:p="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case THREE.MultiplyOperation:m="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:m="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:m="ENVMAP_BLENDING_ADD"}}var g,E;g=[];for(var v in a)E=a[v],!1!==E&&(E="#define "+v+" "+E,g.push(E));g=g.join("\n"),a=o.createProgram(),n instanceof THREE.RawShaderMaterial?e=n="":(n=["precision "+r.precision+" float;","precision "+r.precision+" int;",g,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",e.gammaInput?"#define GAMMA_INPUT":"",e.gammaOutput?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,"#define MAX_BONES "+r.maxBones,r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+f:"",r.lightMap?"#define USE_LIGHTMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals?"#define USE_MORPHNORMALS":"",r.wrapAround?"#define WRAP_AROUND":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\n	attribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\n	attribute vec3 morphTarget0;\n	attribute vec3 morphTarget1;\n	attribute vec3 morphTarget2;\n	attribute vec3 morphTarget3;\n	#ifdef USE_MORPHNORMALS\n		attribute vec3 morphNormal0;\n		attribute vec3 morphNormal1;\n		attribute vec3 morphNormal2;\n		attribute vec3 morphNormal3;\n	#else\n		attribute vec3 morphTarget4;\n		attribute vec3 morphTarget5;\n		attribute vec3 morphTarget6;\n		attribute vec3 morphTarget7;\n	#endif\n#endif\n#ifdef USE_SKINNING\n	attribute vec4 skinIndex;\n	attribute vec4 skinWeight;\n#endif\n"].join("\n"),e=["precision "+r.precision+" float;","precision "+r.precision+" int;",r.bumpMap||r.normalMap?"#extension GL_OES_standard_derivatives : enable":"",g,"#define MAX_DIR_LIGHTS "+r.maxDirLights,"#define MAX_POINT_LIGHTS "+r.maxPointLights,"#define MAX_SPOT_LIGHTS "+r.maxSpotLights,"#define MAX_HEMI_LIGHTS "+r.maxHemiLights,"#define MAX_SHADOWS "+r.maxShadows,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"",e.gammaInput?"#define GAMMA_INPUT":"",e.gammaOutput?"#define GAMMA_OUTPUT":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",r.envMap?"#define "+m:"",r.lightMap?"#define USE_LIGHTMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.metal?"#define METAL":"",r.wrapAround?"#define WRAP_AROUND":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+d:"",r.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",r.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n")),l=new THREE.WebGLShader(o,o.VERTEX_SHADER,n+l),c=new THREE.WebGLShader(o,o.FRAGMENT_SHADER,e+c),o.attachShader(a,l),o.attachShader(a,c),void 0!==u&&o.bindAttribLocation(a,0,u),o.linkProgram(a),!1===o.getProgramParameter(a,o.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",o.getProgramParameter(a,o.VALIDATE_STATUS)),console.error("gl.getError()",o.getError())),""!==o.getProgramInfoLog(a)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",o.getProgramInfoLog(a)),o.deleteShader(l),o.deleteShader(c),u="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences bindMatrix bindMatrixInverse".split(" "),r.useVertexTexture?(u.push("boneTexture"),u.push("boneTextureWidth"),u.push("boneTextureHeight")):u.push("boneGlobalMatrices"),r.logarithmicDepthBuffer&&u.push("logDepthBufFC");for(var y in s)u.push(y);for(s=u,y={},u=0,e=s.length;e>u;u++)d=s[u],y[d]=o.getUniformLocation(a,d);for(this.uniforms=y,u="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" "),s=0;s<r.maxMorphTargets;s++)u.push("morphTarget"+s);for(s=0;s<r.maxMorphNormals;s++)u.push("morphNormal"+s);for(var _ in h)u.push(_);for(r=u,h={},_=0,s=r.length;s>_;_++)y=r[_],h[y]=o.getAttribLocation(a,y);return this.attributes=h,this.attributesKeys=Object.keys(this.attributes),this.id=t++,this.code=i,this.usedTimes=1,this.program=a,this.vertexShader=l,this.fragmentShader=c,this}}(),THREE.WebGLShader=function(){var t=function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")};return function(e,i,n){return i=e.createShader(i),e.shaderSource(i,n),e.compileShader(i),!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&(console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(i)),console.warn(t(n))),i}}(),THREE.LensFlarePlugin=function(t,e){var i,n,r,o,a,s,h,l,c,u,d,p,f,m,g,E,v=t.context;this.render=function(y,_,T,x){if(0!==e.length){y=new THREE.Vector3;var b=x/T,R=.5*T,w=.5*x,H=16/x,M=new THREE.Vector2(H*b,H),S=new THREE.Vector3(1,1,0),C=new THREE.Vector2(1,1);if(void 0===f){var H=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),L=new Uint16Array([0,1,2,0,2,3]);d=v.createBuffer(),p=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,d),v.bufferData(v.ARRAY_BUFFER,H,v.STATIC_DRAW),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,p),v.bufferData(v.ELEMENT_ARRAY_BUFFER,L,v.STATIC_DRAW),g=v.createTexture(),E=v.createTexture(),v.bindTexture(v.TEXTURE_2D,g),v.texImage2D(v.TEXTURE_2D,0,v.RGB,16,16,0,v.RGB,v.UNSIGNED_BYTE,null),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.bindTexture(v.TEXTURE_2D,E),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,16,16,0,v.RGBA,v.UNSIGNED_BYTE,null),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST);var H=(m=0<v.getParameter(v.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},L=v.createProgram(),A=v.createShader(v.FRAGMENT_SHADER),P=v.createShader(v.VERTEX_SHADER),k="precision "+t.getPrecision()+" float;\n";
v.shaderSource(A,k+H.fragmentShader),v.shaderSource(P,k+H.vertexShader),v.compileShader(A),v.compileShader(P),v.attachShader(L,A),v.attachShader(L,P),v.linkProgram(L),f=L,c=v.getAttribLocation(f,"position"),u=v.getAttribLocation(f,"uv"),i=v.getUniformLocation(f,"renderType"),n=v.getUniformLocation(f,"map"),r=v.getUniformLocation(f,"occlusionMap"),o=v.getUniformLocation(f,"opacity"),a=v.getUniformLocation(f,"color"),s=v.getUniformLocation(f,"scale"),h=v.getUniformLocation(f,"rotation"),l=v.getUniformLocation(f,"screenPosition")}for(v.useProgram(f),v.enableVertexAttribArray(c),v.enableVertexAttribArray(u),v.uniform1i(r,0),v.uniform1i(n,1),v.bindBuffer(v.ARRAY_BUFFER,d),v.vertexAttribPointer(c,2,v.FLOAT,!1,16,0),v.vertexAttribPointer(u,2,v.FLOAT,!1,16,8),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,p),v.disable(v.CULL_FACE),v.depthMask(!1),L=0,A=e.length;A>L;L++)if(H=16/x,M.set(H*b,H),P=e[L],y.set(P.matrixWorld.elements[12],P.matrixWorld.elements[13],P.matrixWorld.elements[14]),y.applyMatrix4(_.matrixWorldInverse),y.applyProjection(_.projectionMatrix),S.copy(y),C.x=S.x*R+R,C.y=S.y*w+w,m||0<C.x&&C.x<T&&0<C.y&&C.y<x){v.activeTexture(v.TEXTURE1),v.bindTexture(v.TEXTURE_2D,g),v.copyTexImage2D(v.TEXTURE_2D,0,v.RGB,C.x-8,C.y-8,16,16,0),v.uniform1i(i,0),v.uniform2f(s,M.x,M.y),v.uniform3f(l,S.x,S.y,S.z),v.disable(v.BLEND),v.enable(v.DEPTH_TEST),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,E),v.copyTexImage2D(v.TEXTURE_2D,0,v.RGBA,C.x-8,C.y-8,16,16,0),v.uniform1i(i,1),v.disable(v.DEPTH_TEST),v.activeTexture(v.TEXTURE1),v.bindTexture(v.TEXTURE_2D,g),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0),P.positionScreen.copy(S),P.customUpdateCallback?P.customUpdateCallback(P):P.updateLensFlares(),v.uniform1i(i,2),v.enable(v.BLEND);for(var k=0,D=P.lensFlares.length;D>k;k++){var O=P.lensFlares[k];.001<O.opacity&&.001<O.scale&&(S.x=O.x,S.y=O.y,S.z=O.z,H=O.size*O.scale/x,M.x=H*b,M.y=H,v.uniform3f(l,S.x,S.y,S.z),v.uniform2f(s,M.x,M.y),v.uniform1f(h,O.rotation),v.uniform1f(o,O.opacity),v.uniform3f(a,O.color.r,O.color.g,O.color.b),t.setBlending(O.blending,O.blendEquation,O.blendSrc,O.blendDst),t.setTexture(O.texture,1),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0))}}v.enable(v.CULL_FACE),v.enable(v.DEPTH_TEST),v.depthMask(!0),t.resetGLState()}}},THREE.ShadowMapPlugin=function(t,e,i,n){function r(t,e,n){if(e.visible){var o=i[e.id];if(o&&e.castShadow&&(!1===e.frustumCulled||!0===c.intersectsObject(e)))for(var a=0,s=o.length;s>a;a++){var h=o[a];e._modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),m.push(h)}for(a=0,s=e.children.length;s>a;a++)r(t,e.children[a],n)}}var o,a,s,h,l=t.context,c=new THREE.Frustum,u=new THREE.Matrix4,d=new THREE.Vector3,p=new THREE.Vector3,f=new THREE.Vector3,m=[],g=THREE.ShaderLib.depthRGBA,E=THREE.UniformsUtils.clone(g.uniforms);o=new THREE.ShaderMaterial({uniforms:E,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader}),a=new THREE.ShaderMaterial({uniforms:E,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,morphTargets:!0}),s=new THREE.ShaderMaterial({uniforms:E,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,skinning:!0}),h=new THREE.ShaderMaterial({uniforms:E,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,morphTargets:!0,skinning:!0}),o._shadowPass=!0,a._shadowPass=!0,s._shadowPass=!0,h._shadowPass=!0,this.render=function(i,g){if(!1!==t.shadowMapEnabled){var E,v,y,_,T,x,b,R,w=[];for(_=0,l.clearColor(1,1,1,1),l.disable(l.BLEND),l.enable(l.CULL_FACE),l.frontFace(l.CCW),l.cullFace(t.shadowMapCullFace===THREE.CullFaceFront?l.FRONT:l.BACK),t.setDepthTest(!0),E=0,v=e.length;v>E;E++)if(y=e[E],y.castShadow)if(y instanceof THREE.DirectionalLight&&y.shadowCascade)for(T=0;T<y.shadowCascadeCount;T++){var H;if(y.shadowCascadeArray[T])H=y.shadowCascadeArray[T];else{b=y;var M=T;H=new THREE.DirectionalLight,H.isVirtual=!0,H.onlyShadow=!0,H.castShadow=!0,H.shadowCameraNear=b.shadowCameraNear,H.shadowCameraFar=b.shadowCameraFar,H.shadowCameraLeft=b.shadowCameraLeft,H.shadowCameraRight=b.shadowCameraRight,H.shadowCameraBottom=b.shadowCameraBottom,H.shadowCameraTop=b.shadowCameraTop,H.shadowCameraVisible=b.shadowCameraVisible,H.shadowDarkness=b.shadowDarkness,H.shadowBias=b.shadowCascadeBias[M],H.shadowMapWidth=b.shadowCascadeWidth[M],H.shadowMapHeight=b.shadowCascadeHeight[M],H.pointsWorld=[],H.pointsFrustum=[],R=H.pointsWorld,x=H.pointsFrustum;for(var S=0;8>S;S++)R[S]=new THREE.Vector3,x[S]=new THREE.Vector3;R=b.shadowCascadeNearZ[M],b=b.shadowCascadeFarZ[M],x[0].set(-1,-1,R),x[1].set(1,-1,R),x[2].set(-1,1,R),x[3].set(1,1,R),x[4].set(-1,-1,b),x[5].set(1,-1,b),x[6].set(-1,1,b),x[7].set(1,1,b),H.originalCamera=g,x=new THREE.Gyroscope,x.position.copy(y.shadowCascadeOffset),x.add(H),x.add(H.target),g.add(x),y.shadowCascadeArray[T]=H,console.log("Created virtualLight",H)}M=y,R=T,b=M.shadowCascadeArray[R],b.position.copy(M.position),b.target.position.copy(M.target.position),b.lookAt(b.target),b.shadowCameraVisible=M.shadowCameraVisible,b.shadowDarkness=M.shadowDarkness,b.shadowBias=M.shadowCascadeBias[R],x=M.shadowCascadeNearZ[R],M=M.shadowCascadeFarZ[R],b=b.pointsFrustum,b[0].z=x,b[1].z=x,b[2].z=x,b[3].z=x,b[4].z=M,b[5].z=M,b[6].z=M,b[7].z=M,w[_]=H,_++}else w[_]=y,_++;for(E=0,v=w.length;v>E;E++){if(y=w[E],y.shadowMap||(T=THREE.LinearFilter,t.shadowMapType===THREE.PCFSoftShadowMap&&(T=THREE.NearestFilter),y.shadowMap=new THREE.WebGLRenderTarget(y.shadowMapWidth,y.shadowMapHeight,{minFilter:T,magFilter:T,format:THREE.RGBAFormat}),y.shadowMapSize=new THREE.Vector2(y.shadowMapWidth,y.shadowMapHeight),y.shadowMatrix=new THREE.Matrix4),!y.shadowCamera){if(y instanceof THREE.SpotLight)y.shadowCamera=new THREE.PerspectiveCamera(y.shadowCameraFov,y.shadowMapWidth/y.shadowMapHeight,y.shadowCameraNear,y.shadowCameraFar);else{if(!(y instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}y.shadowCamera=new THREE.OrthographicCamera(y.shadowCameraLeft,y.shadowCameraRight,y.shadowCameraTop,y.shadowCameraBottom,y.shadowCameraNear,y.shadowCameraFar)}i.add(y.shadowCamera),!0===i.autoUpdate&&i.updateMatrixWorld()}if(y.shadowCameraVisible&&!y.cameraHelper&&(y.cameraHelper=new THREE.CameraHelper(y.shadowCamera),i.add(y.cameraHelper)),y.isVirtual&&H.originalCamera==g){for(T=g,_=y.shadowCamera,x=y.pointsFrustum,b=y.pointsWorld,d.set(1/0,1/0,1/0),p.set(-1/0,-1/0,-1/0),M=0;8>M;M++)R=b[M],R.copy(x[M]),R.unproject(T),R.applyMatrix4(_.matrixWorldInverse),R.x<d.x&&(d.x=R.x),R.x>p.x&&(p.x=R.x),R.y<d.y&&(d.y=R.y),R.y>p.y&&(p.y=R.y),R.z<d.z&&(d.z=R.z),R.z>p.z&&(p.z=R.z);_.left=d.x,_.right=p.x,_.top=p.y,_.bottom=d.y,_.updateProjectionMatrix()}for(_=y.shadowMap,x=y.shadowMatrix,T=y.shadowCamera,T.position.setFromMatrixPosition(y.matrixWorld),f.setFromMatrixPosition(y.target.matrixWorld),T.lookAt(f),T.updateMatrixWorld(),T.matrixWorldInverse.getInverse(T.matrixWorld),y.cameraHelper&&(y.cameraHelper.visible=y.shadowCameraVisible),y.shadowCameraVisible&&y.cameraHelper.update(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(T.projectionMatrix),x.multiply(T.matrixWorldInverse),u.multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse),c.setFromMatrix(u),t.setRenderTarget(_),t.clear(),m.length=0,r(i,i,T),y=0,_=m.length;_>y;y++)b=m[y],x=b.object,b=b.buffer,M=x.material instanceof THREE.MeshFaceMaterial?x.material.materials[0]:x.material,R=void 0!==x.geometry.morphTargets&&0<x.geometry.morphTargets.length&&M.morphTargets,S=x instanceof THREE.SkinnedMesh&&M.skinning,R=x.customDepthMaterial?x.customDepthMaterial:S?R?h:s:R?a:o,t.setMaterialFaces(M),b instanceof THREE.BufferGeometry?t.renderBufferDirect(T,e,null,R,b,x):t.renderBuffer(T,e,null,R,b,x);for(y=0,_=n.length;_>y;y++)b=n[y],x=b.object,x.visible&&x.castShadow&&(x._modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,x.matrixWorld),t.renderImmediateObject(T,e,null,o,x))}E=t.getClearColor(),v=t.getClearAlpha(),l.clearColor(E.r,E.g,E.b,v),l.enable(l.BLEND),t.shadowMapCullFace===THREE.CullFaceFront&&l.cullFace(l.BACK),t.resetGLState()}}},THREE.SpritePlugin=function(t,e){function i(t,e){return t.z!==e.z?e.z-t.z:e.id-t.id}var n,r,o,a,s,h,l,c,u,d,p,f,m,g,E,v,y,_,T,x,b,R=t.context,w=new THREE.Vector3,H=new THREE.Quaternion,M=new THREE.Vector3;this.render=function(S,C){if(0!==e.length){if(void 0===x){var L=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),A=new Uint16Array([0,1,2,0,2,3]);_=R.createBuffer(),T=R.createBuffer(),R.bindBuffer(R.ARRAY_BUFFER,_),R.bufferData(R.ARRAY_BUFFER,L,R.STATIC_DRAW),R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,T),R.bufferData(R.ELEMENT_ARRAY_BUFFER,A,R.STATIC_DRAW);var L=R.createProgram(),A=R.createShader(R.VERTEX_SHADER),P=R.createShader(R.FRAGMENT_SHADER);R.shaderSource(A,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),R.shaderSource(P,["precision "+t.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),R.compileShader(A),R.compileShader(P),R.attachShader(L,A),R.attachShader(L,P),R.linkProgram(L),x=L,v=R.getAttribLocation(x,"position"),y=R.getAttribLocation(x,"uv"),n=R.getUniformLocation(x,"uvOffset"),r=R.getUniformLocation(x,"uvScale"),o=R.getUniformLocation(x,"rotation"),a=R.getUniformLocation(x,"scale"),s=R.getUniformLocation(x,"color"),h=R.getUniformLocation(x,"map"),l=R.getUniformLocation(x,"opacity"),c=R.getUniformLocation(x,"modelViewMatrix"),u=R.getUniformLocation(x,"projectionMatrix"),d=R.getUniformLocation(x,"fogType"),p=R.getUniformLocation(x,"fogDensity"),f=R.getUniformLocation(x,"fogNear"),m=R.getUniformLocation(x,"fogFar"),g=R.getUniformLocation(x,"fogColor"),E=R.getUniformLocation(x,"alphaTest"),L=document.createElement("canvas"),L.width=8,L.height=8,A=L.getContext("2d"),A.fillStyle="white",A.fillRect(0,0,8,8),b=new THREE.Texture(L),b.needsUpdate=!0}R.useProgram(x),R.enableVertexAttribArray(v),R.enableVertexAttribArray(y),R.disable(R.CULL_FACE),R.enable(R.BLEND),R.bindBuffer(R.ARRAY_BUFFER,_),R.vertexAttribPointer(v,2,R.FLOAT,!1,16,0),R.vertexAttribPointer(y,2,R.FLOAT,!1,16,8),R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,T),R.uniformMatrix4fv(u,!1,C.projectionMatrix.elements),R.activeTexture(R.TEXTURE0),R.uniform1i(h,0),A=L=0,(P=S.fog)?(R.uniform3f(g,P.color.r,P.color.g,P.color.b),P instanceof THREE.Fog?(R.uniform1f(f,P.near),R.uniform1f(m,P.far),R.uniform1i(d,1),A=L=1):P instanceof THREE.FogExp2&&(R.uniform1f(p,P.density),R.uniform1i(d,2),A=L=2)):(R.uniform1i(d,0),A=L=0);for(var P=0,k=e.length;k>P;P++){var D=e[P];D._modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,D.matrixWorld),D.z=-D._modelViewMatrix.elements[14]}e.sort(i);for(var O=[],P=0,k=e.length;k>P;P++){var D=e[P],B=D.material;R.uniform1f(E,B.alphaTest),R.uniformMatrix4fv(c,!1,D._modelViewMatrix.elements),D.matrixWorld.decompose(w,H,M),O[0]=M.x,O[1]=M.y,D=0,S.fog&&B.fog&&(D=A),L!==D&&(R.uniform1i(d,D),L=D),null!==B.map?(R.uniform2f(n,B.map.offset.x,B.map.offset.y),R.uniform2f(r,B.map.repeat.x,B.map.repeat.y)):(R.uniform2f(n,0,0),R.uniform2f(r,1,1)),R.uniform1f(l,B.opacity),R.uniform3f(s,B.color.r,B.color.g,B.color.b),R.uniform1f(o,B.rotation),R.uniform2fv(a,O),t.setBlending(B.blending,B.blendEquation,B.blendSrc,B.blendDst),t.setDepthTest(B.depthTest),t.setDepthWrite(B.depthWrite),B.map&&B.map.image&&B.map.image.width?t.setTexture(B.map,0):t.setTexture(b,0),R.drawElements(R.TRIANGLES,6,R.UNSIGNED_SHORT,0)}R.enable(R.CULL_FACE),t.resetGLState()}}},THREE.GeometryUtils={merge:function(t,e,i){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,n){var r=new THREE.ImageLoader;r.crossOrigin=this.crossOrigin;var o=new THREE.Texture(void 0,e);return r.load(t,function(t){o.image=t,o.needsUpdate=!0,i&&i(o)},void 0,function(t){n&&n(t)}),o.sourceFile=t,o},loadTextureCube:function(t,e,i,n){var r=new THREE.ImageLoader;r.crossOrigin=this.crossOrigin;var o=new THREE.CubeTexture([],e);o.flipY=!1;var a=0;e=function(e){r.load(t[e],function(t){o.images[e]=t,a+=1,6===a&&(o.needsUpdate=!0,i&&i(o))},void 0,n)};for(var s=0,h=t.length;h>s;++s)e(s);return o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(t,e){var i=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]};e|=1;var n=t.width,r=t.height,o=document.createElement("canvas");o.width=n,o.height=r;var a=o.getContext("2d");a.drawImage(t,0,0);for(var s=a.getImageData(0,0,n,r).data,h=a.createImageData(n,r),l=h.data,c=0;n>c;c++)for(var u=0;r>u;u++){var d=0>u-1?0:u-1,p=u+1>r-1?r-1:u+1,f=0>c-1?0:c-1,m=c+1>n-1?n-1:c+1,g=[],E=[0,0,s[4*(u*n+c)]/255*e];for(g.push([-1,0,s[4*(u*n+f)]/255*e]),g.push([-1,-1,s[4*(d*n+f)]/255*e]),g.push([0,-1,s[4*(d*n+c)]/255*e]),g.push([1,-1,s[4*(d*n+m)]/255*e]),g.push([1,0,s[4*(u*n+m)]/255*e]),g.push([1,1,s[4*(p*n+m)]/255*e]),g.push([0,1,s[4*(p*n+c)]/255*e]),g.push([-1,1,s[4*(p*n+f)]/255*e]),d=[],f=g.length,p=0;f>p;p++){var m=g[p],v=g[(p+1)%f],m=[m[0]-E[0],m[1]-E[1],m[2]-E[2]],v=[v[0]-E[0],v[1]-E[1],v[2]-E[2]];d.push(i([m[1]*v[2]-m[2]*v[1],m[2]*v[0]-m[0]*v[2],m[0]*v[1]-m[1]*v[0]]))}for(g=[0,0,0],p=0;p<d.length;p++)g[0]+=d[p][0],g[1]+=d[p][1],g[2]+=d[p][2];g[0]/=d.length,g[1]/=d.length,g[2]/=d.length,E=4*(u*n+c),l[E]=(g[0]+1)/2*255|0,l[E+1]=(g[1]+1)/2*255|0,l[E+2]=255*g[2]|0,l[E+3]=255}return a.putImageData(h,0,0),o},generateDataTexture:function(t,e,i){var n=t*e,r=new Uint8Array(3*n),o=Math.floor(255*i.r),a=Math.floor(255*i.g);i=Math.floor(255*i.b);for(var s=0;n>s;s++)r[3*s]=o,r[3*s+1]=a,r[3*s+2]=i;return t=new THREE.DataTexture(r,t,e,THREE.RGBFormat),t.needsUpdate=!0,t}},THREE.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new THREE.Object3D,n=0,r=e.length;r>n;n++)i.add(new THREE.Mesh(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new THREE.Matrix4;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(t){var e=t.familyName.toLowerCase();return this.faces[e]=this.faces[e]||{},this.faces[e][t.cssFontWeight]=this.faces[e][t.cssFontWeight]||{},this.faces[e][t.cssFontWeight][t.cssFontStyle]=t,this.faces[e][t.cssFontWeight][t.cssFontStyle]=t},drawText:function(t){var e=this.getFace(),i=this.size/e.resolution,n=0,r=String(t).split(""),o=r.length,a=[];for(t=0;o>t;t++){var s=new THREE.Path,s=this.extractGlyphPoints(r[t],e,i,n,s),n=n+s.offset;a.push(s.path)}return{paths:a,offset:n/2}},extractGlyphPoints:function(t,e,i,n,r){var o,a,s,h,l,c,u,d,p,f,m,g=[],E=e.glyphs[t]||e.glyphs["?"];if(E){if(E.o)for(e=E._cachedOutline||(E._cachedOutline=E.o.split(" ")),h=e.length,t=0;h>t;)switch(s=e[t++]){case"m":s=e[t++]*i+n,l=e[t++]*i,r.moveTo(s,l);break;case"l":s=e[t++]*i+n,l=e[t++]*i,r.lineTo(s,l);break;case"q":if(s=e[t++]*i+n,l=e[t++]*i,d=e[t++]*i+n,p=e[t++]*i,r.quadraticCurveTo(d,p,s,l),o=g[g.length-1])for(c=o.x,u=o.y,o=1,a=this.divisions;a>=o;o++){var v=o/a;THREE.Shape.Utils.b2(v,c,d,s),THREE.Shape.Utils.b2(v,u,p,l)}break;case"b":if(s=e[t++]*i+n,l=e[t++]*i,d=e[t++]*i+n,p=e[t++]*i,f=e[t++]*i+n,m=e[t++]*i,r.bezierCurveTo(d,p,f,m,s,l),o=g[g.length-1])for(c=o.x,u=o.y,o=1,a=this.divisions;a>=o;o++)v=o/a,THREE.Shape.Utils.b3(v,c,d,f,s),THREE.Shape.Utils.b3(v,u,p,m,l)}return{offset:E.ha*i,path:r}}}},THREE.FontUtils.generateShapes=function(t,e){e=e||{};var i=void 0!==e.curveSegments?e.curveSegments:4,n=void 0!==e.font?e.font:"helvetiker",r=void 0!==e.weight?e.weight:"normal",o=void 0!==e.style?e.style:"normal";for(THREE.FontUtils.size=void 0!==e.size?e.size:100,THREE.FontUtils.divisions=i,THREE.FontUtils.face=n,THREE.FontUtils.weight=r,THREE.FontUtils.style=o,i=THREE.FontUtils.drawText(t).paths,n=[],r=0,o=i.length;o>r;r++)Array.prototype.push.apply(n,i[r].toShapes());return n},function(t){var e=function(t){for(var e=t.length,i=0,n=e-1,r=0;e>r;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i};return t.Triangulate=function(t,i){var n=t.length;if(3>n)return null;var r,o,a,s=[],h=[],l=[];if(0<e(t))for(o=0;n>o;o++)h[o]=o;else for(o=0;n>o;o++)h[o]=n-1-o;var c=2*n;for(o=n-1;n>2;){if(0>=c--){console.log("Warning, unable to triangulate polygon!");break}r=o,r>=n&&(r=0),o=r+1,o>=n&&(o=0),a=o+1,a>=n&&(a=0);var u;t:{var d=u=void 0,p=void 0,f=void 0,m=void 0,g=void 0,E=void 0,v=void 0,y=void 0,d=t[h[r]].x,p=t[h[r]].y,f=t[h[o]].x,m=t[h[o]].y,g=t[h[a]].x,E=t[h[a]].y;if(1e-10>(f-d)*(E-p)-(m-p)*(g-d))u=!1;else{var _=void 0,T=void 0,x=void 0,b=void 0,R=void 0,w=void 0,H=void 0,M=void 0,S=void 0,C=void 0,S=M=H=y=v=void 0,_=g-f,T=E-m,x=d-g,b=p-E,R=f-d,w=m-p;for(u=0;n>u;u++)if(v=t[h[u]].x,y=t[h[u]].y,!(v===d&&y===p||v===f&&y===m||v===g&&y===E)&&(H=v-d,M=y-p,S=v-f,C=y-m,v-=g,y-=E,S=_*C-T*S,H=R*M-w*H,M=x*y-b*v,S>=-1e-10&&M>=-1e-10&&H>=-1e-10)){u=!1;break t}u=!0}}if(u){for(s.push([t[h[r]],t[h[o]],t[h[a]]]),l.push([h[r],h[o],h[a]]),r=o,a=o+1;n>a;r++,a++)h[r]=h[a];n--,c=2*n}}return i?l:s},t.Triangulate.area=e,t}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Audio=function(t){THREE.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},THREE.Audio.prototype=Object.create(THREE.Object3D.prototype),THREE.Audio.prototype.constructor=THREE.Audio,THREE.Audio.prototype.load=function(t){var e=this,i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){e.context.decodeAudioData(this.response,function(t){e.source.buffer=t,e.source.connect(e.panner),e.source.start(0)})},i.send(),this},THREE.Audio.prototype.setLoop=function(t){this.source.loop=t},THREE.Audio.prototype.setRefDistance=function(t){this.panner.refDistance=t},THREE.Audio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},THREE.Audio.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3;return function(e){THREE.Object3D.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}(),THREE.AudioListener=function(){THREE.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype),THREE.AudioListener.prototype.constructor=THREE.AudioListener,THREE.AudioListener.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3,e=new THREE.Quaternion,i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3;return function(a){THREE.Object3D.prototype.updateMatrixWorld.call(this,a),a=this.context.listener;var s=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),r.subVectors(t,o),a.setPosition(t.x,t.y,t.z),a.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z),a.setVelocity(r.x,r.y,r.z),o.copy(t)}}(),THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(t){return t=this.getUtoTmapping(t),this.getPoint(t)},THREE.Curve.prototype.getPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPoint(e/t));return i},THREE.Curve.prototype.getSpacedPoints=function(t){t||(t=5);var e,i=[];for(e=0;t>=e;e++)i.push(this.getPointAt(e/t));return i},THREE.Curve.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},THREE.Curve.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;t>=i;i++)e=this.getPoint(i/t),o+=e.distanceTo(r),n.push(o),r=e;return this.cacheArcLengths=n},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,o=n.length;i=e?e:t*n[o-1];for(var a,s=0,h=o-1;h>=s;)if(r=Math.floor(s+(h-s)/2),a=n[r]-i,0>a)s=r+1;else{if(!(a>0)){h=r;break}h=r-1}return r=h,n[r]==i?r/(o-1):(s=n[r],n=(r+(i-s)/(n[r+1]-s))/(o-1))},THREE.Curve.prototype.getTangent=function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),t>1&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},THREE.Curve.prototype.getTangentAt=function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},THREE.Curve.Utils={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,r){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*r},tangentSpline:function(t){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,i,n,r){t=.5*(i-t),n=.5*(n-e);var o=r*r;return(2*e-2*i+t+n)*r*o+(-3*e+3*i-2*t-n)*o+t*r+e}},THREE.Curve.create=function(t,e){return t.prototype=Object.create(THREE.Curve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.constructor=THREE.CurvePath,THREE.CurvePath.prototype.add=function(t){this.curves.push(t)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new THREE.LineCurve(e,t))},THREE.CurvePath.prototype.getPoint=function(t){var e=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=e)return e=i[t]-e,t=this.curves[t],e=1-e/t.getLength(),t.getPointAt(e);t++}return null},THREE.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var t,e=[],i=0,n=this.curves.length;for(t=0;n>t;t++)i+=this.curves[t].getLength(),e.push(i);return this.cacheLengths=e},THREE.CurvePath.prototype.getBoundingBox=function(){var t,e,i,n,r,o,a=this.getPoints();t=e=Number.NEGATIVE_INFINITY,n=r=Number.POSITIVE_INFINITY;var s,h,l,c,u=a[0]instanceof THREE.Vector3;for(c=u?new THREE.Vector3:new THREE.Vector2,h=0,l=a.length;l>h;h++)s=a[h],s.x>t?t=s.x:s.x<n&&(n=s.x),s.y>e?e=s.y:s.y<r&&(r=s.y),u&&(s.z>i?i=s.z:s.z<o&&(o=s.z)),c.add(s);return a={minX:n,minY:r,maxX:t,maxY:e},u&&(a.maxZ=i,a.minZ=o),a},THREE.CurvePath.prototype.createPointsGeometry=function(t){return t=this.getPoints(t,!0),this.createGeometry(t)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(t){return t=this.getSpacedPoints(t,!0),this.createGeometry(t)},THREE.CurvePath.prototype.createGeometry=function(t){for(var e=new THREE.Geometry,i=0;i<t.length;i++)e.vertices.push(new THREE.Vector3(t[i].x,t[i].y,t[i].z||0));return e},THREE.CurvePath.prototype.addWrapPath=function(t){this.bends.push(t)},THREE.CurvePath.prototype.getTransformedPoints=function(t,e){var i,n,r=this.getPoints(t);for(e||(e=this.bends),i=0,n=e.length;n>i;i++)r=this.getWrapPoints(r,e[i]);return r},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(t,e){var i,n,r=this.getSpacedPoints(t);for(e||(e=this.bends),i=0,n=e.length;n>i;i++)r=this.getWrapPoints(r,e[i]);return r},THREE.CurvePath.prototype.getWrapPoints=function(t,e){var i,n,r,o,a,s,h=this.getBoundingBox();for(i=0,n=t.length;n>i;i++)r=t[i],o=r.x,a=r.y,s=o/h.maxX,s=e.getUtoTmapping(s,o),o=e.getPoint(s),s=e.getTangent(s),s.set(-s.y,s.x).multiplyScalar(a),r.x=o.x+s.x,r.y=o.y+s.y;return t},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.constructor=THREE.Gyroscope,THREE.Gyroscope.prototype.updateMatrixWorld=function(){var t=new THREE.Vector3,e=new THREE.Quaternion,i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Quaternion,o=new THREE.Vector3;return function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(n,r,o),this.matrix.decompose(t,e,i),this.matrixWorld.compose(n,e,o)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var s=0,h=this.children.length;h>s;s++)this.children[s].updateMatrixWorld(a)}}(),THREE.Path=function(t){THREE.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.Path.prototype.constructor=THREE.Path,THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;i>e;e++)this.lineTo(t[e].x,t[e].y)},THREE.Path.prototype.moveTo=function(){var t=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:t})},THREE.Path.prototype.lineTo=function(t,e){var i=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,n=new THREE.LineCurve(new THREE.Vector2(n[n.length-2],n[n.length-1]),new THREE.Vector2(t,e));this.curves.push(n),this.actions.push({action:THREE.PathActions.LINE_TO,args:i})},THREE.Path.prototype.quadraticCurveTo=function(t,e,i,n){var r=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,o=new THREE.QuadraticBezierCurve(new THREE.Vector2(o[o.length-2],o[o.length-1]),new THREE.Vector2(t,e),new THREE.Vector2(i,n));this.curves.push(o),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:r})},THREE.Path.prototype.bezierCurveTo=function(t,e,i,n,r,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,s=new THREE.CubicBezierCurve(new THREE.Vector2(s[s.length-2],s[s.length-1]),new THREE.Vector2(t,e),new THREE.Vector2(i,n),new THREE.Vector2(r,o));this.curves.push(s),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:a})},THREE.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,i=[new THREE.Vector2(i[i.length-2],i[i.length-1])];Array.prototype.push.apply(i,t),i=new THREE.SplineCurve(i),this.curves.push(i),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:e})},THREE.Path.prototype.arc=function(t,e,i,n,r,o){var a=this.actions[this.actions.length-1].args;this.absarc(t+a[a.length-2],e+a[a.length-1],i,n,r,o)},THREE.Path.prototype.absarc=function(t,e,i,n,r,o){this.absellipse(t,e,i,i,n,r,o)},THREE.Path.prototype.ellipse=function(t,e,i,n,r,o,a){var s=this.actions[this.actions.length-1].args;this.absellipse(t+s[s.length-2],e+s[s.length-1],i,n,r,o,a)},THREE.Path.prototype.absellipse=function(t,e,i,n,r,o,a){var s=Array.prototype.slice.call(arguments),h=new THREE.EllipseCurve(t,e,i,n,r,o,a);this.curves.push(h),h=h.getPoint(1),s.push(h.x),s.push(h.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:s})},THREE.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],i=0;t>i;i++)e.push(this.getPoint(i/t));return e},THREE.Path.prototype.getPoints=function(t,e){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(t,e);t=t||12;var i,n,r,o,a,s,h,l,c,u,d,p,f,m=[];for(i=0,n=this.actions.length;n>i;i++)switch(r=this.actions[i],o=r.action,r=r.args,o){case THREE.PathActions.MOVE_TO:m.push(new THREE.Vector2(r[0],r[1]));break;case THREE.PathActions.LINE_TO:m.push(new THREE.Vector2(r[0],r[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(a=r[2],s=r[3],c=r[0],u=r[1],0<m.length?(o=m[m.length-1],d=o.x,p=o.y):(o=this.actions[i-1].args,d=o[o.length-2],p=o[o.length-1]),r=1;t>=r;r++)f=r/t,o=THREE.Shape.Utils.b2(f,d,c,a),f=THREE.Shape.Utils.b2(f,p,u,s),m.push(new THREE.Vector2(o,f));break;case THREE.PathActions.BEZIER_CURVE_TO:for(a=r[4],s=r[5],c=r[0],u=r[1],h=r[2],l=r[3],0<m.length?(o=m[m.length-1],d=o.x,p=o.y):(o=this.actions[i-1].args,d=o[o.length-2],p=o[o.length-1]),r=1;t>=r;r++)f=r/t,o=THREE.Shape.Utils.b3(f,d,c,h,a),f=THREE.Shape.Utils.b3(f,p,u,l,s),m.push(new THREE.Vector2(o,f));break;case THREE.PathActions.CSPLINE_THRU:for(o=this.actions[i-1].args,f=[new THREE.Vector2(o[o.length-2],o[o.length-1])],o=t*r[0].length,f=f.concat(r[0]),f=new THREE.SplineCurve(f),r=1;o>=r;r++)m.push(f.getPointAt(r/o));break;case THREE.PathActions.ARC:for(a=r[0],s=r[1],u=r[2],h=r[3],o=r[4],c=!!r[5],d=o-h,p=2*t,r=1;p>=r;r++)f=r/p,c||(f=1-f),f=h+f*d,o=a+u*Math.cos(f),f=s+u*Math.sin(f),m.push(new THREE.Vector2(o,f));break;case THREE.PathActions.ELLIPSE:for(a=r[0],s=r[1],u=r[2],l=r[3],h=r[4],o=r[5],c=!!r[6],d=o-h,p=2*t,r=1;p>=r;r++)f=r/p,c||(f=1-f),f=h+f*d,o=a+u*Math.cos(f),f=s+l*Math.sin(f),m.push(new THREE.Vector2(o,f))}return i=m[m.length-1],1e-10>Math.abs(i.x-m[0].x)&&1e-10>Math.abs(i.y-m[0].y)&&m.splice(m.length-1,1),e&&m.push(m[0]),m},THREE.Path.prototype.toShapes=function(t,e){function i(t){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i],o=new THREE.Shape;o.actions=r.actions,o.curves=r.curves,e.push(o)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,o=0;i>o;r=o++){var a=e[r],s=e[o],h=s.x-a.x,l=s.y-a.y;if(1e-10<Math.abs(l)){if(0>l&&(a=e[o],h=-h,s=e[r],l=-l),!(t.y<a.y||t.y>s.y))if(t.y==a.y){if(t.x==a.x)return!0}else{if(r=l*(t.x-a.x)-h*(t.y-a.y),0==r)return!0;0>r||(n=!n)}}else if(t.y==a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0}return n}var r=function(t){var e,i,n,r,o=[],a=new THREE.Path;for(e=0,i=t.length;i>e;e++)n=t[e],r=n.args,n=n.action,n==THREE.PathActions.MOVE_TO&&0!=a.actions.length&&(o.push(a),a=new THREE.Path),a[n].apply(a,r);return 0!=a.actions.length&&o.push(a),o}(this.actions);
if(0==r.length)return[];if(!0===e)return i(r);var o,a,s,h=[];if(1==r.length)return a=r[0],s=new THREE.Shape,s.actions=a.actions,s.curves=a.curves,h.push(s),h;var l=!THREE.Shape.Utils.isClockWise(r[0].getPoints()),l=t?!l:l;s=[];var c,u=[],d=[],p=0;u[p]=void 0,d[p]=[];var f,m;for(f=0,m=r.length;m>f;f++)a=r[f],c=a.getPoints(),o=THREE.Shape.Utils.isClockWise(c),(o=t?!o:o)?(!l&&u[p]&&p++,u[p]={s:new THREE.Shape,p:c},u[p].s.actions=a.actions,u[p].s.curves=a.curves,l&&p++,d[p]=[]):d[p].push({h:a,p:c[0]});if(!u[0])return i(r);if(1<u.length){for(f=!1,m=[],a=0,r=u.length;r>a;a++)s[a]=[];for(a=0,r=u.length;r>a;a++)for(o=d[a],l=0;l<o.length;l++){p=o[l],c=!0;for(var g=0;g<u.length;g++)n(p.p,u[g].p)&&(a!=g&&m.push({froms:a,tos:g,hole:l}),c?(c=!1,s[g].push(p)):f=!0);c&&s[a].push(p)}0<m.length&&(f||(d=s))}for(f=0,m=u.length;m>f;f++)for(s=u[f].s,h.push(s),a=d[f],r=0,o=a.length;o>r;r++)s.holes.push(a[r].h);return h},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.constructor=THREE.Shape,THREE.Shape.prototype.extrude=function(t){return new THREE.ExtrudeGeometry(this,t)},THREE.Shape.prototype.makeGeometry=function(t){return new THREE.ShapeGeometry(this,t)},THREE.Shape.prototype.getPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedPoints(t,this.bends);return n},THREE.Shape.prototype.getSpacedPointsHoles=function(t){var e,i=this.holes.length,n=[];for(e=0;i>e;e++)n[e]=this.holes[e].getTransformedSpacedPoints(t,this.bends);return n},THREE.Shape.prototype.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},THREE.Shape.prototype.extractPoints=function(t){return this.useSpacedPoints?this.extractAllSpacedPoints(t):this.extractAllPoints(t)},THREE.Shape.prototype.extractAllSpacedPoints=function(t){return{shape:this.getTransformedSpacedPoints(t),holes:this.getSpacedPointsHoles(t)}},THREE.Shape.Utils={triangulateShape:function(t,e){function i(t,e,i){return t.x!=e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function n(t,e,n,r,o){var a=e.x-t.x,s=e.y-t.y,h=r.x-n.x,l=r.y-n.y,c=t.x-n.x,u=t.y-n.y,d=s*h-a*l,p=s*c-a*u;if(1e-10<Math.abs(d)){if(d>0){if(0>p||p>d)return[];if(h=l*c-h*u,0>h||h>d)return[]}else{if(p>0||d>p)return[];if(h=l*c-h*u,h>0||d>h)return[]}return 0==h?!o||0!=p&&p!=d?[t]:[]:h==d?!o||0!=p&&p!=d?[e]:[]:0==p?[n]:p==d?[r]:(o=h/d,[{x:t.x+o*a,y:t.y+o*s}])}return 0!=p||l*c!=h*u?[]:(s=0==a&&0==s,h=0==h&&0==l,s&&h?t.x!=n.x||t.y!=n.y?[]:[t]:s?i(n,r,t)?[t]:[]:h?i(t,e,n)?[n]:[]:(0!=a?(t.x<e.x?(a=t,h=t.x,s=e,t=e.x):(a=e,h=e.x,s=t,t=t.x),n.x<r.x?(e=n,d=n.x,l=r,n=r.x):(e=r,d=r.x,l=n,n=n.x)):(t.y<e.y?(a=t,h=t.y,s=e,t=e.y):(a=e,h=e.y,s=t,t=t.y),n.y<r.y?(e=n,d=n.y,l=r,n=r.y):(e=r,d=r.y,l=n,n=n.y)),d>=h?d>t?[]:t==d?o?[]:[e]:n>=t?[e,s]:[e,l]:h>n?[]:h==n?o?[]:[a]:n>=t?[a,s]:[a,l]))}function r(t,e,i,n){var r=e.x-t.x,o=e.y-t.y;e=i.x-t.x,i=i.y-t.y;var a=n.x-t.x;return n=n.y-t.y,t=r*i-o*e,r=r*n-o*a,1e-10<Math.abs(t)?(e=a*i-n*e,t>0?r>=0&&e>=0:r>=0||e>=0):r>0}var o,a,s,h,l,c={};for(s=t.concat(),o=0,a=e.length;a>o;o++)Array.prototype.push.apply(s,e[o]);for(o=0,a=s.length;a>o;o++)l=s[o].x+":"+s[o].y,void 0!==c[l]&&console.log("Duplicate point",l),c[l]=o;o=function(t,e){function i(t,e){var i=g.length-1,n=t-1;0>n&&(n=i);var o=t+1;return o>i&&(o=0),(i=r(g[t],g[n],g[o],s[e]))?(i=s.length-1,n=e-1,0>n&&(n=i),o=e+1,o>i&&(o=0),(i=r(s[e],s[n],s[o],g[t]))?!0:!1):!1}function o(t,e){var i,r;for(i=0;i<g.length;i++)if(r=i+1,r%=g.length,r=n(t,e,g[i],g[r],!0),0<r.length)return!0;return!1}function a(t,i){var r,o,a,s;for(r=0;r<E.length;r++)for(o=e[E[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,s=n(t,i,o[a],o[s],!0),0<s.length)return!0;return!1}var s,h,l,c,u,d,p,f,m,g=t.concat(),E=[],v=[],y=0;for(h=e.length;h>y;y++)E.push(y);p=0;for(var _=2*E.length;0<E.length;){if(_--,0>_){console.log("Infinite Loop! Holes left:"+E.length+", Probably Hole outside Shape!");break}for(l=p;l<g.length;l++){for(c=g[l],h=-1,y=0;y<E.length;y++)if(u=E[y],d=c.x+":"+c.y+":"+u,void 0===v[d]){for(s=e[u],f=0;f<s.length;f++)if(u=s[f],i(l,f)&&!o(c,u)&&!a(c,u)){h=f,E.splice(y,1),p=g.slice(0,l+1),u=g.slice(l),f=s.slice(h),m=s.slice(0,h+1),g=p.concat(f).concat(m).concat(u),p=l;break}if(h>=0)break;v[d]=!0}if(h>=0)break}}return g}(t,e);var u=THREE.FontUtils.Triangulate(o,!1);for(o=0,a=u.length;a>o;o++)for(h=u[o],s=0;3>s;s++)l=h[s].x+":"+h[s].y,l=c[l],void 0!==l&&(h[s]=l);return u.concat()},isClockWise:function(t){return 0>THREE.FontUtils.Triangulate.area(t)},b2p0:function(t,e){var i=1-t;return i*i*e},b2p1:function(t,e){return 2*(1-t)*t*e},b2p2:function(t,e){return t*t*e},b2:function(t,e,i,n){return this.b2p0(t,e)+this.b2p1(t,i)+this.b2p2(t,n)},b3p0:function(t,e){var i=1-t;return i*i*i*e},b3p1:function(t,e){var i=1-t;return 3*i*i*t*e},b3p2:function(t,e){return 3*(1-t)*t*t*e},b3p3:function(t,e){return t*t*t*e},b3:function(t,e,i,n,r){return this.b3p0(t,e)+this.b3p1(t,i)+this.b3p2(t,n)+this.b3p3(t,r)}},THREE.LineCurve=function(t,e){this.v1=t,this.v2=e},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor=THREE.LineCurve,THREE.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},THREE.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},THREE.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var e=new THREE.Vector2;return e.x=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var e=new THREE.Vector2;return e.x=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),e.y=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y),e.normalize()},THREE.CubicBezierCurve=function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint=function(t){var e;return e=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(e,t)},THREE.CubicBezierCurve.prototype.getTangent=function(t){var e;return e=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e=new THREE.Vector2(e,t),e.normalize(),e},THREE.SplineCurve=function(t){this.points=void 0==t?[]:t},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor=THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint=function(t){var e=this.points;t*=e.length-1;var i=Math.floor(t);t-=i;var n=e[0==i?i:i-1],r=e[i],o=e[i>e.length-2?e.length-1:i+1],e=e[i>e.length-3?e.length-1:i+2],i=new THREE.Vector2;return i.x=THREE.Curve.Utils.interpolate(n.x,r.x,o.x,e.x,t),i.y=THREE.Curve.Utils.interpolate(n.y,r.y,o.y,e.y,t),i},THREE.EllipseCurve=function(t,e,i,n,r,o,a){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint=function(t){var e=this.aEndAngle-this.aStartAngle;return 0>e&&(e+=2*Math.PI),e>2*Math.PI&&(e-=2*Math.PI),t=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-e):this.aStartAngle+t*e,e=new THREE.Vector2,e.x=this.aX+this.xRadius*Math.cos(t),e.y=this.aY+this.yRadius*Math.sin(t),e},THREE.ArcCurve=function(t,e,i,n,r,o){THREE.EllipseCurve.call(this,t,e,i,i,n,r,o)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor=THREE.ArcCurve,THREE.LineCurve3=THREE.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new THREE.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=new THREE.Vector3;return e.x=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),e.y=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),e.z=THREE.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),e}),THREE.CubicBezierCurve3=THREE.Curve.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e=new THREE.Vector3;return e.x=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e.y=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e.z=THREE.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),e}),THREE.SplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e=this.points;t*=e.length-1;var i=Math.floor(t);t-=i;var n=e[0==i?i:i-1],r=e[i],o=e[i>e.length-2?e.length-1:i+1],e=e[i>e.length-3?e.length-1:i+2],i=new THREE.Vector3;return i.x=THREE.Curve.Utils.interpolate(n.x,r.x,o.x,e.x,t),i.y=THREE.Curve.Utils.interpolate(n.y,r.y,o.y,e.y,t),i.z=THREE.Curve.Utils.interpolate(n.z,r.z,o.z,e.z,t),i}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(t){this.points=void 0==t?[]:t},function(t){var e=this.points;t*=e.length-0;var i=Math.floor(t);t-=i;var i=i+(i>0?0:(Math.floor(Math.abs(i)/e.length)+1)*e.length),n=e[(i-1)%e.length],r=e[i%e.length],o=e[(i+1)%e.length],e=e[(i+2)%e.length],i=new THREE.Vector3;return i.x=THREE.Curve.Utils.interpolate(n.x,r.x,o.x,e.x,t),i.y=THREE.Curve.Utils.interpolate(n.y,r.y,o.y,e.y,t),i.z=THREE.Curve.Utils.interpolate(n.z,r.z,o.z,e.z,t),i}),THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(t){if(!0===t.initialized)return t;for(var e=0;e<t.hierarchy.length;e++){for(var i=0;i<t.hierarchy[e].keys.length;i++)if(0>t.hierarchy[e].keys[i].time&&(t.hierarchy[e].keys[i].time=0),void 0!==t.hierarchy[e].keys[i].rot&&!(t.hierarchy[e].keys[i].rot instanceof THREE.Quaternion)){var n=t.hierarchy[e].keys[i].rot;t.hierarchy[e].keys[i].rot=(new THREE.Quaternion).fromArray(n)}if(t.hierarchy[e].keys.length&&void 0!==t.hierarchy[e].keys[0].morphTargets){for(n={},i=0;i<t.hierarchy[e].keys.length;i++)for(var r=0;r<t.hierarchy[e].keys[i].morphTargets.length;r++){var o=t.hierarchy[e].keys[i].morphTargets[r];n[o]=-1}for(t.hierarchy[e].usedMorphTargets=n,i=0;i<t.hierarchy[e].keys.length;i++){var a={};for(o in n){for(r=0;r<t.hierarchy[e].keys[i].morphTargets.length;r++)if(t.hierarchy[e].keys[i].morphTargets[r]===o){a[o]=t.hierarchy[e].keys[i].morphTargetsInfluences[r];break}r===t.hierarchy[e].keys[i].morphTargets.length&&(a[o]=0)}t.hierarchy[e].keys[i].morphTargetsInfluences=a}}for(i=1;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].time===t.hierarchy[e].keys[i-1].time&&(t.hierarchy[e].keys.splice(i,1),i--);for(i=0;i<t.hierarchy[e].keys.length;i++)t.hierarchy[e].keys[i].index=i}return t.initialized=!0,t},parse:function(t){var e=function(t,i){i.push(t);for(var n=0;n<t.children.length;n++)e(t.children[n],i)},i=[];if(t instanceof THREE.SkinnedMesh)for(var n=0;n<t.skeleton.bones.length;n++)i.push(t.skeleton.bones[n]);else e(t,i);return i},play:function(t){-1===this.animations.indexOf(t)&&this.animations.push(t)},stop:function(t){t=this.animations.indexOf(t),-1!==t&&this.animations.splice(t,1)},update:function(t){for(var e=0;e<this.animations.length;e++)this.animations[e].resetBlendWeights();for(e=0;e<this.animations.length;e++)this.animations[e].update(t)}},THREE.Animation=function(t,e){this.root=t,this.data=THREE.AnimationHandler.init(e),this.hierarchy=THREE.AnimationHandler.parse(t),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=THREE.AnimationHandler.LINEAR},THREE.Animation.prototype.keyTypes=["pos","rot","scl"],THREE.Animation.prototype.play=function(t,e){this.currentTime=void 0!==t?t:0,this.weight=void 0!==e?e:1,this.isPlaying=!0,this.reset(),THREE.AnimationHandler.play(this)},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,THREE.AnimationHandler.stop(this)},THREE.Animation.prototype.reset=function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var i=this.hierarchy[t];void 0===i.animationCache&&(i.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}}),void 0===i.animationCache.animations[this.data.name]&&(i.animationCache.animations[this.data.name]={},i.animationCache.animations[this.data.name].prevKey={pos:0,rot:0,scl:0},i.animationCache.animations[this.data.name].nextKey={pos:0,rot:0,scl:0},i.animationCache.animations[this.data.name].originalMatrix=i.matrix);for(var i=i.animationCache.animations[this.data.name],n=0;3>n;n++){for(var r=this.keyTypes[n],o=this.data.hierarchy[t].keys[0],a=this.getNextKeyWith(r,t,1);a.time<this.currentTime&&a.index>o.index;)o=a,a=this.getNextKeyWith(r,t,a.index+1);i.prevKey[r]=o,i.nextKey[r]=a}}},THREE.Animation.prototype.resetBlendWeights=function(){for(var t=0,e=this.hierarchy.length;e>t;t++){var i=this.hierarchy[t];void 0!==i.animationCache&&(i.animationCache.blending.positionWeight=0,i.animationCache.blending.quaternionWeight=0,i.animationCache.blending.scaleWeight=0)}},THREE.Animation.prototype.update=function(){var t=[],e=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Quaternion,r=function(t,e){var i,n,r,a,s,h,l=[],c=[];return i=(t.length-1)*e,n=Math.floor(i),i-=n,l[0]=0===n?n:n-1,l[1]=n,l[2]=n>t.length-2?n:n+1,l[3]=n>t.length-3?n:n+2,n=t[l[0]],a=t[l[1]],s=t[l[2]],h=t[l[3]],l=i*i,r=i*l,c[0]=o(n[0],a[0],s[0],h[0],i,l,r),c[1]=o(n[1],a[1],s[1],h[1],i,l,r),c[2]=o(n[2],a[2],s[2],h[2],i,l,r),c},o=function(t,e,i,n,r,o,a){return t=.5*(i-t),n=.5*(n-e),(2*(e-i)+t+n)*a+(-3*(e-i)-2*t-n)*o+t*r+e};return function(o){if(!1!==this.isPlaying&&(this.currentTime+=o*this.timeScale,0!==this.weight)){o=this.data.length,(this.currentTime>o||0>this.currentTime)&&(this.loop?(this.currentTime%=o,0>this.currentTime&&(this.currentTime+=o),this.reset()):this.stop()),o=0;for(var a=this.hierarchy.length;a>o;o++)for(var s=this.hierarchy[o],h=s.animationCache.animations[this.data.name],l=s.animationCache.blending,c=0;3>c;c++){var u=this.keyTypes[c],d=h.prevKey[u],p=h.nextKey[u];if(0<this.timeScale&&p.time<=this.currentTime||0>this.timeScale&&d.time>=this.currentTime){for(d=this.data.hierarchy[o].keys[0],p=this.getNextKeyWith(u,o,1);p.time<this.currentTime&&p.index>d.index;)d=p,p=this.getNextKeyWith(u,o,p.index+1);h.prevKey[u]=d,h.nextKey[u]=p}var f=(this.currentTime-d.time)/(p.time-d.time),m=d[u],g=p[u];0>f&&(f=0),f>1&&(f=1),"pos"===u?this.interpolationType===THREE.AnimationHandler.LINEAR?(i.x=m[0]+(g[0]-m[0])*f,i.y=m[1]+(g[1]-m[1])*f,i.z=m[2]+(g[2]-m[2])*f,d=this.weight/(this.weight+l.positionWeight),s.position.lerp(i,d),l.positionWeight+=this.weight):(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)&&(t[0]=this.getPrevKeyWith("pos",o,d.index-1).pos,t[1]=m,t[2]=g,t[3]=this.getNextKeyWith("pos",o,p.index+1).pos,f=.33*f+.33,p=r(t,f),d=this.weight/(this.weight+l.positionWeight),l.positionWeight+=this.weight,u=s.position,u.x+=(p[0]-u.x)*d,u.y+=(p[1]-u.y)*d,u.z+=(p[2]-u.z)*d,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(f=r(t,1.01*f),e.set(f[0],f[1],f[2]),e.sub(u),e.y=0,e.normalize(),f=Math.atan2(e.x,e.z),s.rotation.set(0,f,0))):"rot"===u?(THREE.Quaternion.slerp(m,g,n,f),0===l.quaternionWeight?(s.quaternion.copy(n),l.quaternionWeight=this.weight):(d=this.weight/(this.weight+l.quaternionWeight),THREE.Quaternion.slerp(s.quaternion,n,s.quaternion,d),l.quaternionWeight+=this.weight)):"scl"===u&&(i.x=m[0]+(g[0]-m[0])*f,i.y=m[1]+(g[1]-m[1])*f,i.z=m[2]+(g[2]-m[2])*f,d=this.weight/(this.weight+l.scaleWeight),s.scale.lerp(i,d),l.scaleWeight+=this.weight)}return!0}}}(),THREE.Animation.prototype.getNextKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i<n.length-1?i:n.length-1:i%n.length;i<n.length;i++)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(t,e,i){var n=this.data.hierarchy[e].keys;for(i=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?i>0?i:0:i>=0?i:i+n.length;i>=0;i--)if(void 0!==n[i][t])return n[i];return this.data.hierarchy[e].keys[n.length-1]},THREE.KeyFrameAnimation=function(t){this.root=t.node,this.data=THREE.AnimationHandler.init(t),this.hierarchy=THREE.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.loop=this.isPaused=!0,t=0;for(var e=this.hierarchy.length;e>t;t++){var i=this.data.hierarchy[t].sids,n=this.hierarchy[t];if(this.data.hierarchy[t].keys.length&&i){for(var r=0;r<i.length;r++){var o=i[r],a=this.getNextKeyWith(o,t,0);a&&a.apply(o)}n.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),n.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(t){if(this.currentTime=void 0!==t?t:0,!1===this.isPlaying){this.isPlaying=!0;var e,i,n=this.hierarchy.length;for(t=0;n>t;t++)e=this.hierarchy[t],i=this.data.hierarchy[t],void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=e.matrix),e=this.data.hierarchy[t].keys,e.length&&(i.animationCache.prevKey=e[0],i.animationCache.nextKey=e[1],this.startTime=Math.min(e[0].time,this.startTime),this.endTime=Math.max(e[e.length-1].time,this.endTime));this.update(0)}this.isPaused=!1,THREE.AnimationHandler.play(this)},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1,THREE.AnimationHandler.stop(this);for(var t=0;t<this.data.hierarchy.length;t++){var e=this.hierarchy[t],i=this.data.hierarchy[t];if(void 0!==i.animationCache){var n=i.animationCache.originalMatrix;n.copy(e.matrix),e.matrix=n,delete i.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(t){if(!1!==this.isPlaying){this.currentTime+=t*this.timeScale,t=this.data.length,!0===this.loop&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t),t=0;for(var e=this.hierarchy.length;e>t;t++){var i=this.hierarchy[t],n=this.data.hierarchy[t],r=n.keys,n=n.animationCache;if(r.length){var o=n.prevKey,a=n.nextKey;if(a.time<=this.currentTime){for(;a.time<this.currentTime&&a.index>o.index;)o=a,a=r[o.index+1];n.prevKey=o,n.nextKey=a}a.time>=this.currentTime?o.interpolate(a,this.currentTime):o.interpolate(a,a.time),this.data.hierarchy[t].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(t,e,i){for(e=this.data.hierarchy[e].keys,i%=e.length;i<e.length;i++)if(e[i].hasTarget(t))return e[i];return e[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(t,e,i){for(e=this.data.hierarchy[e].keys,i=i>=0?i:i+e.length;i>=0;i--)if(e[i].hasTarget(t))return e[i];return e[e.length-1]},THREE.MorphAnimation=function(t){this.mesh=t,this.frames=t.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.currentFrame=this.lastFrame=0,this.isPlaying=!1},THREE.MorphAnimation.prototype={constructor:THREE.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(t){if(!1!==this.isPlaying){this.currentTime+=t,!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration),t=this.duration/this.frames;var e=Math.floor(this.currentTime/t);e!=this.currentFrame&&(this.mesh.morphTargetInfluences[this.lastFrame]=0,this.mesh.morphTargetInfluences[this.currentFrame]=1,this.mesh.morphTargetInfluences[e]=0,this.lastFrame=this.currentFrame,this.currentFrame=e),this.mesh.morphTargetInfluences[e]=this.currentTime%t/t,this.mesh.morphTargetInfluences[this.lastFrame]=1-this.mesh.morphTargetInfluences[e]}}},THREE.BoxGeometry=function(t,e,i,n,r,o){function a(t,e,i,n,r,o,a,h){var l,c=s.widthSegments,u=s.heightSegments,d=r/2,p=o/2,f=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?l="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(l="y",u=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(l="x",c=s.depthSegments);var m=c+1,g=u+1,E=r/c,v=o/u,y=new THREE.Vector3;for(y[l]=a>0?1:-1,r=0;g>r;r++)for(o=0;m>o;o++){var _=new THREE.Vector3;_[t]=(o*E-d)*i,_[e]=(r*v-p)*n,_[l]=a,s.vertices.push(_)}for(r=0;u>r;r++)for(o=0;c>o;o++)p=o+m*r,t=o+m*(r+1),e=o+1+m*(r+1),i=o+1+m*r,n=new THREE.Vector2(o/c,1-r/u),a=new THREE.Vector2(o/c,1-(r+1)/u),l=new THREE.Vector2((o+1)/c,1-(r+1)/u),d=new THREE.Vector2((o+1)/c,1-r/u),p=new THREE.Face3(p+f,t+f,i+f),p.normal.copy(y),p.vertexNormals.push(y.clone(),y.clone(),y.clone()),p.materialIndex=h,s.faces.push(p),s.faceVertexUvs[0].push([n,a,d]),p=new THREE.Face3(t+f,e+f,i+f),p.normal.copy(y),p.vertexNormals.push(y.clone(),y.clone(),y.clone()),p.materialIndex=h,s.faces.push(p),s.faceVertexUvs[0].push([a.clone(),l,d.clone()])}THREE.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.widthSegments=n||1,this.heightSegments=r||1,this.depthSegments=o||1;var s=this;n=t/2,r=e/2,o=i/2,a("z","y",-1,-1,i,e,n,0),a("z","y",1,-1,i,e,-n,1),a("x","z",1,1,t,i,r,2),a("x","z",1,-1,t,i,-r,3),a("x","y",1,-1,t,e,o,4),a("x","y",-1,-1,t,e,-o,5),this.mergeVertices()},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry,THREE.CircleGeometry=function(t,e,i,n){THREE.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,o=[];r=new THREE.Vector3;var a=new THREE.Vector2(.5,.5);for(this.vertices.push(r),o.push(a),r=0;e>=r;r++){var s=new THREE.Vector3,h=i+r/e*n;s.x=t*Math.cos(h),s.y=t*Math.sin(h),this.vertices.push(s),o.push(new THREE.Vector2((s.x/t+1)/2,(s.y/t+1)/2))}for(i=new THREE.Vector3(0,0,1),r=1;e>=r;r++)this.faces.push(new THREE.Face3(r,r+1,0,[i.clone(),i.clone(),i.clone()])),this.faceVertexUvs[0].push([o[r].clone(),o[r+1].clone(),a.clone()]);this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry,THREE.CubeGeometry=function(t,e,i,n,r,o){return console.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new THREE.BoxGeometry(t,e,i,n,r,o)},THREE.CylinderGeometry=function(t,e,i,n,r,o,a,s){THREE.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,n=n||8,r=r||1,o=void 0!==o?o:!1,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var h,l,c=i/2,u=[],d=[];for(l=0;r>=l;l++){var p=[],f=[],m=l/r,g=m*(e-t)+t;for(h=0;n>=h;h++){var E=h/n,v=new THREE.Vector3;v.x=g*Math.sin(E*s+a),v.y=-m*i+c,v.z=g*Math.cos(E*s+a),this.vertices.push(v),p.push(this.vertices.length-1),f.push(new THREE.Vector2(E,1-m))}u.push(p),d.push(f)}for(i=(e-t)/i,h=0;n>h;h++)for(0!==t?(a=this.vertices[u[0][h]].clone(),s=this.vertices[u[0][h+1]].clone()):(a=this.vertices[u[1][h]].clone(),s=this.vertices[u[1][h+1]].clone()),a.setY(Math.sqrt(a.x*a.x+a.z*a.z)*i).normalize(),s.setY(Math.sqrt(s.x*s.x+s.z*s.z)*i).normalize(),l=0;r>l;l++){var p=u[l][h],f=u[l+1][h],m=u[l+1][h+1],g=u[l][h+1],E=a.clone(),v=a.clone(),y=s.clone(),_=s.clone(),T=d[l][h].clone(),x=d[l+1][h].clone(),b=d[l+1][h+1].clone(),R=d[l][h+1].clone();this.faces.push(new THREE.Face3(p,f,g,[E,v,_])),this.faceVertexUvs[0].push([T,x,R]),this.faces.push(new THREE.Face3(f,m,g,[v.clone(),y,_.clone()])),this.faceVertexUvs[0].push([x.clone(),b,R.clone()])}if(!1===o&&t>0)for(this.vertices.push(new THREE.Vector3(0,c,0)),h=0;n>h;h++)p=u[0][h],f=u[0][h+1],m=this.vertices.length-1,E=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,1,0),y=new THREE.Vector3(0,1,0),T=d[0][h].clone(),x=d[0][h+1].clone(),b=new THREE.Vector2(x.x,0),this.faces.push(new THREE.Face3(p,f,m,[E,v,y])),this.faceVertexUvs[0].push([T,x,b]);if(!1===o&&e>0)for(this.vertices.push(new THREE.Vector3(0,-c,0)),h=0;n>h;h++)p=u[r][h+1],f=u[r][h],m=this.vertices.length-1,E=new THREE.Vector3(0,-1,0),v=new THREE.Vector3(0,-1,0),y=new THREE.Vector3(0,-1,0),T=d[r][h+1].clone(),x=d[r][h].clone(),b=new THREE.Vector2(x.x,1),this.faces.push(new THREE.Face3(p,f,m,[E,v,y])),this.faceVertexUvs[0].push([T,x,b]);this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.ExtrudeGeometry=function(t,e){"undefined"!=typeof t&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",t=t instanceof Array?t:[t],this.addShapeList(t,e),this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;i>n;n++)this.addShape(t[n],e)},THREE.ExtrudeGeometry.prototype.addShape=function(t,e){function i(t,e,i){return e||console.log("die"),e.clone().multiplyScalar(i).add(t)}function n(t,e,i){var n=1,n=t.x-e.x,r=t.y-e.y,o=i.x-t.x,a=i.y-t.y,s=n*n+r*r;if(1e-10<Math.abs(n*a-r*o)){var h=Math.sqrt(s),l=Math.sqrt(o*o+a*a),s=e.x-r/h;if(e=e.y+n/h,o=((i.x-a/l-s)*a-(i.y+o/l-e)*o)/(n*a-r*o),i=s+n*o-t.x,t=e+r*o-t.y,n=i*i+t*t,2>=n)return new THREE.Vector2(i,t);n=Math.sqrt(n/2)}else t=!1,n>1e-10?o>1e-10&&(t=!0):-1e-10>n?-1e-10>o&&(t=!0):Math.sign(r)==Math.sign(a)&&(t=!0),t?(i=-r,t=n,n=Math.sqrt(s)):(i=n,t=r,n=Math.sqrt(s/2));return new THREE.Vector2(i/n,t/n)}function r(t,e){var i,n;for(V=t.length;0<=--V;){i=V,n=V-1,0>n&&(n=t.length-1);for(var r=0,o=v+2*m,r=0;o>r;r++){var a=U*r,s=U*(r+1),h=e+i+a,a=e+n+a,l=e+n+s,s=e+i+s,h=h+S,a=a+S,l=l+S,s=s+S;M.faces.push(new THREE.Face3(h,a,s,null,null,x)),M.faces.push(new THREE.Face3(a,l,s,null,null,x)),h=b.generateSideWallUV(M,h,a,l,s),M.faceVertexUvs[0].push([h[0],h[1],h[3]]),M.faceVertexUvs[0].push([h[1],h[2],h[3]])}}}function o(t,e,i){M.vertices.push(new THREE.Vector3(t,e,i))}function a(t,e,i){t+=S,e+=S,i+=S,M.faces.push(new THREE.Face3(t,e,i,null,null,T)),t=b.generateTopUV(M,t,e,i),M.faceVertexUvs[0].push(t)}var s,h,l,c,u,d=void 0!==e.amount?e.amount:100,p=void 0!==e.bevelThickness?e.bevelThickness:6,f=void 0!==e.bevelSize?e.bevelSize:p-2,m=void 0!==e.bevelSegments?e.bevelSegments:3,g=void 0!==e.bevelEnabled?e.bevelEnabled:!0,E=void 0!==e.curveSegments?e.curveSegments:12,v=void 0!==e.steps?e.steps:1,y=e.extrudePath,_=!1,T=e.material,x=e.extrudeMaterial,b=void 0!==e.UVGenerator?e.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;y&&(s=y.getSpacedPoints(v),_=!0,g=!1,h=void 0!==e.frames?e.frames:new THREE.TubeGeometry.FrenetFrames(y,v,!1),l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3),g||(f=p=m=0);var R,w,H,M=this,S=this.vertices.length,y=t.extractPoints(E),E=y.shape,C=y.holes;if(y=!THREE.Shape.Utils.isClockWise(E)){for(E=E.reverse(),w=0,H=C.length;H>w;w++)R=C[w],THREE.Shape.Utils.isClockWise(R)&&(C[w]=R.reverse());y=!1}var L=THREE.Shape.Utils.triangulateShape(E,C),A=E;for(w=0,H=C.length;H>w;w++)R=C[w],E=E.concat(R);var P,k,D,O,B,N,U=E.length,F=L.length,y=[],V=0;for(D=A.length,P=D-1,k=V+1;D>V;V++,P++,k++)P===D&&(P=0),k===D&&(k=0),y[V]=n(A[V],A[P],A[k]);var z,I=[],j=y.concat();for(w=0,H=C.length;H>w;w++){for(R=C[w],z=[],V=0,D=R.length,P=D-1,k=V+1;D>V;V++,P++,k++)P===D&&(P=0),k===D&&(k=0),z[V]=n(R[V],R[P],R[k]);I.push(z),j=j.concat(z)}for(P=0;m>P;P++){for(D=P/m,O=p*(1-D),k=f*Math.sin(D*Math.PI/2),V=0,D=A.length;D>V;V++)B=i(A[V],y[V],k),o(B.x,B.y,-O);for(w=0,H=C.length;H>w;w++)for(R=C[w],z=I[w],V=0,D=R.length;D>V;V++)B=i(R[V],z[V],k),o(B.x,B.y,-O)}for(k=f,V=0;U>V;V++)B=g?i(E[V],j[V],k):E[V],_?(c.copy(h.normals[0]).multiplyScalar(B.x),l.copy(h.binormals[0]).multiplyScalar(B.y),u.copy(s[0]).add(c).add(l),o(u.x,u.y,u.z)):o(B.x,B.y,0);for(D=1;v>=D;D++)for(V=0;U>V;V++)B=g?i(E[V],j[V],k):E[V],_?(c.copy(h.normals[D]).multiplyScalar(B.x),l.copy(h.binormals[D]).multiplyScalar(B.y),u.copy(s[D]).add(c).add(l),o(u.x,u.y,u.z)):o(B.x,B.y,d/v*D);for(P=m-1;P>=0;P--){for(D=P/m,O=p*(1-D),k=f*Math.sin(D*Math.PI/2),V=0,D=A.length;D>V;V++)B=i(A[V],y[V],k),o(B.x,B.y,d+O);for(w=0,H=C.length;H>w;w++)for(R=C[w],z=I[w],V=0,D=R.length;D>V;V++)B=i(R[V],z[V],k),_?o(B.x,B.y+s[v-1].y,s[v-1].x+O):o(B.x,B.y,d+O)}!function(){if(g){var t;for(t=0*U,V=0;F>V;V++)N=L[V],a(N[2]+t,N[1]+t,N[0]+t);for(t=v+2*m,t*=U,V=0;F>V;V++)N=L[V],a(N[0]+t,N[1]+t,N[2]+t)}else{for(V=0;F>V;V++)N=L[V],a(N[2],N[1],N[0]);for(V=0;F>V;V++)N=L[V],a(N[0]+U*v,N[1]+U*v,N[2]+U*v)}}(),function(){var t=0;for(r(A,t),t+=A.length,w=0,H=C.length;H>w;w++)R=C[w],r(R,t),t+=R.length}()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,n){return t=t.vertices,e=t[e],i=t[i],n=t[n],[new THREE.Vector2(e.x,e.y),new THREE.Vector2(i.x,i.y),new THREE.Vector2(n.x,n.y)]},generateSideWallUV:function(t,e,i,n,r){return t=t.vertices,e=t[e],i=t[i],n=t[n],r=t[r],.01>Math.abs(e.y-i.y)?[new THREE.Vector2(e.x,1-e.z),new THREE.Vector2(i.x,1-i.z),new THREE.Vector2(n.x,1-n.z),new THREE.Vector2(r.x,1-r.z)]:[new THREE.Vector2(e.y,1-e.z),new THREE.Vector2(i.y,1-i.z),new THREE.Vector2(n.y,1-n.z),new THREE.Vector2(r.y,1-r.z)]}},THREE.ShapeGeometry=function(t,e){THREE.Geometry.call(this),this.type="ShapeGeometry",!1==t instanceof Array&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;n>i;i++)this.addShape(t[i],e);return this},THREE.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i,n,r,o=e.material,a=void 0===e.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,s=this.vertices.length;i=t.extractPoints(void 0!==e.curveSegments?e.curveSegments:12);var h=i.shape,l=i.holes;if(!THREE.Shape.Utils.isClockWise(h))for(h=h.reverse(),i=0,n=l.length;n>i;i++)r=l[i],THREE.Shape.Utils.isClockWise(r)&&(l[i]=r.reverse());var c=THREE.Shape.Utils.triangulateShape(h,l);for(i=0,n=l.length;n>i;i++)r=l[i],h=h.concat(r);for(l=h.length,n=c.length,i=0;l>i;i++)r=h[i],this.vertices.push(new THREE.Vector3(r.x,r.y,0));for(i=0;n>i;i++)l=c[i],h=l[0]+s,r=l[1]+s,l=l[2]+s,this.faces.push(new THREE.Face3(h,r,l,null,null,o)),this.faceVertexUvs[0].push(a.generateTopUV(this,h,r,l))},THREE.LatheGeometry=function(t,e,i,n){THREE.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=e||12,i=i||0,n=n||2*Math.PI;for(var r=1/(t.length-1),o=1/e,a=0,s=e;s>=a;a++)for(var h=i+a*o*n,l=Math.cos(h),c=Math.sin(h),h=0,u=t.length;u>h;h++){var d=t[h],p=new THREE.Vector3;p.x=l*d.x-c*d.y,p.y=c*d.x+l*d.y,p.z=d.z,this.vertices.push(p)}for(i=t.length,a=0,s=e;s>a;a++)for(h=0,u=t.length-1;u>h;h++){e=c=h+i*a,n=c+i;var l=c+1+i,c=c+1,d=a*o,p=h*r,f=d+o,m=p+r;this.faces.push(new THREE.Face3(e,n,c)),this.faceVertexUvs[0].push([new THREE.Vector2(d,p),new THREE.Vector2(f,p),new THREE.Vector2(d,m)]),this.faces.push(new THREE.Face3(n,l,c)),this.faceVertexUvs[0].push([new THREE.Vector2(f,p),new THREE.Vector2(f,m),new THREE.Vector2(d,m)])
}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry,THREE.PlaneGeometry=function(t,e,i,n){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),THREE.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new THREE.PlaneBufferGeometry(t,e,i,n))},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.PlaneBufferGeometry=function(t,e,i,n){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};var r=t/2,o=e/2;i=i||1,n=n||1;var a=i+1,s=n+1,h=t/i,l=e/n;e=new Float32Array(a*s*3),t=new Float32Array(a*s*3);for(var c=new Float32Array(a*s*2),u=0,d=0,p=0;s>p;p++)for(var f=p*l-o,m=0;a>m;m++)e[u]=m*h-r,e[u+1]=-f,t[u+2]=1,c[d]=m/i,c[d+1]=1-p/n,u+=3,d+=2;for(u=0,r=new(65535<e.length/3?Uint32Array:Uint16Array)(i*n*6),p=0;n>p;p++)for(m=0;i>m;m++)o=m+a*(p+1),s=m+1+a*(p+1),h=m+1+a*p,r[u]=m+a*p,r[u+1]=o,r[u+2]=h,r[u+3]=o,r[u+4]=s,r[u+5]=h,u+=6;this.addAttribute("index",new THREE.BufferAttribute(r,1)),this.addAttribute("position",new THREE.BufferAttribute(e,3)),this.addAttribute("normal",new THREE.BufferAttribute(t,3)),this.addAttribute("uv",new THREE.BufferAttribute(c,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.RingGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},t=t||0,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(1,n):8;var a,s=[],h=t,l=(e-t)/n;for(t=0;n+1>t;t++){for(a=0;i+1>a;a++){var c=new THREE.Vector3,u=r+a/i*o;c.x=h*Math.cos(u),c.y=h*Math.sin(u),this.vertices.push(c),s.push(new THREE.Vector2((c.x/e+1)/2,(c.y/e+1)/2))}h+=l}for(e=new THREE.Vector3(0,0,1),t=0;n>t;t++)for(r=t*(i+1),a=0;i>a;a++)o=u=a+r,l=u+i+1,c=u+i+2,this.faces.push(new THREE.Face3(o,l,c,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[l].clone(),s[c].clone()]),o=u,l=u+i+2,c=u+1,this.faces.push(new THREE.Face3(o,l,c,[e.clone(),e.clone(),e.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[l].clone(),s[c].clone()]);this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,h)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor=THREE.RingGeometry,THREE.SphereGeometry=function(t,e,i,n,r,o,a){THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,h,l=[],c=[];for(h=0;i>=h;h++){var u=[],d=[];for(s=0;e>=s;s++){var p=s/e,f=h/i,m=new THREE.Vector3;m.x=-t*Math.cos(n+p*r)*Math.sin(o+f*a),m.y=t*Math.cos(o+f*a),m.z=t*Math.sin(n+p*r)*Math.sin(o+f*a),this.vertices.push(m),u.push(this.vertices.length-1),d.push(new THREE.Vector2(p,1-f))}l.push(u),c.push(d)}for(h=0;i>h;h++)for(s=0;e>s;s++){n=l[h][s+1],r=l[h][s],o=l[h+1][s],a=l[h+1][s+1];var u=this.vertices[n].clone().normalize(),d=this.vertices[r].clone().normalize(),p=this.vertices[o].clone().normalize(),f=this.vertices[a].clone().normalize(),m=c[h][s+1].clone(),g=c[h][s].clone(),E=c[h+1][s].clone(),v=c[h+1][s+1].clone();Math.abs(this.vertices[n].y)===t?(m.x=(m.x+g.x)/2,this.faces.push(new THREE.Face3(n,o,a,[u,p,f])),this.faceVertexUvs[0].push([m,E,v])):Math.abs(this.vertices[o].y)===t?(E.x=(E.x+v.x)/2,this.faces.push(new THREE.Face3(n,r,o,[u,d,p])),this.faceVertexUvs[0].push([m,g,E])):(this.faces.push(new THREE.Face3(n,r,a,[u,d,f])),this.faceVertexUvs[0].push([m,g,v]),this.faces.push(new THREE.Face3(r,o,a,[d.clone(),p,f.clone()])),this.faceVertexUvs[0].push([g.clone(),E,v.clone()]))}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,t)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.TextGeometry=function(t,e){e=e||{};var i=THREE.FontUtils.generateShapes(t,e);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,i,e),this.type="TextGeometry"},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor=THREE.TextGeometry,THREE.TorusGeometry=function(t,e,i,n,r){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||100,e=e||40,i=i||8,n=n||6,r=r||2*Math.PI;for(var o=new THREE.Vector3,a=[],s=[],h=0;i>=h;h++)for(var l=0;n>=l;l++){var c=l/n*r,u=h/i*Math.PI*2;o.x=t*Math.cos(c),o.y=t*Math.sin(c);var d=new THREE.Vector3;d.x=(t+e*Math.cos(u))*Math.cos(c),d.y=(t+e*Math.cos(u))*Math.sin(c),d.z=e*Math.sin(u),this.vertices.push(d),a.push(new THREE.Vector2(l/n,h/i)),s.push(d.clone().sub(o).normalize())}for(h=1;i>=h;h++)for(l=1;n>=l;l++)t=(n+1)*h+l-1,e=(n+1)*(h-1)+l-1,r=(n+1)*(h-1)+l,o=(n+1)*h+l,c=new THREE.Face3(t,e,o,[s[t].clone(),s[e].clone(),s[o].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([a[t].clone(),a[e].clone(),a[o].clone()]),c=new THREE.Face3(e,r,o,[s[e].clone(),s[r].clone(),s[o].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([a[e].clone(),a[r].clone(),a[o].clone()]);this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry,THREE.TorusKnotGeometry=function(t,e,i,n,r,o,a){function s(t,e,i,n,r){var o=Math.cos(t),a=Math.sin(t);return t*=e/i,e=Math.cos(t),o*=n*(2+e)*.5,a=n*(2+e)*a*.5,n=r*n*Math.sin(t)*.5,new THREE.Vector3(o,a,n)}THREE.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,p:r,q:o,heightScale:a},t=t||100,e=e||40,i=i||64,n=n||8,r=r||2,o=o||3,a=a||1;for(var h=Array(i),l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=0;i>d;++d){h[d]=Array(n);var p=d/i*2*r*Math.PI,f=s(p,o,r,t,a),p=s(p+.01,o,r,t,a);for(l.subVectors(p,f),c.addVectors(p,f),u.crossVectors(l,c),c.crossVectors(u,l),u.normalize(),c.normalize(),p=0;n>p;++p){var m=p/n*2*Math.PI,g=-e*Math.cos(m),m=e*Math.sin(m),E=new THREE.Vector3;E.x=f.x+g*c.x+m*u.x,E.y=f.y+g*c.y+m*u.y,E.z=f.z+g*c.z+m*u.z,h[d][p]=this.vertices.push(E)-1}}for(d=0;i>d;++d)for(p=0;n>p;++p)r=(d+1)%i,o=(p+1)%n,t=h[d][p],e=h[r][p],r=h[r][o],o=h[d][o],a=new THREE.Vector2(d/i,p/n),l=new THREE.Vector2((d+1)/i,p/n),c=new THREE.Vector2((d+1)/i,(p+1)/n),u=new THREE.Vector2(d/i,(p+1)/n),this.faces.push(new THREE.Face3(t,e,o)),this.faceVertexUvs[0].push([a,l,u]),this.faces.push(new THREE.Face3(e,r,o)),this.faceVertexUvs[0].push([l.clone(),c,u.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry,THREE.TubeGeometry=function(t,e,i,n,r,o){THREE.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:i,radialSegments:n,closed:r},e=e||64,i=i||1,n=n||8,r=r||!1,o=o||THREE.TubeGeometry.NoTaper;var a,s,h,l,c,u,d,p,f,m,g=[],E=e+1,v=new THREE.Vector3;for(p=new THREE.TubeGeometry.FrenetFrames(t,e,r),f=p.normals,m=p.binormals,this.tangents=p.tangents,this.normals=f,this.binormals=m,p=0;E>p;p++)for(g[p]=[],h=p/(E-1),d=t.getPointAt(h),a=f[p],s=m[p],c=i*o(h),h=0;n>h;h++)l=h/n*2*Math.PI,u=-c*Math.cos(l),l=c*Math.sin(l),v.copy(d),v.x+=u*a.x+l*s.x,v.y+=u*a.y+l*s.y,v.z+=u*a.z+l*s.z,g[p][h]=this.vertices.push(new THREE.Vector3(v.x,v.y,v.z))-1;for(p=0;e>p;p++)for(h=0;n>h;h++)o=r?(p+1)%e:p+1,E=(h+1)%n,t=g[p][h],i=g[o][h],o=g[o][E],E=g[p][E],v=new THREE.Vector2(p/e,h/n),f=new THREE.Vector2((p+1)/e,h/n),m=new THREE.Vector2((p+1)/e,(h+1)/n),a=new THREE.Vector2(p/e,(h+1)/n),this.faces.push(new THREE.Face3(t,i,E)),this.faceVertexUvs[0].push([v,f,a]),this.faces.push(new THREE.Face3(i,o,E)),this.faceVertexUvs[0].push([f.clone(),m,a.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry,THREE.TubeGeometry.NoTaper=function(){return 1},THREE.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},THREE.TubeGeometry.FrenetFrames=function(t,e,i){new THREE.Vector3;var n=new THREE.Vector3;new THREE.Vector3;var r=[],o=[],a=[],s=new THREE.Vector3,h=new THREE.Matrix4;e+=1;var l,c,u;for(this.tangents=r,this.normals=o,this.binormals=a,l=0;e>l;l++)c=l/(e-1),r[l]=t.getTangentAt(c),r[l].normalize();for(o[0]=new THREE.Vector3,a[0]=new THREE.Vector3,t=Number.MAX_VALUE,l=Math.abs(r[0].x),c=Math.abs(r[0].y),u=Math.abs(r[0].z),t>=l&&(t=l,n.set(1,0,0)),t>=c&&(t=c,n.set(0,1,0)),t>=u&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],s),a[0].crossVectors(r[0],o[0]),l=1;e>l;l++)o[l]=o[l-1].clone(),a[l]=a[l-1].clone(),s.crossVectors(r[l-1],r[l]),1e-4<s.length()&&(s.normalize(),n=Math.acos(THREE.Math.clamp(r[l-1].dot(r[l]),-1,1)),o[l].applyMatrix4(h.makeRotationAxis(s,n))),a[l].crossVectors(r[l],o[l]);if(i)for(n=Math.acos(THREE.Math.clamp(o[0].dot(o[e-1]),-1,1)),n/=e-1,0<r[0].dot(s.crossVectors(o[0],o[e-1]))&&(n=-n),l=1;e>l;l++)o[l].applyMatrix4(h.makeRotationAxis(r[l],n*l)),a[l].crossVectors(r[l],o[l])},THREE.PolyhedronGeometry=function(t,e,i,n){function r(t){var e=t.normalize().clone();e.index=h.vertices.push(e)-1;var i=Math.atan2(t.z,-t.x)/2/Math.PI+.5;return t=Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5,e.uv=new THREE.Vector2(i,1-t),e}function o(t,e,i){var n=new THREE.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()]);h.faces.push(n),g.copy(t).add(e).add(i).divideScalar(3),n=Math.atan2(g.z,-g.x),h.faceVertexUvs[0].push([s(t.uv,t,n),s(e.uv,e,n),s(i.uv,i,n)])}function a(t,e){var i=Math.pow(2,e);Math.pow(4,e);for(var n=r(h.vertices[t.a]),a=r(h.vertices[t.b]),s=r(h.vertices[t.c]),l=[],c=0;i>=c;c++){l[c]=[];for(var u=r(n.clone().lerp(s,c/i)),d=r(a.clone().lerp(s,c/i)),p=i-c,f=0;p>=f;f++)l[c][f]=0==f&&c==i?u:r(u.clone().lerp(d,f/p))}for(c=0;i>c;c++)for(f=0;2*(i-c)-1>f;f++)n=Math.floor(f/2),0==f%2?o(l[c][n+1],l[c+1][n],l[c][n]):o(l[c][n+1],l[c+1][n+1],l[c+1][n])}function s(t,e,i){return 0>i&&1===t.x&&(t=new THREE.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new THREE.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},i=i||1,n=n||0;for(var h=this,l=0,c=t.length;c>l;l+=3)r(new THREE.Vector3(t[l],t[l+1],t[l+2]));t=this.vertices;for(var u=[],d=l=0,c=e.length;c>l;l+=3,d++){var p=t[e[l]],f=t[e[l+1]],m=t[e[l+2]];u[d]=new THREE.Face3(p.index,f.index,m.index,[p.clone(),f.clone(),m.clone()])}for(var g=new THREE.Vector3,l=0,c=u.length;c>l;l++)a(u[l],n);for(l=0,c=this.faceVertexUvs[0].length;c>l;l++)e=this.faceVertexUvs[0][l],n=e[0].x,t=e[1].x,u=e[2].x,d=Math.max(n,Math.max(t,u)),p=Math.min(n,Math.min(t,u)),d>.9&&.1>p&&(.2>n&&(e[0].x+=1),.2>t&&(e[1].x+=1),.2>u&&(e[2].x+=1));for(l=0,c=this.vertices.length;c>l;l++)this.vertices[l].multiplyScalar(i);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.DodecahedronGeometry=function(t,e){this.parameters={radius:t,detail:e};var i=(1+Math.sqrt(5))/2,n=1/i;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e)},THREE.DodecahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry,THREE.IcosahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,THREE.OctahedronGeometry=function(t,e){this.parameters={radius:t,detail:e},THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry,THREE.TetrahedronGeometry=function(t,e){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry,THREE.ParametricGeometry=function(t,e,i){THREE.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,o,a,s=this.vertices,h=this.faces,l=this.faceVertexUvs[0],c=e+1;for(n=0;i>=n;n++)for(a=n/i,r=0;e>=r;r++)o=r/e,o=t(o,a),s.push(o);var u,d,p,f;for(n=0;i>n;n++)for(r=0;e>r;r++)t=n*c+r,s=n*c+r+1,a=(n+1)*c+r+1,o=(n+1)*c+r,u=new THREE.Vector2(r/e,n/i),d=new THREE.Vector2((r+1)/e,n/i),p=new THREE.Vector2((r+1)/e,(n+1)/i),f=new THREE.Vector2(r/e,(n+1)/i),h.push(new THREE.Face3(t,s,o)),l.push([u,d,f]),h.push(new THREE.Face3(s,a,o)),l.push([d.clone(),p,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry,THREE.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);t=new THREE.BufferGeometry,t.addAttribute("position",new THREE.BufferAttribute(e,3)),t.addAttribute("color",new THREE.BufferAttribute(i,3)),e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.Line.call(this,t,e,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.AxisHelper.prototype.constructor=THREE.AxisHelper,THREE.ArrowHelper=function(){var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var e=new THREE.CylinderGeometry(0,.5,1,5,1);return e.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),function(i,n,r,o,a,s){THREE.Object3D.call(this),void 0===o&&(o=16776960),void 0===r&&(r=1),void 0===a&&(a=.2*r),void 0===s&&(s=.2*a),this.position.copy(n),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(r,a,s)}}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection=function(){var t,e=new THREE.Vector3;return function(i){.99999<i.y?this.quaternion.set(0,0,0,1):-.99999>i.y?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,t-e,1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},THREE.BoxHelper=function(t){var e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3)),THREE.Line.call(this,e,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==t&&this.update(t)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.constructor=THREE.BoxHelper,THREE.BoxHelper.prototype.update=function(t){var e=t.geometry;null===e.boundingBox&&e.computeBoundingBox();var i=e.boundingBox.min,e=e.boundingBox.max,n=this.geometry.attributes.position.array;n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=i.x,n[4]=e.y,n[5]=e.z,n[6]=i.x,n[7]=e.y,n[8]=e.z,n[9]=i.x,n[10]=i.y,n[11]=e.z,n[12]=i.x,n[13]=i.y,n[14]=e.z,n[15]=e.x,n[16]=i.y,n[17]=e.z,n[18]=e.x,n[19]=i.y,n[20]=e.z,n[21]=e.x,n[22]=e.y,n[23]=e.z,n[24]=e.x,n[25]=e.y,n[26]=i.z,n[27]=i.x,n[28]=e.y,n[29]=i.z,n[30]=i.x,n[31]=e.y,n[32]=i.z,n[33]=i.x,n[34]=i.y,n[35]=i.z,n[36]=i.x,n[37]=i.y,n[38]=i.z,n[39]=e.x,n[40]=i.y,n[41]=i.z,n[42]=e.x,n[43]=i.y,n[44]=i.z,n[45]=e.x,n[46]=e.y,n[47]=i.z,n[48]=e.x,n[49]=e.y,n[50]=e.z,n[51]=e.x,n[52]=e.y,n[53]=i.z,n[54]=i.x,n[55]=e.y,n[56]=e.z,n[57]=i.x,n[58]=e.y,n[59]=i.z,n[60]=i.x,n[61]=i.y,n[62]=e.z,n[63]=i.x,n[64]=i.y,n[65]=i.z,n[66]=e.x,n[67]=i.y,n[68]=e.z,n[69]=e.x,n[70]=i.y,n[71]=i.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},THREE.BoundingBoxHelper=function(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:i,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(t){function e(t,e,n){i(t,n),i(e,n)}function i(t,e){n.vertices.push(new THREE.Vector3),n.colors.push(new THREE.Color(e)),void 0===o[t]&&(o[t]=[]),o[t].push(n.vertices.length-1)}var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={};e("n1","n2",16755200),e("n2","n4",16755200),e("n4","n3",16755200),e("n3","n1",16755200),e("f1","f2",16755200),e("f2","f4",16755200),e("f4","f3",16755200),e("f3","f1",16755200),e("n1","f1",16755200),e("n2","f2",16755200),e("n3","f3",16755200),e("n4","f4",16755200),e("p","n1",16711680),e("p","n2",16711680),e("p","n3",16711680),e("p","n4",16711680),e("u1","u2",43775),e("u2","u3",43775),e("u3","u1",43775),e("c","t",16777215),e("p","c",3355443),e("cn1","cn2",3355443),e("cn3","cn4",3355443),e("cf1","cf2",3355443),e("cf3","cf4",3355443),THREE.Line.call(this,n,r,THREE.LinePieces),this.camera=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.constructor=THREE.CameraHelper,THREE.CameraHelper.prototype.update=function(){var t,e,i=new THREE.Vector3,n=new THREE.Camera,r=function(r,o,a,s){if(i.set(o,a,s).unproject(n),r=e[r],void 0!==r)for(o=0,a=r.length;a>o;o++)t.vertices[r[o]].copy(i)};return function(){t=this.geometry,e=this.pointMap,n.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),t.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(t,e){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var i=new THREE.Geometry;i.vertices.push(new THREE.Vector3(-e,e,0),new THREE.Vector3(e,e,0),new THREE.Vector3(e,-e,0),new THREE.Vector3(-e,-e,0),new THREE.Vector3(-e,e,0));var n=new THREE.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(i,n),this.add(this.lightPlane),i=new THREE.Geometry,i.vertices.push(new THREE.Vector3,new THREE.Vector3),n=new THREE.LineBasicMaterial({fog:!1}),n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(i,n),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t),this.lightPlane.lookAt(i),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(i),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(t,e){var i=void 0!==e?e:16777215,n=[0,0],r={},o=function(t,e){return t-e},a=["a","b","c"],s=new THREE.BufferGeometry,h=t.geometry.clone();h.mergeVertices(),h.computeFaceNormals();for(var l=h.vertices,h=h.faces,c=0,u=0,d=h.length;d>u;u++)for(var p=h[u],f=0;3>f;f++){n[0]=p[a[f]],n[1]=p[a[(f+1)%3]],n.sort(o);var m=n.toString();void 0===r[m]?(r[m]={vert1:n[0],vert2:n[1],face1:u,face2:void 0},c++):r[m].face2=u}n=new Float32Array(6*c),o=0;for(m in r)a=r[m],(void 0===a.face2||.9999>h[a.face1].normal.dot(h[a.face2].normal))&&(c=l[a.vert1],n[o++]=c.x,n[o++]=c.y,n[o++]=c.z,c=l[a.vert2],n[o++]=c.x,n[o++]=c.y,n[o++]=c.z);s.addAttribute("position",new THREE.BufferAttribute(n,3)),THREE.Line.call(this,s,new THREE.LineBasicMaterial({color:i}),THREE.LinePieces),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype),THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper,THREE.FaceNormalsHelper=function(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,t=void 0!==i?i:16776960,n=void 0!==n?n:1,e=new THREE.Geometry,i=0;for(var r=this.object.geometry.faces.length;r>i;i++)e.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,e,new THREE.LineBasicMaterial({color:t,linewidth:n}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update=function(){var t=this.geometry.vertices,e=this.object,i=e.geometry.vertices,n=e.geometry.faces,r=e.matrixWorld;e.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(r);for(var o=e=0,a=n.length;a>e;e++,o+=2){var s=n[e];t[o].copy(i[s.a]).add(i[s.b]).add(i[s.c]).divideScalar(3).applyMatrix4(r),t[o+1].copy(s.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(t[o])}return this.geometry.verticesNeedUpdate=!0,this},THREE.GridHelper=function(t,e){var i=new THREE.Geometry,n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var r=-t;t>=r;r+=e){i.vertices.push(new THREE.Vector3(-t,0,r),new THREE.Vector3(t,0,r),new THREE.Vector3(r,0,-t),new THREE.Vector3(r,0,t));var o=0===r?this.color1:this.color2;i.colors.push(o,o,o,o)}THREE.Line.call(this,i,n,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.constructor=THREE.GridHelper,THREE.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(t,e){for(THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color],t=new THREE.SphereGeometry(e,4,2),t.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),e=0;8>e;e++)t.faces[e].color=this.colors[4>e?0:1];e=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0}),this.lightSphere=new THREE.Mesh(t,e),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var t=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var i=new THREE.SphereGeometry(e,4,2),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new THREE.Geometry,i=0;i<this.bones.length;i++)this.bones[i].parent instanceof THREE.Bone&&(e.vertices.push(new THREE.Vector3),e.vertices.push(new THREE.Vector3),e.colors.push(new THREE.Color(0,0,1)),e.colors.push(new THREE.Color(0,1,0)));i=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0}),THREE.Line.call(this,e,i,THREE.LinePieces),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype),THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof THREE.Bone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},THREE.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new THREE.Matrix4).getInverse(this.root.matrixWorld),i=new THREE.Matrix4,n=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent instanceof THREE.Bone&&(i.multiplyMatrices(e,o.matrixWorld),t.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[n+1].setFromMatrixPosition(i),n+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},THREE.SpotLightHelper=function(t){THREE.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new THREE.CylinderGeometry(0,1,1,8,1,!0),t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(t,e),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){var i=this.light.distance?this.light.distance:1e4,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,e=void 0!==i?i:16711680,n=void 0!==n?n:1,i=new THREE.Geometry,t=t.geometry.faces;for(var r=0,o=t.length;o>r;r++)for(var a=0,s=t[r].vertexNormals.length;s>a;a++)i.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:e,linewidth:n}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(e){e=["a","b","c","d"],this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var i=this.geometry.vertices,n=this.object.geometry.vertices,r=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,h=r.length;h>s;s++)for(var l=r[s],c=0,u=l.vertexNormals.length;u>c;c++){var d=l.vertexNormals[c];i[a].copy(n[l[e[c]]]).applyMatrix4(o),t.copy(d).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(i[a]),a+=1,i[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(t,e,i,n){this.object=t,this.size=void 0!==e?e:1,e=void 0!==i?i:255,n=void 0!==n?n:1,i=new THREE.Geometry,t=t.geometry.faces;for(var r=0,o=t.length;o>r;r++)for(var a=0,s=t[r].vertexTangents.length;s>a;a++)i.vertices.push(new THREE.Vector3),i.vertices.push(new THREE.Vector3);THREE.Line.call(this,i,new THREE.LineBasicMaterial({color:e,linewidth:n}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.constructor=THREE.VertexTangentsHelper,THREE.VertexTangentsHelper.prototype.update=function(){var t=new THREE.Vector3;return function(e){e=["a","b","c","d"],this.object.updateMatrixWorld(!0);for(var i=this.geometry.vertices,n=this.object.geometry.vertices,r=this.object.geometry.faces,o=this.object.matrixWorld,a=0,s=0,h=r.length;h>s;s++)for(var l=r[s],c=0,u=l.vertexTangents.length;u>c;c++){var d=l.vertexTangents[c];i[a].copy(n[l[e[c]]]).applyMatrix4(o),t.copy(d).transformDirection(o).multiplyScalar(this.size),t.add(i[a]),a+=1,i[a].copy(t),a+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(t,e){var i=void 0!==e?e:16777215,n=[0,0],r={},o=function(t,e){return t-e},a=["a","b","c"],s=new THREE.BufferGeometry;if(t.geometry instanceof THREE.Geometry){for(var h=t.geometry.vertices,l=t.geometry.faces,c=0,u=new Uint32Array(6*l.length),d=0,p=l.length;p>d;d++)for(var f=l[d],m=0;3>m;m++){n[0]=f[a[m]],n[1]=f[a[(m+1)%3]],n.sort(o);var g=n.toString();void 0===r[g]&&(u[2*c]=n[0],u[2*c+1]=n[1],r[g]=!0,c++)}for(n=new Float32Array(6*c),d=0,p=c;p>d;d++)for(m=0;2>m;m++)c=h[u[2*d+m]],a=6*d+3*m,n[a+0]=c.x,n[a+1]=c.y,n[a+2]=c.z;
s.addAttribute("position",new THREE.BufferAttribute(n,3))}else if(t.geometry instanceof THREE.BufferGeometry){if(void 0!==t.geometry.attributes.index){h=t.geometry.attributes.position.array,p=t.geometry.attributes.index.array,l=t.geometry.drawcalls,c=0,0===l.length&&(l=[{count:p.length,index:0,start:0}]);for(var u=new Uint32Array(2*p.length),f=0,E=l.length;E>f;++f)for(var m=l[f].start,g=l[f].count,a=l[f].index,d=m,v=m+g;v>d;d+=3)for(m=0;3>m;m++)n[0]=a+p[d+m],n[1]=a+p[d+(m+1)%3],n.sort(o),g=n.toString(),void 0===r[g]&&(u[2*c]=n[0],u[2*c+1]=n[1],r[g]=!0,c++);for(n=new Float32Array(6*c),d=0,p=c;p>d;d++)for(m=0;2>m;m++)a=6*d+3*m,c=3*u[2*d+m],n[a+0]=h[c],n[a+1]=h[c+1],n[a+2]=h[c+2]}else for(h=t.geometry.attributes.position.array,c=h.length/3,u=c/3,n=new Float32Array(6*c),d=0,p=u;p>d;d++)for(m=0;3>m;m++)a=18*d+6*m,u=9*d+3*m,n[a+0]=h[u],n[a+1]=h[u+1],n[a+2]=h[u+2],c=9*d+(m+1)%3*3,n[a+3]=h[c],n[a+4]=h[c+1],n[a+5]=h[c+2];s.addAttribute("position",new THREE.BufferAttribute(n,3))}THREE.Line.call(this,s,new THREE.LineBasicMaterial({color:i}),THREE.LinePieces),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper,THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject,THREE.MorphBlendMesh=function(t,e){THREE.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length;this.createAnimation("__default",0,i-1,i/1),this.setAnimationWeight("__default",1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation=function(t,e,i,n){e={startFrame:e,endFrame:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[t]=e,this.animationsList.push(e)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/,n={},r=this.geometry,o=0,a=r.morphTargets.length;a>o;o++){var s=r.morphTargets[o].name.match(i);if(s&&1<s.length){var h=s[1];n[h]||(n[h]={start:1/0,end:-1/0}),s=n[h],o<s.start&&(s.start=o),o>s.end&&(s.end=o),e||(e=h)}}for(h in n)s=n[h],this.createAnimation(h,s.start,s.end,t);this.firstAnimation=e},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e},THREE.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("animation["+t+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1)},THREE.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;i>e;e++){var n=this.animationsList[e];if(n.active){var r=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||0>n.time)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),0>n.time&&(n.time=0,n.directionBackwards=!1)):(n.time%=n.duration,0>n.time&&(n.time+=n.duration));var o=n.startFrame+THREE.Math.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o),r=n.time%r/r,n.directionBackwards&&(r=1-r),this.morphTargetInfluences[n.currentFrame]=r*a,this.morphTargetInfluences[n.lastFrame]=(1-r)*a}}},define("three",function(){}),define("autoload/vendors",["require","vendors/handlebars","jquery.scrollto","fullpage","three"],function(t){"use strict";return function(e){t("vendors/handlebars")(e),t("jquery.scrollto"),t("fullpage"),t("three")}}),define("Lumberman/transport/Base",[],function(){"use strict";function t(){}return["debug","info","warn","error","exception"].forEach(function(e){t.prototype[e]=function(){throw new Error("Not implemented")}}),t}),define("Lumberman/logger/Simple",[],function(){"use strict";function t(t,e){if(!t)throw new Error("Missing logger name");if(!e)throw new Error("Missing callback");if(!(e instanceof Function))throw new Error("Callback is not a function");this.name=t,this.callback=e}return t.prototype.getTime=function(){return(new Date).toUTCString()},t.prototype.formatException=function(t){var e=[t.message];return t.stack&&e.push(t.stack),e},t.prototype.prependData=function(){var t=Array.prototype.slice.call(arguments);return t.unshift("["+this.name+"]"),t.unshift("["+this.getTime()+"]"),t},["debug","info","warn","error"].forEach(function(e){t.prototype[e]=function(){this.callback(e,this.prependData.apply(this,arguments))}}),t.prototype.exception=function(t){this.callback("exception",this.prependData.apply(this,this.formatException(t)))},t}),define("Lumberman/Lumberman",["require","Lumberman/transport/Base","Lumberman/logger/Simple"],function(t){"use strict";function e(){this.transports=[]}var i=t("Lumberman/transport/Base"),n=t("Lumberman/logger/Simple");return e.prototype.getLogger=function(t){var e=this;return new n(t,function(t,i){e.log(t,i)})},e.prototype.log=function(t,e){this.transports.forEach(function(i){i[t](e)})},e.prototype.addTransport=function(t){if(!(t instanceof i))throw new Error("Invalid transport");this.transports.push(t)},e}),define("Lumberman/transport/Console",["require","Lumberman/transport/Base"],function(t){"use strict";function e(){}var i=t("Lumberman/transport/Base");return e.prototype=Object.create(i.prototype,{constructor:{value:i,configurable:!0,writeable:!0}}),["debug","info","warn","error"].forEach(function(t){e.prototype[t]=function(e){window.console[t].apply(window.console,e)}}),e.prototype.exception=function(t){window.console.error.apply(window.console,t)},e}),define("plugins/logger",["require","Lumberman/Lumberman","Lumberman/transport/Console"],function(t){"use strict";var e=t("Lumberman/Lumberman"),i=t("Lumberman/transport/Console");return function(t){t.lumberman=new e,t.lumberman.addTransport(new i)}}),define("autoload/plugins",["require","plugins/logger"],function(t){"use strict";return function(e){t("plugins/logger")(e);var i={init:function(t){return this.each(function(){$(this).data("jSetting",$.extend({},$.fn.jqFloat.defaults,t)),$(this).data("jDefined",!0);var e=$("<div/>").css({width:$(this).outerWidth(!0),height:$(this).outerHeight(!0),"z-index":$(this).css("zIndex")});e.css("absolute"==$(this).css("position")?{position:"absolute",top:$(this).position().top,left:$(this).position().left}:{"float":$(this).css("float"),position:"relative"}),("0px"==$(this).css("marginLeft")||"auto"==$(this).css("marginLeft"))&&$(this).position().left>0&&"absolute"!=$(this).css("position")&&e.css({marginLeft:$(this).position().left}),$(this).wrap(e).css({position:"absolute",top:0,left:0})})},update:function(t){$(this).data("jSetting",$.extend({},$.fn.jqFloat.defaults,t))},play:function(){$(this).data("jFloating")||$(this).data("jFloating",!0),n(this)},stop:function(){this.data("jFloating",!1)}},n=function(t){var e=$(t).data("jSetting"),i=Math.floor(Math.random()*e.width)-e.width/2,r=Math.floor(Math.random()*e.height)-e.height/2-e.minHeight,o=Math.floor(Math.random()*e.speed)+e.speed/2;$(t).stop().animate({top:r,left:i},o,function(){$(this).data("jFloating")?n(this):$(this).animate({top:0,left:0},o/2)})};$.fn.jqFloat=function(t,e){var n=$(this);return i[t]?(n.data("jDefined")?e&&"object"==typeof e&&i.update.apply(this,Array.prototype.slice.call(arguments,1)):i.init.apply(this,Array.prototype.slice.call(arguments,1)),i[t].apply(this)):"object"!=typeof t&&t?$.error("Method "+t+" does not exist!"):(n.data("jDefined")?t&&i.update.apply(this,arguments):i.init.apply(this,arguments),i.play.apply(this)),this},$.fn.jqFloat.defaults={width:100,height:100,speed:1e3,minHeight:0}}}),define("text",["module"],function(t){"use strict";var e,i,n,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),u=l&&location.hostname,d=l&&(location.port||void 0),p={},f=t.config&&t.config()||{};return e={version:"2.0.14",strip:function(t){if(t){t=t.replace(s,"");var e=t.match(h);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=a[e];try{t=new ActiveXObject(i)}catch(n){}if(t){a=[i];break}}return t},parseName:function(t){var e,i,n,r=!1,o=t.lastIndexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==o&&(!a||o>1)?(e=t.substring(0,o),i=t.substring(o+1)):e=t,n=i||e,o=n.indexOf("!"),-1!==o&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:e=n),{moduleName:e,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,r){var o,a,s,h=e.xdRegExp.exec(t);return h?(o=h[2],a=h[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==i||a&&a.toLowerCase()!==n.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(t,i,n,r){n=i?e.strip(n):n,f.isBuild&&(p[t]=n),r(n)},load:function(t,i,n,r){if(r&&r.isBuild&&!r.inlineText)return void n();f.isBuild=r&&r.isBuild;var o=e.parseName(t),a=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(a),h=f.useXhr||e.useXhr;return 0===s.indexOf("empty:")?void n():void(!l||h(s,c,u,d)?e.get(s,function(i){e.finishLoad(t,o.strip,i,n)},function(t){n.error&&n.error(t)}):i([a],function(t){e.finishLoad(o.moduleName+"."+o.ext,o.strip,t,n)}))},write:function(t,i,n){if(p.hasOwnProperty(i)){var r=e.jsEscape(p[i]);n.asModule(t+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,i,n,r,o){var a=e.parseName(i),s=a.ext?"."+a.ext:"",h=a.moduleName+s,l=n.toUrl(a.moduleName+s)+".js";e.load(h,n,function(){var i=function(t){return r(l,t)};i.asModule=function(t,e){return r.asModule(t,l,e)},e.write(t,h,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");"﻿"===r[0]&&(r=r.substring(1)),e(r)}catch(o){n&&n(o)}}):"xhr"===f.env||!f.env&&e.createXhr()?e.get=function(t,i,n,r){var o,a=e.createXhr();if(a.open("GET",t,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(a,t),a.onreadystatechange=function(){var e,r;4===a.readyState&&(e=a.status||0,e>399&&600>e?(r=new Error(t+" HTTP status: "+e),r.xhr=a,n&&n(r)):i(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,t))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,r="utf-8",o=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),h="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(a),i.append(n);h=String(i.toString())}finally{s.close()}e(h)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,a,s,h={};o&&(t=t.replace(/\//g,"\\")),s=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(s,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),h),a.close(),i.close(),e(h.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),e}),define("text!modules/home/templates/BackgroundView.hbs",[],function(){return"<span></span>"}),define("modules/home/views/BackgroundView",["require","marionette","underscore","text!./../templates/BackgroundView.hbs"],function(t){"use strict";{var e=t("marionette");t("underscore")}return e.ItemView.extend({template:t("text!./../templates/BackgroundView.hbs"),ui:{background:"#background"},events:{},initialize:function(){},onShow:function(){},onRender:function(){function t(){for(s=E.$el.get(0),h=new THREE.PerspectiveCamera(55,window.innerWidth/window.innerHeight,2,2e3),h.position.z=1e3,l=new THREE.Scene,l.fog=new THREE.FogExp2(16777215,.001),d=new THREE.Geometry,g=THREE.ImageUtils.loadTexture("/static_files/images/disc.png"),f=0;1e4>f;f++){var t=new THREE.Vector3;t.x=2e3*Math.random()-1e3,t.y=2e3*Math.random()-1e3,t.z=2e3*Math.random()-1e3,d.vertices.push(t)}p=new THREE.PointCloudMaterial({opacity:.1,size:35,sizeAttenuation:!1,map:g,transparent:!0}),p.color.setHSL(1,.3,.7),u=new THREE.PointCloud(d,p),l.add(u),c=new THREE.WebGLRenderer,c.setPixelRatio(window.devicePixelRatio),c.setClearColor(15592946,0),c.setSize(window.innerWidth,window.innerHeight),s.appendChild(c.domElement),document.addEventListener("mousemove",i,!1),document.addEventListener("touchstart",n,!1),document.addEventListener("touchmove",r,!1),window.addEventListener("resize",e,!1)}function e(){_=window.innerWidth/2,T=window.innerHeight/2,h.aspect=window.innerWidth/window.innerHeight,h.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight)}function i(t){v=t.clientX-_,y=t.clientY-T}function n(t){1==t.touches.length&&(t.preventDefault(),v=t.touches[0].pageX-_,y=t.touches[0].pageY-T)}function r(t){1==t.touches.length&&(t.preventDefault(),v=t.touches[0].pageX-_,y=t.touches[0].pageY-T)}function o(){setTimeout(function(){requestAnimationFrame(o)},50),a()}function a(){var t=5e-5*Date.now();h.position.x+=.05*(v-h.position.x),h.position.y+=.05*(-y-h.position.y),h.lookAt(l.position),m=360*(1+t)%360/360,p.color.setRGB(.6,.63,1.2),c.render(l,h)}var s,h,l,c,u,d,p,f,m,g,E=this,v=0,y=0,_=window.innerWidth/2,T=window.innerHeight/2;t(),o()},onDestroy:function(){}})}),define("text!modules/home/templates/HomeView.hbs",[],function(){return'\n<div class="network-image-container">\n    <div>\n        <div>\n            <img src="/static_files/images/msnos-network.png" class="msnos-network" />\n            <img src="/static_files/images/network-shadow.png" class="network-shadow" />\n        </div>\n\n\n    </div>\n\n</div>\n\n\n<h1>A lightweight library built to survive your microservices architecture: your APIs, in the cloud, self discovered.</h1>\n\n<a href="#secondPage" class="discover">Discover me <span class="icon-chevron-down"></span></a>'}),define("modules/home/views/HomeView",["require","marionette","underscore","text!./../templates/HomeView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("underscore");return e.ItemView.extend({template:t("text!./../templates/HomeView.hbs"),ui:{msnosnetwork:".msnos-network"},events:{},initialize:function(){},onShow:function(){setTimeout(i.bind(function(){$(this.ui.msnosnetwork).jqFloat({width:10,height:10,speed:1e3})},this),300),setTimeout(i.bind(function(){$(this.ui.msnosnetwork).jqFloat("stop"),console.log("stop")},this),5500)},onRender:function(){},onDestroy:function(){}})}),define("text!modules/home/templates/AboutView.hbs",[],function(){return'<div class="slide">\n    <h1>really service oriented</h1>\n\n    <p>Unlike other solutions available on the market msnos is a library directly linked to your service, not to the machine.</p>\n\n</div>\n<div class="slide">\n\n    <h1>fault resilient</h1>\n\n    <p>An internal checking system is provided so that if any microservice become unhealthy it stops receiving calls.</p>\n</div>\n<div class="slide">\n\n\n    <h1>language agnostic</h1>\n\n    <p>Native language API for Java, Ruby and .NET are available, and linking the code is usually a matter of few lines of code.</p>\n\n\n</div>\n<div class="slide">\n\n\n    <h1>completely transparent</h1>\n\n    <p>adding or removing microservices is completely transparent: new APIs are automatically recognized and used by every other service.</p>\n\n</div>\n<div class="slide">\n\n\n    <h1>out of the box front-end proxy</h1>\n\n    <p>A fast http non-blocking i/o proxy is available out of the box, and it will automatically expose any public API of the cloud to your applications.</p>\n\n</div>\n<div class="slide">\n\n\n    <h1>geo-location aware</h1>\n\n    <p>Each service knows where he’s located and takes active routing decisions based on his location in the globe.</p>\n\n</div>\n<div class="slide">\n\n\n    <h1>advanced routing</h1>\n\n    <p>The load is distributed trough advanced strategies, based on load, location, availability, stickiness</p>\n\n</div>\n<div class="slide">\n\n\n    <h1>open source</h1>\n\n    <p>msnos is fully open source under the MIT license, and under active development by Workshare ltd</p>\n\n</div>'}),define("modules/home/views/AboutView",["require","marionette","underscore","text!./../templates/AboutView.hbs"],function(t){"use strict";{var e=t("marionette");t("underscore")}return e.ItemView.extend({template:t("text!./../templates/AboutView.hbs"),ui:{},events:{},initialize:function(){},onShow:function(){},onRender:function(){},onDestroy:function(){}})}),define("text!modules/home/templates/HowView.hbs",[],function(){return"really"}),define("modules/home/views/HowView",["require","marionette","underscore","text!./../templates/HowView.hbs"],function(t){"use strict";{var e=t("marionette");t("underscore")}return e.ItemView.extend({template:t("text!./../templates/HowView.hbs"),ui:{},events:{},initialize:function(){},onShow:function(){},onRender:function(){},onDestroy:function(){}})}),define("text!modules/home/templates/InputView.hbs",[],function(){return'<input type="text" id="base-url-input" value="http://www.ms-nos.io">\n<a href="#" id="trigger_map">map</a>'}),define("modules/home/views/InputView",["require","marionette","underscore","text!./../templates/InputView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("underscore");return e.ItemView.extend({template:t("text!./../templates/InputView.hbs"),ui:{},events:{},initialize:function(){},onShow:function(){$("#trigger_map").on("click",i.bind(function(t){t.preventDefault();var e=$("#base-url-input").val();this._checkUrl(e,i.bind(function(t){t?this._goToMap(e):alert("error")},this))},this))},onRender:function(){},onDestroy:function(){},_goToMap:function(t){window.app.commands.execute("navigate:map",{url:t})},_checkUrl:function(t,e){$.ajax({type:"HEAD",url:t+"/admin/microservices",timeout:5e3,success:function(){e(!0)},error:function(){e(!1)}})}})}),define("text!modules/home/templates/ContactsView.hbs",[],function(){return"really"}),define("modules/home/views/ContactsView",["require","marionette","underscore","text!./../templates/ContactsView.hbs"],function(t){"use strict";{var e=t("marionette");t("underscore")}return e.ItemView.extend({template:t("text!./../templates/ContactsView.hbs"),ui:{},events:{},initialize:function(){},onShow:function(){},onRender:function(){},onDestroy:function(){}})}),define("text!modules/home/templates/IndexLayout.hbs",[],function(){return'<div id="background-region"></div>\n\n<ul class="menu" id="menu">\n    <li data-menuanchor="home"><a href="#home">Home</a></li>\n    <li data-menuanchor="about"><a href="#about">about</a></li>\n    <li data-menuanchor="how"><a href="#how">how it works</a></li>\n    <li data-menuanchor="visualization"><a href="#visualization">live visualization</a></li>\n    <li data-menuanchor="contacts"><a href="#contacts">write to us</a></li>\n</ul>\n\n<ul class="menu" id="submenu">\n    <li>github</li>\n</ul>\n\n<div id="fullpage">\n    <div class="section" id="home-region"></div>\n    <div class="section" id="about-region"></div>\n    <div class="section" id="how-region"></div>\n    <div class="section" id="input-region"></div>\n    <div class="section" id="contacts-region"></div>\n</div>\n\n<div class="msnos-logo"><img src="/static_files/images/msnos.png"/></div>\n'}),define("modules/home/views/IndexLayout",["require","marionette","backbone","./BackgroundView","./HomeView","./AboutView","./HowView","./InputView","./ContactsView","text!./../templates/IndexLayout.hbs"],function(t){"use strict";var e=t("marionette"),i=t("backbone"),n=t("./BackgroundView"),r=t("./HomeView"),o=t("./AboutView"),a=t("./HowView"),s=t("./InputView"),h=t("./ContactsView");return e.LayoutView.extend({id:"indexLayout",className:"indexLayout",template:t("text!./../templates/IndexLayout.hbs"),regions:{backgroundRegion:"#background-region",homeRegion:"#home-region",aboutRegion:"#about-region",howRegion:"#how-region",inputRegion:"#input-region",contactsRegion:"#contacts-region"},ui:{map_canvas:"#map_canvas"},initialize:function(t){this.controller=t.controller,this.backgroundView=new n,this.homeView=new r,this.aboutView=new o,this.howView=new a,this.inputView=new s,this.contactsView=new h},onShow:function(){this.backgroundRegion.show(this.backgroundView),this.homeRegion.show(this.homeView),this.aboutRegion.show(this.aboutView),this.howRegion.show(this.howView),this.inputRegion.show(this.inputView),this.contactsRegion.show(this.contactsView),$("#fullpage").fullpage({anchors:["home","about","how","visualization","contacts"],menu:"#menu",css3:!0,scrollingSpeed:1e3});var t=i.history.getFragment().split("/");$.fn.fullpage.silentMoveTo(t[0],t[1])},onRender:function(){},onBeforeDestroy:function(){$.fn.fullpage.destroy("all")}})}),define("modules/home/controller",["require","marionette","./views/IndexLayout"],function(t){"use strict";var e=t("marionette"),i=t("./views/IndexLayout");return e.Object.extend({initialize:function(t){this.app=t.app,this.logger=t.logger},index:function(){this._initIndexLayout()},_initIndexLayout:function(){(!this.indexLayout||this.indexLayout.isDestroyed)&&(this.indexLayout=new i({controller:this})),this.app.container.show(this.indexLayout)}})}),define("modules/home/router",["require","marionette"],function(t){"use strict";var e=t("marionette"),i=e.AppRouter.extend({appRoutes:{"home(/)":"index","about(/:page)(/)":"index","how(/)":"index","visualization(/)":"index","contacts(/)":"index"}});return i}),define("modules/home/module",["require","./controller","./router"],function(t){"use strict";var e=t("./controller"),i=t("./router");return function(t){t.module("home",function(){this.logger=t.lumberman.getLogger("home");var n=this.controller=new e({app:t,logger:this.logger}),r=this.router=new i({controller:this.controller});t.commands.setHandler("navigate:home",function(){n.index(),r.navigate("home")})})}}),!function(t,e,i){var n=t.L,r={};r.version="0.7.3","object"==typeof module&&"object"==typeof module.exports?module.exports=r:"function"==typeof define&&define.amd&&define("leaflet",r),r.noConflict=function(){return t.L=n,this},t.L=r,r.Util={extend:function(t){var e,i,n,r,o=Array.prototype.slice.call(arguments,1);for(i=0,n=o.length;n>i;i++){r=o[i]||{};for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e])}return t},bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),invokeEach:function(t,e,i){var n,r;if("object"==typeof t){r=Array.prototype.slice.call(arguments,3);for(n in t)e.apply(i,[n,t[n]].concat(r));return!0}return!1},limitExecByInterval:function(t,e,i){var n,r;return function o(){var a=arguments;return n?void(r=!0):(n=!0,setTimeout(function(){n=!1,r&&(o.apply(i,a),r=!1)},e),void t.apply(i,a))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return r.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=r.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var r=e[n];if(r===i)throw new Error("No value provided for variable "+t);return"function"==typeof r&&(r=r(e)),r})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,n,r=["webkit","moz","o","ms"];for(i=0;i<r.length&&!n;i++)n=t[r[i]+e];return n}function i(e){var i=+new Date,r=Math.max(0,16-(i-n));return n=i+r,t.setTimeout(e,r)}var n=0,o=t.requestAnimationFrame||e("RequestAnimationFrame")||i,a=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};r.Util.requestAnimFrame=function(e,n,a,s){return e=r.bind(e,n),a&&o===i?void e():o.call(t,e,s)},r.Util.cancelAnimFrame=function(e){e&&a.call(t,e)}}(),r.extend=r.Util.extend,r.bind=r.Util.bind,r.stamp=r.Util.stamp,r.setOptions=r.Util.setOptions,r.Class=function(){},r.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=e,e.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(r.extend(e,t.statics),delete t.statics),t.includes&&(r.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=r.extend({},n.options,t.options)),r.extend(n,t),n._initHooks=[];var a=this;return e.__super__=a.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){a.prototype.callInitHooks&&a.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},r.Class.include=function(t){r.extend(this.prototype,t)},r.Class.mergeOptions=function(t){r.extend(this.prototype.options,t)},r.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var o="_leaflet_events";r.Mixin={},r.Mixin.Events={addEventListener:function(t,e,i){if(r.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,a,s,h,l,c,u,d=this[o]=this[o]||{},p=i&&i!==this&&r.stamp(i);for(t=r.Util.splitWords(t),n=0,a=t.length;a>n;n++)s={action:e,context:i||this},h=t[n],p?(l=h+"_idx",c=l+"_len",u=d[l]=d[l]||{},u[p]||(u[p]=[],d[c]=(d[c]||0)+1),u[p].push(s)):(d[h]=d[h]||[],d[h].push(s));return this},hasEventListeners:function(t){var e=this[o];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,i){if(!this[o])return this;if(!t)return this.clearAllEventListeners();if(r.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,a,s,h,l,c,u,d,p,f=this[o],m=i&&i!==this&&r.stamp(i);for(t=r.Util.splitWords(t),n=0,a=t.length;a>n;n++)if(s=t[n],c=s+"_idx",u=c+"_len",d=f[c],e){if(h=m&&d?d[m]:f[s]){for(l=h.length-1;l>=0;l--)h[l].action!==e||i&&h[l].context!==i||(p=h.splice(l,1),p[0].action=r.Util.falseFn);i&&d&&0===h.length&&(delete d[m],f[u]--)}}else delete f[s],delete f[c],delete f[u];return this},clearAllEventListeners:function(){return delete this[o],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,a,s,h,l=r.Util.extend({},e,{type:t,target:this}),c=this[o];if(c[t])for(i=c[t].slice(),n=0,a=i.length;a>n;n++)i[n].action.call(i[n].context,l);s=c[t+"_idx"];for(h in s)if(i=s[h].slice())for(n=0,a=i.length;a>n;n++)i[n].action.call(i[n].context,l);return this},addOneTimeEventListener:function(t,e,i){if(r.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=r.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},r.Mixin.Events.on=r.Mixin.Events.addEventListener,r.Mixin.Events.off=r.Mixin.Events.removeEventListener,r.Mixin.Events.once=r.Mixin.Events.addOneTimeEventListener,r.Mixin.Events.fire=r.Mixin.Events.fireEvent,function(){var n="ActiveXObject"in t,o=n&&!e.addEventListener,a=navigator.userAgent.toLowerCase(),s=-1!==a.indexOf("webkit"),h=-1!==a.indexOf("chrome"),l=-1!==a.indexOf("phantom"),c=-1!==a.indexOf("android"),u=-1!==a.search("android [23]"),d=-1!==a.indexOf("gecko"),p=typeof orientation!=i+"",f=t.navigator&&t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints&&!t.PointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled&&t.navigator.maxTouchPoints||f,g="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,E=e.documentElement,v=n&&"transition"in E.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!u,_="MozPerspective"in E.style,T="OTransition"in E.style,x=!t.L_DISABLE_3D&&(v||y||_||T)&&!l,b=!t.L_NO_TOUCH&&!l&&function(){var t="ontouchstart";if(m||t in E)return!0;var i=e.createElement("div"),n=!1;return i.setAttribute?(i.setAttribute(t,"return;"),"function"==typeof i[t]&&(n=!0),i.removeAttribute(t),i=null,n):!1}();r.Browser={ie:n,ielt9:o,webkit:s,gecko:d&&!s&&!t.opera&&!n,android:c,android23:u,chrome:h,ie3d:v,webkit3d:y,gecko3d:_,opera3d:T,any3d:x,mobile:p,mobileWebkit:p&&s,mobileWebkit3d:p&&y,mobileOpera:p&&t.opera,touch:b,msPointer:f,pointer:m,retina:g}}(),r.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(t){return this.clone()._add(r.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(r.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=r.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=r.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=r.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"
}},r.point=function(t,e,n){return t instanceof r.Point?t:r.Util.isArray(t)?new r.Point(t[0],t[1]):t===i||null===t?t:new r.Point(t,e,n)},r.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;r>n;n++)this.extend(i[n])},r.Bounds.prototype={extend:function(t){return t=r.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof r.Point?r.point(t):r.bounds(t),t instanceof r.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=r.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,a=o.x>=e.x&&n.x<=i.x,s=o.y>=e.y&&n.y<=i.y;return a&&s},isValid:function(){return!(!this.min||!this.max)}},r.bounds=function(t,e){return!t||t instanceof r.Bounds?t:new r.Bounds(t,e)},r.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},r.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new r.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},r.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i];if(!n&&t.currentStyle&&(n=t.currentStyle[i]),(!n||"auto"===n)&&e.defaultView){var r=e.defaultView.getComputedStyle(t,null);n=r?r[i]:null}return"auto"===n?null:n},getViewportOffset:function(t){var i,n=0,o=0,a=t,s=e.body,h=e.documentElement;do{if(n+=a.offsetTop||0,o+=a.offsetLeft||0,n+=parseInt(r.DomUtil.getStyle(a,"borderTopWidth"),10)||0,o+=parseInt(r.DomUtil.getStyle(a,"borderLeftWidth"),10)||0,i=r.DomUtil.getStyle(a,"position"),a.offsetParent===s&&"absolute"===i)break;if("fixed"===i){n+=s.scrollTop||h.scrollTop||0,o+=s.scrollLeft||h.scrollLeft||0;break}if("relative"===i&&!a.offsetLeft){var l=r.DomUtil.getStyle(a,"width"),c=r.DomUtil.getStyle(a,"max-width"),u=a.getBoundingClientRect();("none"!==l||"none"!==c)&&(o+=u.left+a.clientLeft),n+=u.top+(s.scrollTop||h.scrollTop||0);break}a=a.offsetParent}while(a);a=t;do{if(a===s)break;n-=a.scrollTop||0,o-=a.scrollLeft||0,a=a.parentNode}while(a);return new r.Point(o,n)},documentIsLtr:function(){return r.DomUtil._docIsLtrCached||(r.DomUtil._docIsLtrCached=!0,r.DomUtil._docIsLtr="ltr"===r.DomUtil.getStyle(e.body,"direction")),r.DomUtil._docIsLtr},create:function(t,i,n){var r=e.createElement(t);return r.className=i,n&&n.appendChild(r),r},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=r.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=r.Util.splitWords(e),o=0,a=n.length;a>o;o++)t.classList.add(n[o]);else if(!r.DomUtil.hasClass(t,e)){var s=r.DomUtil._getClass(t);r.DomUtil._setClass(t,(s?s+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):r.DomUtil._setClass(t,r.Util.trim((" "+r.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(r){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},getTranslateString:function(t){var e=r.Browser.webkit3d,i="translate"+(e?"3d":"")+"(",n=(e?",0":"")+")";return i+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){var i=r.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),n=" scale("+t+") ";return i+n},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&r.Browser.any3d?t.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),r.DomUtil.TRANSITION_END="webkitTransition"===r.DomUtil.TRANSITION||"OTransition"===r.DomUtil.TRANSITION?r.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)r.extend(r.DomUtil,{disableTextSelection:function(){r.DomEvent.on(t,"selectstart",r.DomEvent.preventDefault)},enableTextSelection:function(){r.DomEvent.off(t,"selectstart",r.DomEvent.preventDefault)}});else{var i=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.extend(r.DomUtil,{disableTextSelection:function(){if(i){var t=e.documentElement.style;this._userSelect=t[i],t[i]="none"}},enableTextSelection:function(){i&&(e.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}r.extend(r.DomUtil,{disableImageDrag:function(){r.DomEvent.on(t,"dragstart",r.DomEvent.preventDefault)},enableImageDrag:function(){r.DomEvent.off(t,"dragstart",r.DomEvent.preventDefault)}})}(),r.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},r.extend(r.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),r.LatLng.prototype={equals:function(t){if(!t)return!1;t=r.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=r.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+r.Util.formatNum(this.lat,t)+", "+r.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=r.latLng(t);var e=6378137,i=r.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*i,o=(t.lng-this.lng)*i,a=this.lat*i,s=t.lat*i,h=Math.sin(n/2),l=Math.sin(o/2),c=h*h+l*l*Math.cos(a)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))},wrap:function(t,e){var i=this.lng;return t=t||-180,e=e||180,i=(i+e)%(e-t)+(t>i||i===e?e:t),new r.LatLng(this.lat,i)}},r.latLng=function(t,e){return t instanceof r.LatLng?t:r.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new r.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new r.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new r.LatLng(t,e)},r.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;r>n;n++)this.extend(i[n])},r.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=r.latLng(t);return t=null!==e?e:r.latLngBounds(t),t instanceof r.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new r.LatLng(t.lat,t.lng),this._northEast=new r.LatLng(t.lat,t.lng)):t instanceof r.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new r.LatLngBounds(new r.LatLng(e.lat-n,e.lng-o),new r.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof r.LatLng?r.latLng(t):r.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof r.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=r.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),a=o.lat>=e.lat&&n.lat<=i.lat,s=o.lng>=e.lng&&n.lng<=i.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=r.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},r.latLngBounds=function(t,e){return!t||t instanceof r.LatLngBounds?t:new r.LatLngBounds(t,e)},r.Projection={},r.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=r.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=t.lng*e,a=n*e;return a=Math.log(Math.tan(Math.PI/4+a/2)),new r.Point(o,a)},unproject:function(t){var e=r.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new r.LatLng(n,i)}},r.Projection.LonLat={project:function(t){return new r.Point(t.lng,t.lat)},unproject:function(t){return new r.LatLng(t.y,t.x)}},r.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return r.point(e,e)}},r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),r.CRS.EPSG3857=r.extend({},r.CRS,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:new r.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),i=6378137;return e.multiplyBy(i)}}),r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"}),r.CRS.EPSG4326=r.extend({},r.CRS,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/360,.5,-1/360,.5)}),r.Map=r.Class.extend({includes:r.Mixin.Events,options:{crs:r.CRS.EPSG3857,fadeAnimation:r.DomUtil.TRANSITION&&!r.Browser.android23,trackResize:!0,markerZoomAnimation:r.DomUtil.TRANSITION&&r.Browser.any3d},initialize:function(t,e){e=r.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=r.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(r.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(r.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),a=t instanceof r.Point?t:this.latLngToContainerPoint(t),s=a.subtract(o).multiplyBy(1-1/n),h=this.containerPointToLatLng(o.add(s));return this.setView(h,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():r.latLngBounds(t);var i=r.point(e.paddingTopLeft||e.padding||[0,0]),n=r.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n)),a=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),h=this.project(t.getNorthEast(),o),l=this.unproject(s.add(h).divideBy(2).add(a),o);return o=e&&e.maxZoom?Math.min(e.maxZoom,o):o,this.setView(l,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(r.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=r.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=r.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=r.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?r.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=r.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),a=n.subtract(o);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new r.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=r.latLngBounds(t);var n,o=this.getMinZoom()-(e?1:0),a=this.getMaxZoom(),s=this.getSize(),h=t.getNorthWest(),l=t.getSouthEast(),c=!0;i=r.point(i||[0,0]);do o++,n=this.project(l,o).subtract(this.project(h,o)).add(i),c=e?n.x<s.x||n.y<s.y:s.contains(n);while(c&&a>=o);return c&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new r.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new r.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(r.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(r.point(t),e)},layerPointToLatLng:function(t){var e=r.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(r.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return r.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return r.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(r.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(t)))},mouseEventToContainerPoint:function(t){return r.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=r.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;r.DomUtil.addClass(t,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=r.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(r.DomUtil.addClass(t.markerPane,e),r.DomUtil.addClass(t.shadowPane,e),r.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return r.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?r.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var o=this._zoom!==e;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):r.DomUtil.setPosition(this._mapPane,new r.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var a=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),a&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,r=this._getZoomSpan();for(t in this._zoomBoundLayers){var o=this._zoomBoundLayers[t];isNaN(o.options.minZoom)||(e=Math.min(e,o.options.minZoom)),isNaN(o.options.maxZoom)||(n=Math.max(n,o.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),r!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(r.DomEvent){e=e||"on",r.DomEvent[e](this._container,"click",this._onMouseClick,this);var i,n,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=o.length;n>i;i++)r.DomEvent[e](this._container,o[i],this._fireMouseEvent,this);this.options.trackResize&&r.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||r.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!r.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&r.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),o=this.layerPointToLatLng(n);this.fire(e,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),a=new r.Bounds(n.subtract(o),n.add(o)),s=this._getBoundsOffset(a,i,e);return this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new r.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),o=this.project(e.getSouthEast(),i).subtract(t.max),a=this._rebound(n.x,-o.x),s=this._rebound(n.y,-o.y);return new r.Point(a,s)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),r.map=function(t,e){return new r.Map(t,e)},r.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=r.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=this.R_MAJOR,a=this.R_MINOR,s=t.lng*e*o,h=n*e,l=a/o,c=Math.sqrt(1-l*l),u=c*Math.sin(h);u=Math.pow((1-u)/(1+u),.5*c);var d=Math.tan(.5*(.5*Math.PI-h))/u;return h=-o*Math.log(d),new r.Point(s,h)},unproject:function(t){for(var e,i=r.LatLng.RAD_TO_DEG,n=this.R_MAJOR,o=this.R_MINOR,a=t.x*i/n,s=o/n,h=Math.sqrt(1-s*s),l=Math.exp(-t.y/n),c=Math.PI/2-2*Math.atan(l),u=15,d=1e-7,p=u,f=.1;Math.abs(f)>d&&--p>0;)e=h*Math.sin(c),f=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*h))-c,c+=f;return new r.LatLng(c*i,a)}},r.CRS.EPSG3395=r.extend({},r.CRS,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var t=r.Projection.Mercator,e=t.R_MAJOR,i=.5/(Math.PI*e);return new r.Transformation(i,.5,-i,.5)}()}),r.TileLayer=r.Class.extend({includes:r.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:r.Browser.mobile,updateWhenIdle:r.Browser.mobile},initialize:function(t,e){e=r.setOptions(this,e),e.detectRetina&&r.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=r.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=r.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,r,o=t.children,a=-e(1/0,-1/0);for(n=0,r=o.length;r>n;n++)o[n]!==this._container&&(i=parseInt(o[n].style.zIndex,10),isNaN(i)||(a=e(a,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(a)?a:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(r.Browser.ielt9)for(t in e)r.DomUtil.setOpacity(e[t],this.options.opacity);else r.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=r.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=r.DomUtil.create("div",e,this._container),this._tileContainer=r.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&e>i&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var o=r.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var i,n,o,a=[],s=t.getCenter();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)o=new r.Point(n,i),this._tileShouldBeLoaded(o)&&a.push(o);var h=a.length;if(0!==h){a.sort(function(t,e){return t.distanceTo(s)-e.distanceTo(s)});var l=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h,n=0;h>n;n++)this._addTile(a[n],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=e.tileSize,r=t.multiplyBy(n),o=r.add([n,n]),a=this._map.unproject(r),s=this._map.unproject(o);if(e.continuousWorld||e.noWrap||(a=a.wrap(),s=s.wrap()),!e.bounds.intersects([a,s]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,r;for(r in this._tiles)e=r.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(r)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(r.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),r.Browser.android||(e.onload=null,e.src=r.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();r.DomUtil.setPosition(n,i,r.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return r.Util.template(this._url,r.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=r.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=r.Util.falseFn,r.Browser.ielt9&&this.options.opacity!==i&&r.DomUtil.setOpacity(t,this.options.opacity),r.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&r.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(r.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==r.Util.emptyImageUrl&&(r.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()
}}),r.tileLayer=function(t,e){return new r.TileLayer(t,e)},r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=r.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;i.width=i.height=e.detectRetina&&r.Browser.retina?2*n:n;for(var o in e)this.options.hasOwnProperty(o)||"crs"===o||(i[o]=e[o]);this.wmsParams=i,r.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,r.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),o=n.add([i,i]),a=this._crs.project(e.unproject(n,t.z)),s=this._crs.project(e.unproject(o,t.z)),h=this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[s.y,a.x,a.y,s.x].join(","):[a.x,s.y,s.x,a.y].join(","),l=r.Util.template(this._url,{s:this._getSubdomain(t)});return l+r.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+h},setParams:function(t,e){return r.extend(this.wmsParams,t),e||this.redraw(),this}}),r.tileLayer.wms=function(t,e){return new r.TileLayer.WMS(t,e)},r.TileLayer.Canvas=r.TileLayer.extend({options:{async:!1},initialize:function(t){r.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=r.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=r.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),r.tileLayer.canvas=function(t){return new r.TileLayer.Canvas(t)},r.ImageOverlay=r.Class.extend({includes:r.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=r.latLngBounds(e),r.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=r.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&r.Browser.any3d?r.DomUtil.addClass(this._image,"leaflet-zoom-animated"):r.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),r.extend(this._image,{galleryimg:"no",onselectstart:r.Util.falseFn,onmousemove:r.Util.falseFn,onload:r.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),a=this._bounds.getSouthEast(),s=e._latLngToNewLayerPoint(o,t.zoom,t.center),h=e._latLngToNewLayerPoint(a,t.zoom,t.center)._subtract(s),l=s._add(h._multiplyBy(.5*(1-1/n)));i.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(l)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);r.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}}),r.imageOverlay=function(t,e,i){return new r.ImageOverlay(t,e,i)},r.Icon=r.Class.extend({options:{className:""},initialize:function(t){r.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n;return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i,n=this.options,o=r.point(n[e+"Size"]);i=r.point("shadow"===e?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!i&&o&&(i=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return r.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),r.icon=function(t){return new r.Icon(t)},r.Icon.Default=r.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];r.Browser.retina&&"icon"===t&&(t+="-2x");var i=r.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),r.Icon.Default.imagePath=function(){var t,i,n,r,o,a=e.getElementsByTagName("script"),s=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,i=a.length;i>t;t++)if(n=a[t].src,r=n.match(s))return o=n.split(s)[0],(o?o+"/":"")+"images"}(),r.Marker=r.Class.extend({includes:r.Mixin.Events,options:{icon:new r.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){r.setOptions(this,e),this._latlng=r.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e=this._map,i=e.options.zoomAnimation&&e.options.markerZoomAnimation,n=i?"leaflet-zoom-animated":"leaflet-zoom-hide",o=t.icon.createIcon(this._icon),a=!1;o!==this._icon&&(this._icon&&this._removeIcon(),a=!0,t.title&&(o.title=t.title),t.alt&&(o.alt=t.alt)),r.DomUtil.addClass(o,n),t.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),t.riseOnHover&&r.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var s=t.icon.createShadow(this._shadow),h=!1;s!==this._shadow&&(this._removeShadow(),h=!0),s&&r.DomUtil.addClass(s,n),this._shadow=s,t.opacity<1&&this._updateOpacity();var l=this._map._panes;a&&l.markerPane.appendChild(this._icon),s&&h&&l.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&r.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){r.DomUtil.setPosition(this._icon,t),this._shadow&&r.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];r.DomUtil.addClass(t,"leaflet-clickable"),r.DomEvent.on(t,"click",this._onMouseClick,this),r.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)r.DomEvent.on(t,e[i],this._fireMouseEvent,this);r.Handler.MarkerDrag&&(this.dragging=new r.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&r.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&r.DomEvent.preventDefault(t),"mousedown"!==t.type?r.DomEvent.stopPropagation(t):r.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){r.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&r.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),r.marker=function(t,e){return new r.Marker(t,e)},r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;return i.innerHTML=n.html!==!1?n.html:"",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),r.divIcon=function(t){return new r.DivIcon(t)},r.Map.mergeOptions({closePopupOnClick:!0}),r.Popup=r.Class.extend({includes:r.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){r.setOptions(this,t),this._source=e,this._animated=r.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&r.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&r.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),r.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&r.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=r.DomUtil.create("div",i);this.options.closeButton&&(t=this._closeButton=r.DomUtil.create("a",e+"-close-button",n),t.href="#close",t.innerHTML="&#215;",r.DomEvent.disableClickPropagation(t),r.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=r.DomUtil.create("div",e+"-content-wrapper",n);r.DomEvent.disableClickPropagation(o),this._contentNode=r.DomUtil.create("div",e+"-content",o),r.DomEvent.disableScrollPropagation(this._contentNode),r.DomEvent.on(o,"contextmenu",r.DomEvent.stopPropagation),this._tipContainer=r.DomUtil.create("div",e+"-tip-container",n),this._tip=r.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,a="leaflet-popup-scrolled";o&&n>o?(e.height=o+"px",r.DomUtil.addClass(t,a)):r.DomUtil.removeClass(t,a),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=r.point(this.options.offset);e&&r.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);r.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new r.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(r.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(n),a=r.point(this.options.autoPanPadding),s=r.point(this.options.autoPanPaddingTopLeft||a),h=r.point(this.options.autoPanPaddingBottomRight||a),l=t.getSize(),c=0,u=0;o.x+i+h.x>l.x&&(c=o.x+i-l.x+h.x),o.x-c-s.x<0&&(c=o.x-s.x),o.y+e+h.y>l.y&&(u=o.y+e-l.y+h.y),o.y-u-s.y<0&&(u=o.y-s.y),(c||u)&&t.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(t){this._close(),r.DomEvent.stop(t)}}),r.popup=function(t,e){return new r.Popup(t,e)},r.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof r.Popup)){var n=t;t=new r.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),r.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=r.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(r.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=r.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof r.Popup?(r.setOptions(t,e),this._popup=t):this._popup=new r.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),r.LayerGroup=r.Class.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r.stamp(t)}}),r.layerGroup=function(t){return new r.LayerGroup(t)},r.FeatureGroup=r.LayerGroup.extend({includes:r.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.off(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new r.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof r.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=r.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),r.featureGroup=function(t){return new r.FeatureGroup(t)},r.Path=r.Class.extend({includes:[r.Mixin.Events],statics:{CLIP_PADDING:function(){var e=r.Browser.mobile?1280:2e3,i=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){r.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,r.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return r.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),r.Map.include({_updatePathViewport:function(){var t=r.Path.CLIP_PADDING,e=this.getSize(),i=r.DomUtil.getPosition(this._mapPane),n=i.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),o=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new r.Bounds(n,o)}}),r.Path.SVG_NS="http://www.w3.org/2000/svg",r.Browser.svg=!(!e.createElementNS||!e.createElementNS(r.Path.SVG_NS,"svg").createSVGRect),r.Path=r.Path.extend({statics:{SVG:r.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(r.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&r.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(r.Browser.svg||!r.Browser.vml)&&r.DomUtil.addClass(this._path,"leaflet-clickable"),r.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)r.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),o=e.layerPointToLatLng(n);this.fire(t.type,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&r.DomEvent.preventDefault(t),"mousemove"!==t.type&&r.DomEvent.stopPropagation(t)}}}),r.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=r.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&r.Browser.any3d?(r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,o=i.y-e.y,a=this._pathRoot,s=this._panes.overlayPane;r.Browser.mobileWebkit&&s.removeChild(a),r.DomUtil.setPosition(a,e),a.setAttribute("width",n),a.setAttribute("height",o),a.setAttribute("viewBox",[e.x,e.y,n,o].join(" ")),r.Browser.mobileWebkit&&s.appendChild(a)}}}),r.Path.include({bindPopup:function(t,e){return t instanceof r.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new r.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),r.Browser.vml=!r.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),r.Path=r.Browser.svg||!r.Browser.vml?r.Path:r.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");r.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&r.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,t.dashStyle=i.dashArray?r.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):"",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),r.Map.include(r.Browser.svg||!r.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),r.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),r.Path=r.Path.SVG&&!t.L_PREFER_CANVAS||!r.Browser.canvas?r.Path:r.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return r.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!r.Path._updateRequest&&(r.Path._updateRequest=r.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){r.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,i,n,o,a;for(this._ctx.beginPath(),t=0,i=this._parts.length;i>t;t++){for(e=0,n=this._parts[t].length;n>e;e++)o=this._parts[t][e],a=(0===e?"move":"line")+"To",this._ctx[a](o.x,o.y);this instanceof r.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill()),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),r.Map.include(r.Path.SVG&&!t.L_PREFER_CANVAS||!r.Browser.canvas?{}:{_initPathRoot:function(){var t,i=this._pathRoot;i||(i=this._pathRoot=e.createElement("canvas"),i.style.position="absolute",t=this._canvasCtx=i.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;r.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),r.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,r=typeof Uint8Array!=i+""?Uint8Array:Array,o=new r(n);o[0]=o[n-1]=1,this._simplifyDPStep(t,o,e,0,n-1);var a,s=[];for(a=0;n>a;a++)o[a]&&s.push(t[a]);return s},_simplifyDPStep:function(t,e,i,n,r){var o,a,s,h=0;for(a=n+1;r-1>=a;a++)s=this._sqClosestPointOnSegment(t[a],t[n],t[r],!0),s>h&&(o=a,h=s);h>i&&(e[o]=1,this._simplifyDPStep(t,e,i,n,o),this._simplifyDPStep(t,e,i,o,r))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,r=0,o=t.length;o>n;n++)this._sqDist(t[n],t[r])>e&&(i.push(t[n]),r=n);return o-1>r&&i.push(t[o-1]),i},clipSegment:function(t,e,i,n){var r,o,a,s=n?this._lastCode:this._getBitCode(t,i),h=this._getBitCode(e,i);for(this._lastCode=h;;){if(!(s|h))return[t,e];if(s&h)return!1;r=s||h,o=this._getEdgeIntersection(t,e,r,i),a=this._getBitCode(o,i),r===s?(t=o,s=a):(e=o,h=a)}},_getEdgeIntersection:function(t,e,i,n){var o=e.x-t.x,a=e.y-t.y,s=n.min,h=n.max;
return 8&i?new r.Point(t.x+o*(h.y-t.y)/a,h.y):4&i?new r.Point(t.x+o*(s.y-t.y)/a,s.y):2&i?new r.Point(h.x,t.y+a*(h.x-t.x)/o):1&i?new r.Point(s.x,t.y+a*(s.x-t.x)/o):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,a=e.x,s=e.y,h=i.x-a,l=i.y-s,c=h*h+l*l;return c>0&&(o=((t.x-a)*h+(t.y-s)*l)/c,o>1?(a=i.x,s=i.y):o>0&&(a+=h*o,s+=l*o)),h=t.x-a,l=t.y-s,n?h*h+l*l:new r.Point(a,s)}},r.Polyline=r.Path.extend({initialize:function(t,e){r.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(r.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,o=this._parts,a=null,s=0,h=o.length;h>s;s++)for(var l=o[s],c=1,u=l.length;u>c;c++){e=l[c-1],i=l[c];var d=r.LineUtil._sqClosestPointOnSegment(t,e,i,!0);n>d&&(n=d,a=r.LineUtil._sqClosestPointOnSegment(t,e,i))}return a&&(a.distance=Math.sqrt(n)),a},getBounds:function(){return new r.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,o=e?t:[];for(i=0,n=t.length;n>i;i++){if(r.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;o[i]=r.latLng(t[i])}return o},_initEvents:function(){r.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=r.Path.VML,n=0,o=t.length,a="";o>n;n++)e=t[n],i&&e._round(),a+=(n?"L":"M")+e.x+" "+e.y;return a},_clipPoints:function(){var t,e,i,n=this._originalPoints,o=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var a=this._parts,s=this._map._pathViewport,h=r.LineUtil;for(t=0,e=0;o-1>t;t++)i=h.clipSegment(n[t],n[t+1],s,t),i&&(a[e]=a[e]||[],a[e].push(i[0]),(i[1]!==n[t+1]||t===o-2)&&(a[e].push(i[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=r.LineUtil,i=0,n=t.length;n>i;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),r.Path.prototype._updatePath.call(this))}}),r.polyline=function(t,e){return new r.Polyline(t,e)},r.PolyUtil={},r.PolyUtil.clipPolygon=function(t,e){var i,n,o,a,s,h,l,c,u,d=[1,4,2,8],p=r.LineUtil;for(n=0,l=t.length;l>n;n++)t[n]._code=p._getBitCode(t[n],e);for(a=0;4>a;a++){for(c=d[a],i=[],n=0,l=t.length,o=l-1;l>n;o=n++)s=t[n],h=t[o],s._code&c?h._code&c||(u=p._getEdgeIntersection(h,s,c,e),u._code=p._getBitCode(u,e),i.push(u)):(h._code&c&&(u=p._getEdgeIntersection(h,s,c,e),u._code=p._getBitCode(u,e),i.push(u)),i.push(s));t=i}return t},r.Polygon=r.Polyline.extend({options:{fill:!0},initialize:function(t,e){r.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;i>e;e++)n=this._holes[e]=this._convertLatLngs(this._holes[e]),n[0].equals(n[n.length-1])&&n.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(r.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,i,n;for(t=0,i=this._holes.length;i>t;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;n>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):r.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;n>i;i++){var o=r.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){var e=r.Polyline.prototype._getPathPartStr.call(this,t);return e+(r.Browser.svg?"z":"x")}}),r.polygon=function(t,e){return new r.Polygon(t,e)},function(){function t(t){return r.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){n>i?t.setLatLngs(e[i++]):this.removeLayer(t)},this);n>i;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}r.MultiPolyline=t(r.Polyline),r.MultiPolygon=t(r.Polygon),r.multiPolyline=function(t,e){return new r.MultiPolyline(t,e)},r.multiPolygon=function(t,e){return new r.MultiPolygon(t,e)}}(),r.Rectangle=r.Polygon.extend({initialize:function(t,e){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=r.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),r.rectangle=function(t,e){return new r.Rectangle(t,e)},r.Circle=r.Path.extend({initialize:function(t,e,i){r.Path.prototype.initialize.call(this,i),this._latlng=r.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=r.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new r.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":r.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(r.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),r.circle=function(t,e,i){return new r.Circle(t,e,i)},r.CircleMarker=r.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){r.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){r.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return r.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),r.circleMarker=function(t,e){return new r.CircleMarker(t,e)},r.Polyline.include(r.Path.CANVAS?{_containsPoint:function(t,e){var i,n,o,a,s,h,l,c=this.options.weight/2;for(r.Browser.touch&&(c+=10),i=0,a=this._parts.length;a>i;i++)for(l=this._parts[i],n=0,s=l.length,o=s-1;s>n;o=n++)if((e||0!==n)&&(h=r.LineUtil.pointToSegmentDistance(t,l[o],l[n]),c>=h))return!0;return!1}}:{}),r.Polygon.include(r.Path.CANVAS?{_containsPoint:function(t){var e,i,n,o,a,s,h,l,c=!1;if(r.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,h=this._parts.length;h>o;o++)for(e=this._parts[o],a=0,l=e.length,s=l-1;l>a;s=a++)i=e[a],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c}}:{}),r.Circle.include(r.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),r.CircleMarker.include(r.Path.CANVAS?{_updateStyle:function(){r.Path.prototype._updateStyle.call(this)}}:{}),r.GeoJSON=r.FeatureGroup.extend({initialize:function(t,e){r.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=r.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;i>e;e++)n=o[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(o[e]);return this}var a=this.options;if(!a.filter||a.filter(t)){var s=r.GeoJSON.geometryToLayer(t,a.pointToLayer,a.coordsToLatLng,a);return s.feature=r.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),a.onEachFeature&&a.onEachFeature(t,s),this.addLayer(s)}},resetStyle:function(t){var e=this.options.style;e&&(r.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),r.extend(r.GeoJSON,{geometryToLayer:function(t,e,i,n){var o,a,s,h,l="Feature"===t.type?t.geometry:t,c=l.coordinates,u=[];switch(i=i||this.coordsToLatLng,l.type){case"Point":return o=i(c),e?e(t,o):new r.Marker(o);case"MultiPoint":for(s=0,h=c.length;h>s;s++)o=i(c[s]),u.push(e?e(t,o):new r.Marker(o));return new r.FeatureGroup(u);case"LineString":return a=this.coordsToLatLngs(c,0,i),new r.Polyline(a,n);case"Polygon":if(2===c.length&&!c[1].length)throw new Error("Invalid GeoJSON object.");return a=this.coordsToLatLngs(c,1,i),new r.Polygon(a,n);case"MultiLineString":return a=this.coordsToLatLngs(c,1,i),new r.MultiPolyline(a,n);case"MultiPolygon":return a=this.coordsToLatLngs(c,2,i),new r.MultiPolygon(a,n);case"GeometryCollection":for(s=0,h=l.geometries.length;h>s;s++)u.push(this.geometryToLayer({geometry:l.geometries[s],type:"Feature",properties:t.properties},e,i,n));return new r.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new r.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,r,o,a=[];for(r=0,o=t.length;o>r;r++)n=e?this.coordsToLatLngs(t[r],e-1,i):(i||this.coordsToLatLng)(t[r]),a.push(n);return a},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(r.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?r.extend({},t.feature,{geometry:e}):r.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var a={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(a),r.Circle.include(a),r.CircleMarker.include(a),r.Polyline.include({toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"LineString",coordinates:r.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),r.Polygon.include({toGeoJSON:function(){var t,e,i,n=[r.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)i=r.GeoJSON.latLngsToCoords(this._holes[t]),i.push(i[0]),n.push(i);return r.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),r.GeoJSON.getFeature(this,{type:t,coordinates:e})}}r.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),r.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),r.LayerGroup.include({toGeoJSON:function(){var e,i=this.feature&&this.feature.geometry,n=[];if(i&&"MultiPoint"===i.type)return t("MultiPoint").call(this);var o=i&&"GeometryCollection"===i.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(o?e.geometry:r.GeoJSON.asFeature(e)))}),o?r.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),r.geoJson=function(t,e){return new r.GeoJSON(t,e)},r.DomEvent={addListener:function(t,e,i,n){var o,a,s,h=r.stamp(i),l="_leaflet_"+e+h;return t[l]?this:(o=function(e){return i.call(n||t,e||r.DomEvent._getEvent())},r.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,o,h):(r.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,o,h),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(a=o,s="mouseenter"===e?"mouseover":"mouseout",o=function(e){return r.DomEvent._checkMouse(t,e)?a(e):void 0},t.addEventListener(s,o,!1)):"click"===e&&r.Browser.android?(a=o,o=function(t){return r.DomEvent._filterClick(t,a)},t.addEventListener(e,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[l]=o,this))},removeListener:function(t,e,i){var n=r.stamp(i),o="_leaflet_"+e+n,a=t[o];return a?(r.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):r.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",a,!1),t.removeEventListener(e,a,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",a,!1):t.removeEventListener(e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,r.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=r.DomEvent.stopPropagation;return r.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=r.DomEvent.stopPropagation,i=r.Draggable.START.length-1;i>=0;i--)r.DomEvent.on(t,r.Draggable.START[i],e);return r.DomEvent.on(t,"click",r.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return r.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new r.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new r.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){r.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(e=i.arguments[0],!e||t.Event!==e.constructor);)i=i.caller;return e},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=r.DomEvent._lastClick&&i-r.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void r.DomEvent.stop(t):(r.DomEvent._lastClick=i,e(t))}},r.DomEvent.on=r.DomEvent.addListener,r.DomEvent.off=r.DomEvent.removeListener,r.Draggable=r.Class.extend({includes:r.Mixin.Events,statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.on(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.off(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(r.DomEvent.stopPropagation(t),r.Draggable._disabled||(r.DomUtil.disableImageDrag(),r.DomUtil.disableTextSelection(),this._moving)))){var i=t.touches?t.touches[0]:t;this._startPoint=new r.Point(i.clientX,i.clientY),this._startPos=this._newPos=r.DomUtil.getPosition(this._element),r.DomEvent.on(e,r.Draggable.MOVE[t.type],this._onMove,this).on(e,r.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var i=t.touches&&1===t.touches.length?t.touches[0]:t,n=new r.Point(i.clientX,i.clientY),o=n.subtract(this._startPoint);(o.x||o.y)&&(r.Browser.touch&&Math.abs(o.x)+Math.abs(o.y)<3||(r.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=r.DomUtil.getPosition(this._element).subtract(o),r.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),r.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){r.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in r.Draggable.MOVE)r.DomEvent.off(e,r.Draggable.MOVE[t],this._onMove).off(e,r.Draggable.END[t],this._onUp);r.DomUtil.enableImageDrag(),r.DomUtil.enableTextSelection(),this._moved&&this._moving&&(r.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),r.Handler=r.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),r.Map.mergeOptions({dragging:!0,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:r.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new r.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,r=(n-e+i)%t+e-i,o=(n+e+i)%t-e-i,a=Math.abs(r+i)<Math.abs(o+i)?r:o;this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,o=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),s=(this._lastTime+n-this._times[0])/1e3,h=i.easeLinearity,l=a.multiplyBy(h/s),c=l.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,c),d=l.multiplyBy(u/c),p=u/(i.inertiaDeceleration*h),f=d.multiplyBy(-p/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),r.Util.requestAnimFrame(function(){e.panBy(f,{duration:p,easeLinearity:h,noMoveStart:!0})})):e.fire("moveend")}}}),r.Map.addInitHook("addHandler","dragging",r.Map.Drag),r.Map.mergeOptions({doubleClickZoom:!0}),r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom),r.Map.mergeOptions({scrollWheelZoom:!0}),r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),r.DomEvent.on(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault),this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),r.DomEvent.off(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=r.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r.bind(this._performZoom,this),i),r.DomEvent.preventDefault(t),r.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom),r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,i,n){function o(t){var e;if(r.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(s||i);h=t.touches?t.touches[0]:t,l=n>0&&c>=n,s=i}}function a(t){if(r.Browser.pointer){var e=f.indexOf(t.pointerId);if(-1===e)return;f.splice(e,1)}if(l){if(r.Browser.pointer){var n,o={};for(var a in h)n=h[a],o[a]="function"==typeof n?n.bind(h):n;h=o}h.type="dblclick",i(h),s=null}}var s,h,l=!1,c=250,u="_leaflet_",d=this._touchstart,p=this._touchend,f=[];t[u+d+n]=o,t[u+p+n]=a;var m=r.Browser.pointer?e.documentElement:t;return t.addEventListener(d,o,!1),m.addEventListener(p,a,!1),r.Browser.pointer&&m.addEventListener(r.DomEvent.POINTER_CANCEL,a,!1),this},removeDoubleTapListener:function(t,i){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+i],!1),(r.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+i],!1),r.Browser.pointer&&e.documentElement.removeEventListener(r.DomEvent.POINTER_CANCEL,t[n+this._touchend+i],!1),this}}),r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,i,n,o){var a="_leaflet_",s=this._pointers,h=function(t){r.DomEvent.preventDefault(t);for(var e=!1,i=0;i<s.length;i++)if(s[i].pointerId===t.pointerId){e=!0;break}e||s.push(t),t.touches=s.slice(),t.changedTouches=[t],n(t)};if(t[a+"touchstart"+o]=h,t.addEventListener(this.POINTER_DOWN,h,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,l,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function r(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a[e]=t;break}t.touches=a.slice(),t.changedTouches=[t],i(t)}}var o="_leaflet_",a=this._pointers;return t[o+"touchmove"+n]=r,t.addEventListener(this.POINTER_MOVE,r,!1),this},addPointerListenerEnd:function(t,e,i,n){var r="_leaflet_",o=this._pointers,a=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}t.touches=o.slice(),t.changedTouches=[t],i(t)};return t[r+"touchend"+n]=a,t.addEventListener(this.POINTER_UP,a,!1),t.addEventListener(this.POINTER_CANCEL,a,!1),this},removePointerListener:function(t,e,i){var n="_leaflet_",r=t[n+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,r,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,r,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,r,!1),t.removeEventListener(this.POINTER_CANCEL,r,!1)}return this}}),r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:!0}),r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(t.touches[0]),o=i.mouseEventToLayerPoint(t.touches[1]),a=i._getCenterLayerPoint();this._startCenter=n.add(o)._divideBy(2),this._startDist=n.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=a.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),r.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),r.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(r.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),r.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,r.DomUtil.removeClass(t._mapPane,"leaflet-touching"),r.Util.cancelAnimFrame(this._animRequest),r.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=t.layerPointToLatLng(i),o=t.getZoom(),a=t.getScaleZoom(this._scale)-o,s=a>0?Math.ceil(a):Math.floor(a),h=t._limitZoom(o+s),l=t.getZoomScale(h)/this._scale;t._animateZoom(n,h,i,l)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom),r.Map.mergeOptions({tap:!0,tapTolerance:15}),r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(r.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new r.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&r.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(r.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),r.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),r.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&r.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new r.Point(e.clientX,e.clientY)},_simulateEvent:function(i,n){var r=e.createEvent("MouseEvents");r._simulated=!0,n.target._simulatedClick=!0,r.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(r)}}),r.Browser.touch&&!r.Browser.pointer&&r.Map.addInitHook("addHandler","tap",r.Map.Tap),r.Map.mergeOptions({boxZoom:!0}),r.Map.BoxZoom=r.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(r.DomUtil.disableTextSelection(),r.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void r.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=r.DomUtil.create("div","leaflet-zoom-box",this._pane),r.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),o=n.subtract(e),a=new r.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));r.DomUtil.setPosition(i,a),this._moved=!0,i.style.width=Math.max(0,Math.abs(o.x)-4)+"px",i.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),r.DomUtil.enableTextSelection(),r.DomUtil.enableImageDrag(),r.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new r.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom),r.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)
},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),r.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;r.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,r=i.scrollTop||n.scrollTop,o=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(o,r)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},r=this.keyCodes;for(e=0,i=r.left.length;i>e;e++)n[r.left[e]]=[-1*t,0];for(e=0,i=r.right.length;i>e;e++)n[r.right[e]]=[t,0];for(e=0,i=r.down.length;i>e;e++)n[r.down[e]]=[0,t];for(e=0,i=r.up.length;i>e;e++)n[r.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},r=this.keyCodes;for(e=0,i=r.zoomIn.length;i>e;e++)n[r.zoomIn[e]]=t;for(e=0,i=r.zoomOut.length;i>e;e++)n[r.zoomOut[e]]=-t},_addHooks:function(){r.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}r.DomEvent.stop(t)}}),r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard),r.Handler.MarkerDrag=r.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new r.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),r.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=r.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&r.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),r.Control=r.Class.extend({options:{position:"topright"},initialize:function(t){r.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return r.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),i=t._controlCorners[e];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),r.control=function(t){return new r.Control(t)},r.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var a=i+t+" "+i+o;e[t+o]=r.DomUtil.create("div",a,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=r.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=r.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,o,a){var s=r.DomUtil.create("a",i,n);s.innerHTML=t,s.href="#",s.title=e;var h=r.DomEvent.stopPropagation;return r.DomEvent.on(s,"click",h).on(s,"mousedown",h).on(s,"dblclick",h).on(s,"click",r.DomEvent.preventDefault).on(s,"click",o,a).on(s,"click",this._refocusOnMap,a),s},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,e),r.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&r.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&r.DomUtil.addClass(this._zoomInButton,e)}}),r.Map.mergeOptions({zoomControl:!0}),r.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new r.Control.Zoom,this.addControl(this.zoomControl))}),r.control.zoom=function(t){return new r.Control.Zoom(t)},r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){r.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=r.DomUtil.create("div","leaflet-control-attribution"),r.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),r.Map.mergeOptions({attributionControl:!0}),r.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new r.Control.Attribution).addTo(this))}),r.control.attribution=function(t){return new r.Control.Attribution(t)},r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=r.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=r.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=r.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180),n=i*(t.getNorthEast().lng-t.getSouthWest().lng)/180,r=this._map.getSize(),o=this.options,a=0;r.x>0&&(a=n*(o.maxWidth/r.x)),this._updateScales(o,a)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,r=3.2808399*t,o=this._iScale;r>5280?(e=r/5280,i=this._getRoundNum(e),o.style.width=this._getScaleWidth(i/e)+"px",o.innerHTML=i+" mi"):(n=this._getRoundNum(r),o.style.width=this._getScaleWidth(n/r)+"px",o.innerHTML=n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),r.control.scale=function(t){return new r.Control.Scale(t)},r.Control.Layers=r.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){r.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=r.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=r.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),r.Browser.touch?r.DomEvent.on(e,"click",r.DomEvent.stopPropagation):r.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=r.DomUtil.create("form",t+"-list");if(this.options.collapsed){r.Browser.android||r.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=r.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",r.Browser.touch?r.DomEvent.on(n,"click",r.DomEvent.stop).on(n,"click",this._expand,this):r.DomEvent.on(n,"focus",this._expand,this),r.DomEvent.on(i,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=r.DomUtil.create("div",t+"-base",i),this._separator=r.DomUtil.create("div",t+"-separator",i),this._overlaysList=r.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=r.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[r.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';i&&(n+=' checked="checked"'),n+="/>";var r=e.createElement("div");return r.innerHTML=n,r.firstChild},_addItem:function(t){var i,n=e.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=o):i=this._createRadioElement("leaflet-base-layers",o),i.layerId=r.stamp(t.layer),r.DomEvent.on(i,"click",this._onInputClick,this);var a=e.createElement("span");a.innerHTML=" "+t.name,n.appendChild(i),n.appendChild(a);var s=t.overlay?this._overlaysList:this._baseLayersList;return s.appendChild(n),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),r=n.length;for(this._handlingClick=!0,t=0;r>t;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),r.control.layers=function(t,e,i){return new r.Control.Layers(t,e,i)},r.PosAnimation=r.Class.extend({includes:r.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[r.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",r.DomEvent.on(t,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),r.DomUtil.setPosition(t,e),r.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(r.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(r.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),r.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,i,n,o=this._el,a=t.getComputedStyle(o);if(r.Browser.any3d){if(n=a[r.DomUtil.TRANSFORM].match(this._transformRe),!n)return;e=parseFloat(n[1]),i=parseFloat(n[2])}else e=parseFloat(a.left),i=parseFloat(a.top);return new r.Point(e,i,!0)},_onTransitionEnd:function(){r.DomEvent.off(this._el,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[r.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),r.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(r.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=r.extend({animate:n.animate},n.zoom),n.pan=r.extend({animate:n.animate},n.pan));var o=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=r.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new r.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),r.PosAnimation=r.DomUtil.TRANSITION?r.PosAnimation:r.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=r.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));r.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),r.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),r.DomUtil.TRANSITION&&r.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.android23&&!r.Browser.mobileOpera,this._zoomAnimated&&r.DomEvent.on(this._mapPane,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),r.Map.include(r.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/n),o=this._getCenterLayerPoint()._add(r);return i.animate===!0||this.getSize().contains(r)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,o,n,null,!0),!0):!1},_animateZoom:function(t,e,i,n,o,a,s){s||(this._animatingZoom=!0),r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,r.Draggable&&(r.Draggable._disabled=!0),r.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:o,backwards:a})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),r.Draggable&&(r.Draggable._disabled=!1)}}:{}),r.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=r.DomUtil.TRANSFORM,n=t.delta?r.DomUtil.getTranslateString(t.delta):e.style[i],o=r.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?o+" "+n:n+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),r.Util.falseFn(e.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[r.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&i>.5&&.5>n?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[r.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),r=0;for(e=0,i=n.length;i>e;e++)n[e].complete&&r++;return r/i},_stopLoadingImages:function(t){var e,i,n,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=o.length;i>e;e++)n=o[e],n.complete||(n.onload=r.Util.falseFn,n.onerror=r.Util.falseFn,n.src=r.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),r.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=r.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=r.bind(this._handleGeolocationResponse,this),i=r.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new r.LatLng(e,i),o=180*t.coords.accuracy/40075017,a=o/Math.cos(r.LatLng.DEG_TO_RAD*e),s=r.latLngBounds([e-o,i-a],[e+o,i+a]),h=this._locateOptions;if(h.setView){var l=Math.min(this.getBoundsZoom(s),h.maxZoom);this.setView(n,l)}var c={latlng:n,bounds:s,timestamp:t.timestamp};for(var u in t.coords)"number"==typeof t.coords[u]&&(c[u]=t.coords[u]);this.fire("locationfound",c)}})}(window,document),define("text!modules/map/templates/PopupTemplate.hbs",[],function(){return'\n\n<div id="PopupTemplate" class="PopupTemplate">\n    <p class="location"><strong>{{location}}</strong></p>\n    <p><span class="title">Services:</span> <span class="dot green-dot">{{servicesOKLength}}</span> <span class="dot red-dot">{{servicesKOLength}}</span></p>\n    <p><span class="title">Apis:</span> <span class="dot green-dot">{{apiOKLength}}</span> <span class="dot red-dot">{{apiKOLength}}</span></p>\n</div>\n'}),define("modules/map/views/UiMarker",["require","marionette","leaflet","text!./../templates/PopupTemplate.hbs"],function(t){"use strict";var e=t("marionette"),i=t("leaflet");return e.Object.extend({popupTemplate:t("text!./../templates/PopupTemplate.hbs"),initialize:function(t){var e=i.Icon.extend({options:{number:t.agentsLength,shadowUrl:"static_files/images/marker-shadow.png",iconSize:new i.Point(30,42),shadowSize:new i.Point(30,42),iconAnchor:new i.Point(15,42),popupAnchor:new i.Point(0,-45),shadowAnchor:new i.Point(10,42),className:"leaflet-div-icon"},createIcon:function(){var t=document.createElement("div"),e=this._createImg(this.options.iconUrl),i=document.createElement("div");return i.setAttribute("class","number"),i.innerHTML=this.options.number||"",t.appendChild(e),t.appendChild(i),this._setIconStyles(t,"icon"),t},createShadow:function(){var t=document.createElement("div"),e=this._createImg(this.options.shadowUrl);return t.appendChild(e),this._setIconStyles(t,"shadow"),t}});this.markerIcon=new e(t.servicesKO?{iconUrl:"static_files/images/markerRed.png"}:t.apiKO?{iconUrl:"static_files/images/markerYellow.png"}:{iconUrl:"static_files/images/markerGreen.png"}),0===t.apiLength&&(this.markerIcon=new e({iconUrl:"static_files/images/markerGrey.png"})),this.markerActiveIcon=new e({iconUrl:"static_files/images/marker-active.png"})},getMarker:function(t){return this.marker=i.marker(t,{icon:this.markerIcon}),this.marker},getPopupContent:function(t){return this.renderTemplate(this.popupTemplate,t)}})}),function(t){function e(t,e,i){switch(arguments.length){case 2:return null!=t?t:e;case 3:return null!=t?t:null!=e?e:i;default:throw new Error("Implement me")}}function i(t,e){return Me.call(t,e)}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(t){Te.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function o(t,e){var i=!0;return f(function(){return i&&(r(t),i=!1),e.apply(this,arguments)},e)}function a(t,e){vi[t]||(r(e),vi[t]=!0)}function s(t,e){return function(i){return E(t.call(this,i),e)}}function h(t,e){return function(i){return this.localeData().ordinal(t.call(this,i),e)}}function l(t,e){var i,n,r=12*(e.year()-t.year())+(e.month()-t.month()),o=t.clone().add(r,"months");return 0>e-o?(i=t.clone().add(r-1,"months"),n=(e-o)/(o-i)):(i=t.clone().add(r+1,"months"),n=(e-o)/(i-o)),-(r+n)}function c(t,e,i){var n;return null==i?e:null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?(n=t.isPM(i),n&&12>e&&(e+=12),n||12!==e||(e=0),e):e}function u(){}function d(t,e){e!==!1&&k(t),m(this,t),this._d=new Date(+t._d),_i===!1&&(_i=!0,Te.updateOffset(this),_i=!1)}function p(t){var e=H(t),i=e.year||0,n=e.quarter||0,r=e.month||0,o=e.week||0,a=e.day||0,s=e.hour||0,h=e.minute||0,l=e.second||0,c=e.millisecond||0;this._milliseconds=+c+1e3*l+6e4*h+36e5*s,this._days=+a+7*o,this._months=+r+3*n+12*i,this._data={},this._locale=Te.localeData(),this._bubble()}function f(t,e){for(var n in e)i(e,n)&&(t[n]=e[n]);return i(e,"toString")&&(t.toString=e.toString),i(e,"valueOf")&&(t.valueOf=e.valueOf),t}function m(t,e){var i,n,r;if("undefined"!=typeof e._isAMomentObject&&(t._isAMomentObject=e._isAMomentObject),"undefined"!=typeof e._i&&(t._i=e._i),"undefined"!=typeof e._f&&(t._f=e._f),"undefined"!=typeof e._l&&(t._l=e._l),"undefined"!=typeof e._strict&&(t._strict=e._strict),"undefined"!=typeof e._tzm&&(t._tzm=e._tzm),"undefined"!=typeof e._isUTC&&(t._isUTC=e._isUTC),"undefined"!=typeof e._offset&&(t._offset=e._offset),"undefined"!=typeof e._pf&&(t._pf=e._pf),"undefined"!=typeof e._locale&&(t._locale=e._locale),Be.length>0)for(i in Be)n=Be[i],r=e[n],"undefined"!=typeof r&&(t[n]=r);return t}function g(t){return 0>t?Math.ceil(t):Math.floor(t)}function E(t,e,i){for(var n=""+Math.abs(t),r=t>=0;n.length<e;)n="0"+n;return(r?i?"+":"":"-")+n}function v(t,e){var i={milliseconds:0,months:0};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function y(t,e){var i;return e=U(e,t),t.isBefore(e)?i=v(t,e):(i=v(e,t),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function _(t,e){return function(i,n){var r,o;return null===n||isNaN(+n)||(a(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),o=i,i=n,n=o),i="string"==typeof i?+i:i,r=Te.duration(i,n),T(this,r,t),this}}function T(t,e,i,n){var r=e._milliseconds,o=e._days,a=e._months;n=null==n?!0:n,r&&t._d.setTime(+t._d+r*i),o&&me(t,"Date",fe(t,"Date")+o*i),a&&pe(t,fe(t,"Month")+a*i),n&&Te.updateOffset(t,o||a)}function x(t){return"[object Array]"===Object.prototype.toString.call(t)}function b(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function R(t,e,i){var n,r=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),a=0;for(n=0;r>n;n++)(i&&t[n]!==e[n]||!i&&S(t[n])!==S(e[n]))&&a++;return a+o}function w(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=ui[t]||di[e]||e}return t}function H(t){var e,n,r={};for(n in t)i(t,n)&&(e=w(n),e&&(r[e]=t[n]));return r}function M(e){var i,n;if(0===e.indexOf("week"))i=7,n="day";else{if(0!==e.indexOf("month"))return;i=12,n="month"}Te[e]=function(r,o){var a,s,h=Te._locale[e],l=[];if("number"==typeof r&&(o=r,r=t),s=function(t){var e=Te().utc().set(n,t);return h.call(Te._locale,e,r||"")},null!=o)return s(o);for(a=0;i>a;a++)l.push(s(a));return l}}function S(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=e>=0?Math.floor(e):Math.ceil(e)),i}function C(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function L(t,e,i){return le(Te([t,11,31+e-i]),e,i).week}function A(t){return P(t)?366:365}function P(t){return t%4===0&&t%100!==0||t%400===0}function k(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[Ce]<0||t._a[Ce]>11?Ce:t._a[Le]<1||t._a[Le]>C(t._a[Se],t._a[Ce])?Le:t._a[Ae]<0||t._a[Ae]>24||24===t._a[Ae]&&(0!==t._a[Pe]||0!==t._a[ke]||0!==t._a[De])?Ae:t._a[Pe]<0||t._a[Pe]>59?Pe:t._a[ke]<0||t._a[ke]>59?ke:t._a[De]<0||t._a[De]>999?De:-1,t._pf._overflowDayOfYear&&(Se>e||e>Le)&&(e=Le),t._pf.overflow=e)}function D(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length&&e._pf.bigHour===t)),e._isValid}function O(t){return t?t.toLowerCase().replace("_","-"):t}function B(t){for(var e,i,n,r,o=0;o<t.length;){for(r=O(t[o]).split("-"),e=r.length,i=O(t[o+1]),i=i?i.split("-"):null;e>0;){if(n=N(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&R(r,i,!0)>=e-1)break;e--}o++}return null}function N(t){var e=null;if(!Oe[t]&&Ne)try{e=Te.locale(),require("./locale/"+t),Te.locale(e)}catch(i){}return Oe[t]}function U(t,e){var i,n;return e._isUTC?(i=e.clone(),n=(Te.isMoment(t)||b(t)?+t:+Te(t))-+i,i._d.setTime(+i._d+n),Te.updateOffset(i,!1),i):Te(t).local()}function F(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function V(t){var e,i,n=t.match(ze);for(e=0,i=n.length;i>e;e++)n[e]=Ei[n[e]]?Ei[n[e]]:F(n[e]);return function(r){var o="";for(e=0;i>e;e++)o+=n[e]instanceof Function?n[e].call(r,t):n[e];return o}}function z(t,e){return t.isValid()?(e=I(e,t.localeData()),pi[e]||(pi[e]=V(e)),pi[e](t)):t.localeData().invalidDate()}function I(t,e){function i(t){return e.longDateFormat(t)||t}var n=5;for(Ie.lastIndex=0;n>=0&&Ie.test(t);)t=t.replace(Ie,i),Ie.lastIndex=0,n-=1;return t}function j(t,e){var i,n=e._strict;switch(t){case"Q":return Qe;case"DDDD":return ei;case"YYYY":case"GGGG":case"gggg":return n?ii:We;case"Y":case"G":case"g":return ri;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?ni:qe;case"S":if(n)return Qe;case"SS":if(n)return ti;case"SSS":if(n)return ei;case"DDD":return Ge;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ye;case"a":case"A":return e._locale._meridiemParse;case"x":return Ke;case"X":return Je;case"Z":case"ZZ":return $e;case"T":return Ze;case"SSSS":return Xe;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?ti:je;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return je;case"Do":return n?e._locale._ordinalParse:e._locale._ordinalParseLenient;default:return i=new RegExp(J(K(t.replace("\\","")),"i"))}}function G(t){t=t||"";var e=t.match($e)||[],i=e[e.length-1]||[],n=(i+"").match(li)||["-",0,0],r=+(60*n[1])+S(n[2]);return"+"===n[0]?r:-r}function W(t,e,i){var n,r=i._a;switch(t){case"Q":null!=e&&(r[Ce]=3*(S(e)-1));break;case"M":case"MM":null!=e&&(r[Ce]=S(e)-1);break;case"MMM":case"MMMM":n=i._locale.monthsParse(e,t,i._strict),null!=n?r[Ce]=n:i._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(r[Le]=S(e));break;case"Do":null!=e&&(r[Le]=S(parseInt(e.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=e&&(i._dayOfYear=S(e));break;case"YY":r[Se]=Te.parseTwoDigitYear(e);break;case"YYYY":case"YYYYY":case"YYYYYY":r[Se]=S(e);break;case"a":case"A":i._meridiem=e;break;case"h":case"hh":i._pf.bigHour=!0;case"H":case"HH":r[Ae]=S(e);break;case"m":case"mm":r[Pe]=S(e);break;case"s":case"ss":r[ke]=S(e);break;case"S":case"SS":case"SSS":case"SSSS":r[De]=S(1e3*("0."+e));break;case"x":i._d=new Date(S(e));break;case"X":i._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=G(e);break;case"dd":case"ddd":case"dddd":n=i._locale.weekdaysParse(e),null!=n?(i._w=i._w||{},i._w.d=n):i._pf.invalidWeekday=e;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(i._w=i._w||{},i._w[t]=S(e));break;case"gg":case"GG":i._w=i._w||{},i._w[t]=Te.parseTwoDigitYear(e)}}function q(t){var i,n,r,o,a,s,h;i=t._w,null!=i.GG||null!=i.W||null!=i.E?(a=1,s=4,n=e(i.GG,t._a[Se],le(Te(),1,4).year),r=e(i.W,1),o=e(i.E,1)):(a=t._locale._week.dow,s=t._locale._week.doy,n=e(i.gg,t._a[Se],le(Te(),a,s).year),r=e(i.w,1),null!=i.d?(o=i.d,a>o&&++r):o=null!=i.e?i.e+a:a),h=ce(n,r,o,s,a),t._a[Se]=h.year,t._dayOfYear=h.dayOfYear}function X(t){var i,n,r,o,a=[];if(!t._d){for(r=$(t),t._w&&null==t._a[Le]&&null==t._a[Ce]&&q(t),t._dayOfYear&&(o=e(t._a[Se],r[Se]),t._dayOfYear>A(o)&&(t._pf._overflowDayOfYear=!0),n=oe(o,0,t._dayOfYear),t._a[Ce]=n.getUTCMonth(),t._a[Le]=n.getUTCDate()),i=0;3>i&&null==t._a[i];++i)t._a[i]=a[i]=r[i];for(;7>i;i++)t._a[i]=a[i]=null==t._a[i]?2===i?1:0:t._a[i];
24===t._a[Ae]&&0===t._a[Pe]&&0===t._a[ke]&&0===t._a[De]&&(t._nextDay=!0,t._a[Ae]=0),t._d=(t._useUTC?oe:re).apply(null,a),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ae]=24)}}function Y(t){var e;t._d||(e=H(t._i),t._a=[e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],X(t))}function $(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Z(e){if(e._f===Te.ISO_8601)return void te(e);e._a=[],e._pf.empty=!0;var i,n,r,o,a,s=""+e._i,h=s.length,l=0;for(r=I(e._f,e._locale).match(ze)||[],i=0;i<r.length;i++)o=r[i],n=(s.match(j(o,e))||[])[0],n&&(a=s.substr(0,s.indexOf(n)),a.length>0&&e._pf.unusedInput.push(a),s=s.slice(s.indexOf(n)+n.length),l+=n.length),Ei[o]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(o),W(o,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(o);e._pf.charsLeftOver=h-l,s.length>0&&e._pf.unusedInput.push(s),e._pf.bigHour===!0&&e._a[Ae]<=12&&(e._pf.bigHour=t),e._a[Ae]=c(e._locale,e._a[Ae],e._meridiem),X(e),k(e)}function K(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,r){return e||i||n||r})}function J(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(t){var e,i,r,o,a;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(0/0));for(o=0;o<t._f.length;o++)a=0,e=m({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._pf=n(),e._f=t._f[o],Z(e),D(e)&&(a+=e._pf.charsLeftOver,a+=10*e._pf.unusedTokens.length,e._pf.score=a,(null==r||r>a)&&(r=a,i=e));f(t,i||e)}function te(t){var e,i,n=t._i,r=oi.exec(n);if(r){for(t._pf.iso=!0,e=0,i=si.length;i>e;e++)if(si[e][1].exec(n)){t._f=si[e][0]+(r[6]||" ");break}for(e=0,i=hi.length;i>e;e++)if(hi[e][1].exec(n)){t._f+=hi[e][0];break}n.match($e)&&(t._f+="Z"),Z(t)}else t._isValid=!1}function ee(t){te(t),t._isValid===!1&&(delete t._isValid,Te.createFromInputFallback(t))}function ie(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function ne(e){var i,n=e._i;n===t?e._d=new Date:b(n)?e._d=new Date(+n):null!==(i=Ue.exec(n))?e._d=new Date(+i[1]):"string"==typeof n?ee(e):x(n)?(e._a=ie(n.slice(0),function(t){return parseInt(t,10)}),X(e)):"object"==typeof n?Y(e):"number"==typeof n?e._d=new Date(n):Te.createFromInputFallback(e)}function re(t,e,i,n,r,o,a){var s=new Date(t,e,i,n,r,o,a);return 1970>t&&s.setFullYear(t),s}function oe(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function ae(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function se(t,e,i,n,r){return r.relativeTime(e||1,!!i,t,n)}function he(t,e,i){var n=Te.duration(t).abs(),r=He(n.as("s")),o=He(n.as("m")),a=He(n.as("h")),s=He(n.as("d")),h=He(n.as("M")),l=He(n.as("y")),c=r<fi.s&&["s",r]||1===o&&["m"]||o<fi.m&&["mm",o]||1===a&&["h"]||a<fi.h&&["hh",a]||1===s&&["d"]||s<fi.d&&["dd",s]||1===h&&["M"]||h<fi.M&&["MM",h]||1===l&&["y"]||["yy",l];return c[2]=e,c[3]=+t>0,c[4]=i,se.apply({},c)}function le(t,e,i){var n,r=i-e,o=i-t.day();return o>r&&(o-=7),r-7>o&&(o+=7),n=Te(t).add(o,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function ce(t,e,i,n,r){var o,a,s=oe(t,0,1).getUTCDay();return s=0===s?7:s,i=null!=i?i:r,o=r-s+(s>n?7:0)-(r>s?7:0),a=7*(e-1)+(i-r)+o+1,{year:a>0?t:t-1,dayOfYear:a>0?a:A(t-1)+a}}function ue(e){var i,n=e._i,r=e._f;return e._locale=e._locale||Te.localeData(e._l),null===n||r===t&&""===n?Te.invalid({nullInput:!0}):("string"==typeof n&&(e._i=n=e._locale.preparse(n)),Te.isMoment(n)?new d(n,!0):(r?x(r)?Q(e):Z(e):ne(e),i=new d(e),i._nextDay&&(i.add(1,"d"),i._nextDay=t),i))}function de(t,e){var i,n;if(1===e.length&&x(e[0])&&(e=e[0]),!e.length)return Te();for(i=e[0],n=1;n<e.length;++n)e[n][t](i)&&(i=e[n]);return i}function pe(t,e){var i;return"string"==typeof e&&(e=t.localeData().monthsParse(e),"number"!=typeof e)?t:(i=Math.min(t.date(),C(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t)}function fe(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function me(t,e,i){return"Month"===e?pe(t,i):t._d["set"+(t._isUTC?"UTC":"")+e](i)}function ge(t,e){return function(i){return null!=i?(me(this,t,i),Te.updateOffset(this,e),this):fe(this,t)}}function Ee(t){return 400*t/146097}function ve(t){return 146097*t/400}function ye(t){Te.duration.fn[t]=function(){return this._data[t]}}function _e(t){"undefined"==typeof ender&&(xe=we.moment,we.moment=t?o("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",Te):Te)}for(var Te,xe,be,Re="2.9.0",we="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,He=Math.round,Me=Object.prototype.hasOwnProperty,Se=0,Ce=1,Le=2,Ae=3,Pe=4,ke=5,De=6,Oe={},Be=[],Ne="undefined"!=typeof module&&module&&module.exports,Ue=/^\/?Date\((\-?\d+)/i,Fe=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ve=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ze=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Ie=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,je=/\d\d?/,Ge=/\d{1,3}/,We=/\d{1,4}/,qe=/[+\-]?\d{1,6}/,Xe=/\d+/,Ye=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,$e=/Z|[\+\-]\d\d:?\d\d/gi,Ze=/T/i,Ke=/[\+\-]?\d+/,Je=/[\+\-]?\d+(\.\d{1,3})?/,Qe=/\d/,ti=/\d\d/,ei=/\d{3}/,ii=/\d{4}/,ni=/[+-]?\d{6}/,ri=/[+-]?\d+/,oi=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ai="YYYY-MM-DDTHH:mm:ssZ",si=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],hi=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],li=/([\+\-]|\d\d)/gi,ci=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ui={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},di={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},pi={},fi={s:45,m:45,h:22,d:26,M:11},mi="DDD w W M D d".split(" "),gi="M D H h m s w W".split(" "),Ei={M:function(){return this.month()+1},MMM:function(t){return this.localeData().monthsShort(this,t)},MMMM:function(t){return this.localeData().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.localeData().weekdaysMin(this,t)},ddd:function(t){return this.localeData().weekdaysShort(this,t)},dddd:function(t){return this.localeData().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return E(this.year()%100,2)},YYYY:function(){return E(this.year(),4)},YYYYY:function(){return E(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+E(Math.abs(t),6)},gg:function(){return E(this.weekYear()%100,2)},gggg:function(){return E(this.weekYear(),4)},ggggg:function(){return E(this.weekYear(),5)},GG:function(){return E(this.isoWeekYear()%100,2)},GGGG:function(){return E(this.isoWeekYear(),4)},GGGGG:function(){return E(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return S(this.milliseconds()/100)},SS:function(){return E(S(this.milliseconds()/10),2)},SSS:function(){return E(this.milliseconds(),3)},SSSS:function(){return E(this.milliseconds(),3)},Z:function(){var t=this.utcOffset(),e="+";return 0>t&&(t=-t,e="-"),e+E(S(t/60),2)+":"+E(S(t)%60,2)},ZZ:function(){var t=this.utcOffset(),e="+";return 0>t&&(t=-t,e="-"),e+E(S(t/60),2)+E(S(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},vi={},yi=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],_i=!1;mi.length;)be=mi.pop(),Ei[be+"o"]=h(Ei[be],be);for(;gi.length;)be=gi.pop(),Ei[be+be]=s(Ei[be],2);Ei.DDDD=s(Ei.DDD,3),f(u.prototype,{set:function(t){var e,i;for(i in t)e=t[i],"function"==typeof e?this[i]=e:this["_"+i]=e;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t,e,i){var n,r,o;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;12>n;n++){if(r=Te.utc([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(i=Te([2e3,1]).day(e),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[e]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e,i){var n=this._calendar[t];return"function"==typeof n?n.apply(e,[i]):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,i,n){var r=this._relativeTime[i];return"function"==typeof r?r(t,e,i,n):r.replace(/%d/i,t)},pastFuture:function(t,e){var i=this._relativeTime[t>0?"future":"past"];return"function"==typeof i?i(e):i.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(t){return t},postformat:function(t){return t},week:function(t){return le(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),Te=function(e,i,r,o){var a;return"boolean"==typeof r&&(o=r,r=t),a={},a._isAMomentObject=!0,a._i=e,a._f=i,a._l=r,a._strict=o,a._isUTC=!1,a._pf=n(),ue(a)},Te.suppressDeprecationWarnings=!1,Te.createFromInputFallback=o("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),Te.min=function(){var t=[].slice.call(arguments,0);return de("isBefore",t)},Te.max=function(){var t=[].slice.call(arguments,0);return de("isAfter",t)},Te.utc=function(e,i,r,o){var a;return"boolean"==typeof r&&(o=r,r=t),a={},a._isAMomentObject=!0,a._useUTC=!0,a._isUTC=!0,a._l=r,a._i=e,a._f=i,a._strict=o,a._pf=n(),ue(a).utc()},Te.unix=function(t){return Te(1e3*t)},Te.duration=function(t,e){var n,r,o,a,s=t,h=null;return Te.isDuration(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(s={},e?s[e]=t:s.milliseconds=t):(h=Fe.exec(t))?(n="-"===h[1]?-1:1,s={y:0,d:S(h[Le])*n,h:S(h[Ae])*n,m:S(h[Pe])*n,s:S(h[ke])*n,ms:S(h[De])*n}):(h=Ve.exec(t))?(n="-"===h[1]?-1:1,o=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n},s={y:o(h[2]),M:o(h[3]),d:o(h[4]),h:o(h[5]),m:o(h[6]),s:o(h[7]),w:o(h[8])}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(a=y(Te(s.from),Te(s.to)),s={},s.ms=a.milliseconds,s.M=a.months),r=new p(s),Te.isDuration(t)&&i(t,"_locale")&&(r._locale=t._locale),r},Te.version=Re,Te.defaultFormat=ai,Te.ISO_8601=function(){},Te.momentProperties=Be,Te.updateOffset=function(){},Te.relativeTimeThreshold=function(e,i){return fi[e]===t?!1:i===t?fi[e]:(fi[e]=i,!0)},Te.lang=o("moment.lang is deprecated. Use moment.locale instead.",function(t,e){return Te.locale(t,e)}),Te.locale=function(t,e){var i;return t&&(i="undefined"!=typeof e?Te.defineLocale(t,e):Te.localeData(t),i&&(Te.duration._locale=Te._locale=i)),Te._locale._abbr},Te.defineLocale=function(t,e){return null!==e?(e.abbr=t,Oe[t]||(Oe[t]=new u),Oe[t].set(e),Te.locale(t),Oe[t]):(delete Oe[t],null)},Te.langData=o("moment.langData is deprecated. Use moment.localeData instead.",function(t){return Te.localeData(t)}),Te.localeData=function(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Te._locale;if(!x(t)){if(e=N(t))return e;t=[t]}return B(t)},Te.isMoment=function(t){return t instanceof d||null!=t&&i(t,"_isAMomentObject")},Te.isDuration=function(t){return t instanceof p};for(be=yi.length-1;be>=0;--be)M(yi[be]);Te.normalizeUnits=function(t){return w(t)},Te.invalid=function(t){var e=Te.utc(0/0);return null!=t?f(e._pf,t):e._pf.userInvalidated=!0,e},Te.parseZone=function(){return Te.apply(null,arguments).parseZone()},Te.parseTwoDigitYear=function(t){return S(t)+(S(t)>68?1900:2e3)},Te.isDate=b,f(Te.fn=d.prototype,{clone:function(){return Te(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var t=Te(this).utc();return 0<t.year()&&t.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():z(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):z(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return D(this)},isDSTShifted:function(){return this._a?this.isValid()&&R(this._a,(this._isUTC?Te.utc(this._a):Te(this._a)).toArray())>0:!1},parsingFlags:function(){return f({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(t){return this.utcOffset(0,t)},local:function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(t){var e=z(this,t||Te.defaultFormat);return this.localeData().postformat(e)},add:_(1,"add"),subtract:_(-1,"subtract"),diff:function(t,e,i){var n,r,o=U(t,this),a=6e4*(o.utcOffset()-this.utcOffset());return e=w(e),"year"===e||"month"===e||"quarter"===e?(r=l(this,o),"quarter"===e?r/=3:"year"===e&&(r/=12)):(n=this-o,r="second"===e?n/1e3:"minute"===e?n/6e4:"hour"===e?n/36e5:"day"===e?(n-a)/864e5:"week"===e?(n-a)/6048e5:n),i?r:g(r)},from:function(t,e){return Te.duration({to:this,from:t}).locale(this.locale()).humanize(!e)},fromNow:function(t){return this.from(Te(),t)},calendar:function(t){var e=t||Te(),i=U(e,this).startOf("day"),n=this.diff(i,"days",!0),r=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,Te(e)))},isLeapYear:function(){return P(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=ae(t,this.localeData()),this.add(t-e,"d")):e},month:ge("Month",!0),startOf:function(t){switch(t=w(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=w(e),e===t||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(t,e){var i;return e=w("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=Te.isMoment(t)?t:Te(t),+this>+t):(i=Te.isMoment(t)?+t:+Te(t),i<+this.clone().startOf(e))},isBefore:function(t,e){var i;return e=w("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=Te.isMoment(t)?t:Te(t),+t>+this):(i=Te.isMoment(t)?+t:+Te(t),+this.clone().endOf(e)<i)},isBetween:function(t,e,i){return this.isAfter(t,i)&&this.isBefore(e,i)},isSame:function(t,e){var i;return e=w(e||"millisecond"),"millisecond"===e?(t=Te.isMoment(t)?t:Te(t),+this===+t):(i=+Te(t),+this.clone().startOf(e)<=i&&i<=+this.clone().endOf(e))},min:o("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=Te.apply(null,arguments),this>t?this:t}),max:o("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=Te.apply(null,arguments),t>this?this:t}),zone:o("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),utcOffset:function(t,e){var i,n=this._offset||0;return null!=t?("string"==typeof t&&(t=G(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&e&&(i=this._dateUtcOffset()),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?T(this,Te.duration(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Te.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?n:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(G(this._i)),this},hasAlignedHourOffset:function(t){return t=t?Te(t).utcOffset():0,(this.utcOffset()-t)%60===0},daysInMonth:function(){return C(this.year(),this.month())},dayOfYear:function(t){var e=He((Te(this).startOf("day")-Te(this).startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},quarter:function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},weekYear:function(t){var e=le(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")},isoWeekYear:function(t){var e=le(this,1,4).year;return null==t?e:this.add(t-e,"y")},week:function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},isoWeek:function(t){var e=le(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},weekday:function(t){var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},isoWeeksInYear:function(){return L(this.year(),1,4)},weeksInYear:function(){var t=this.localeData()._week;return L(this.year(),t.dow,t.doy)},get:function(t){return t=w(t),this[t]()},set:function(t,e){var i;if("object"==typeof t)for(i in t)this.set(i,t[i]);else t=w(t),"function"==typeof this[t]&&this[t](e);return this},locale:function(e){var i;return e===t?this._locale._abbr:(i=Te.localeData(e),null!=i&&(this._locale=i),this)},lang:o("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===t?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),Te.fn.millisecond=Te.fn.milliseconds=ge("Milliseconds",!1),Te.fn.second=Te.fn.seconds=ge("Seconds",!1),Te.fn.minute=Te.fn.minutes=ge("Minutes",!1),Te.fn.hour=Te.fn.hours=ge("Hours",!0),Te.fn.date=ge("Date",!0),Te.fn.dates=o("dates accessor is deprecated. Use date instead.",ge("Date",!0)),Te.fn.year=ge("FullYear",!0),Te.fn.years=o("years accessor is deprecated. Use year instead.",ge("FullYear",!0)),Te.fn.days=Te.fn.day,Te.fn.months=Te.fn.month,Te.fn.weeks=Te.fn.week,Te.fn.isoWeeks=Te.fn.isoWeek,Te.fn.quarters=Te.fn.quarter,Te.fn.toJSON=Te.fn.toISOString,Te.fn.isUTC=Te.fn.isUtc,f(Te.duration.fn=p.prototype,{_bubble:function(){var t,e,i,n=this._milliseconds,r=this._days,o=this._months,a=this._data,s=0;a.milliseconds=n%1e3,t=g(n/1e3),a.seconds=t%60,e=g(t/60),a.minutes=e%60,i=g(e/60),a.hours=i%24,r+=g(i/24),s=g(Ee(r)),r-=g(ve(s)),o+=g(r/30),r%=30,s+=g(o/12),o%=12,a.days=r,a.months=o,a.years=s},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return g(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*S(this._months/12)},humanize:function(t){var e=he(this,!t,this.localeData());return t&&(e=this.localeData().pastFuture(+this,e)),this.localeData().postformat(e)},add:function(t,e){var i=Te.duration(t,e);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(t,e){var i=Te.duration(t,e);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(t){return t=w(t),this[t.toLowerCase()+"s"]()},as:function(t){var e,i;if(t=w(t),"month"===t||"year"===t)return e=this._days+this._milliseconds/864e5,i=this._months+12*Ee(e),"month"===t?i:i/12;switch(e=this._days+Math.round(ve(this._months/12)),t){case"week":return e/7+this._milliseconds/6048e5;case"day":return e+this._milliseconds/864e5;case"hour":return 24*e+this._milliseconds/36e5;case"minute":return 24*e*60+this._milliseconds/6e4;case"second":return 24*e*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*e*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+t)}},lang:Te.fn.lang,locale:Te.fn.locale,toIsoString:o("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(i?i+"D":"")+(n||r||o?"T":"")+(n?n+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),Te.duration.fn.toString=Te.duration.fn.toISOString;for(be in ci)i(ci,be)&&ye(be.toLowerCase());Te.duration.fn.asMilliseconds=function(){return this.as("ms")},Te.duration.fn.asSeconds=function(){return this.as("s")},Te.duration.fn.asMinutes=function(){return this.as("m")},Te.duration.fn.asHours=function(){return this.as("h")},Te.duration.fn.asDays=function(){return this.as("d")},Te.duration.fn.asWeeks=function(){return this.as("weeks")},Te.duration.fn.asMonths=function(){return this.as("M")},Te.duration.fn.asYears=function(){return this.as("y")},Te.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,i=1===S(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),Ne?module.exports=Te:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(t,e,i){return i.config&&i.config()&&i.config().noGlobal===!0&&(we.moment=xe),Te}),_e(!0)):_e()}.call(this),define("text!modules/map/templates/AgentsChildView.hbs",[],function(){return'<a href="#" class="toggle"><span class="icon-shareable"></span> {{name}} <span class="icon-chevron"></span> <span class="ring-uuid">{{uuid}}</span></a>\n<div class="container hidden">\n\n\n    <p class="date">last checked: {{lastChecked}}</p>\n    <p class="date">last updated: {{lastUpdated}}</p>\n\n\n\n\n    {{#each apis}}\n        <div class="api-wrapper">\n\n            {{#unless faulty}}\n                <span class="icon-vinyl icon-healthy"></span>\n            {{else}}\n                <span class="icon-vinyl icon-faulty"></span>\n            {{/unless}}\n            <span class="api-type">{{type}}</span>\n            <span class="api-path">{{path}}</span>\n            <span class="api-host">{{host}}:{{port}}</span>\n\n\n        </div>\n    {{/each}}\n\n</div>\n'}),define("modules/map/views/AgentsChildView",["require","marionette","underscore","moment","text!./../templates/AgentsChildView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("underscore"),n=t("moment");return e.ItemView.extend({template:t("text!./../templates/AgentsChildView.hbs"),tagName:"li",modelEvents:{change:"render"},ui:{container:".container",toggle:".toggle"},serializeData:function(){return i.extend(this.model.toJSON(),{lastChecked:n(this.model.get("lastChecked")).fromNow(),lastUpdated:n(this.model.get("lastUpdated")).fromNow()})},onRender:function(){this._initAccordion(),this.$el.hasClass("collapsed")&&$(this.ui.container).removeClass("hidden")},_onClickAccordion:function(t){t.preventDefault();var e=$(this.ui.container);e.slideToggle(),this.$el.toggleClass("collapsed")},_initAccordion:function(){this.ui.toggle.click(i.bind(this._onClickAccordion,this))}})}),define("text!modules/map/templates/AgentsCompositeView.hbs",[],function(){return'<ul id="agents"></ul>'}),define("modules/map/views/AgentsCompositeView",["require","marionette","./AgentsChildView","text!./../templates/AgentsCompositeView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("./AgentsChildView");return e.CompositeView.extend({template:t("text!./../templates/AgentsCompositeView.hbs"),className:"agents-wrapper",childView:i,childViewContainer:"#agents",collectionEvents:{add:function(){this.trigger("refresh")},remove:function(){this.trigger("refresh")}}})}),define("text!modules/map/templates/UiChildView.hbs",[],function(){return'<a href="#" class="toggle-this accordion-header"><span class="icon icon-share"></span> {{location.city}}, {{location.country}} <span class="icon-chevron"></span> <span class="ring-uuid">{{uuid}}</span></a>\n\n<div class="accordion-content">\n    <div class="agents-container"></div>\n\n</div>\n'}),define("modules/map/views/UiChildView",["require","marionette","underscore","./UiMarker","./AgentsCompositeView","text!./../templates/UiChildView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("underscore"),n=t("./UiMarker"),r=t("./AgentsCompositeView");return e.ItemView.extend({template:t("text!./../templates/UiChildView.hbs"),tagName:"li",ui:{agentscontainer:".agents-container",toggle:".toggle-this",contentdiv:".accordion-content",headerlink:".accordion-header"},events:{mouseover:"_itemHover",mouseout:"_itemOut",mousedown:"_itemClick","accordion.opened":"_setOpened","accordion.closed":"_setClosed"},initialize:function(){this.agentsView=new r({collection:this.model.get("agents")}).on("refresh",i.bind(this._refreshMarker,this))},_initMarkerIcons:function(){this.uiMarker=new n({agentsLength:this.model.get("agents").length,apiLength:i.flatten(this.model.get("agents").pluck("apis")).length,apiKO:i.pluck(i.flatten(this.model.get("agents").pluck("apis")),"faulty").indexOf(1)>-1,servicesKO:this.model.get("agents").pluck("faulty").indexOf(1)>-1}),this.markerIcon=this.uiMarker.markerIcon,this.markerActiveIcon=this.uiMarker.markerActiveIcon},addMarker:function(t){this.map=t,this._createMarker()},_createMarker:function(){this._initMarkerIcons(),this.marker=this.uiMarker.getMarker([this.model.get("location").gps.latitude,this.model.get("location").gps.longitude]),this.marker.on("mouseover",i.bind(this._markerOnHover,this)),this.marker.on("mouseout",i.bind(this._markerOnOut,this)),this.marker.on("click",i.bind(this._markerOnClick,this)),this.marker.addTo(this.map);var t=this._getMarkerPopup();this.marker.bindPopup(t,{closeButton:!1})},_removeMarker:function(){this.map.removeLayer(this.marker)},_refreshMarker:function(){this._removeMarker(),this._createMarker()},_getMarkerPopup:function(){var t={location:this.model.get("location").city+", "+this.model.get("location").country,servicesKOLength:i.compact(this.model.get("agents").pluck("faulty")).length,servicesOKLength:i.without(this.model.get("agents").pluck("faulty"),1).length,apiKOLength:i.compact(i.pluck(i.flatten(this.model.get("agents").pluck("apis")),"faulty")).length,apiOKLength:i.without(i.pluck(i.flatten(this.model.get("agents").pluck("apis")),"faulty"),!0).length};return this.uiMarker.getPopupContent(t)},_itemHover:function(){this.marker.setIcon(this.markerActiveIcon)},_itemOut:function(){this.isOpened||this.marker.setIcon(this.markerIcon)},_itemClick:function(){this.trigger("marker:click")},_markerOnHover:function(){this.marker.openPopup()},_markerOnOut:function(){this.marker.closePopup()},_markerOnClick:function(){this.isOpened?this._scrollToMe():($(this.ui.toggle).focus().trigger("click"),$(this.ui.headerlink).one("accordion.opened",i.bind(function(){this._scrollToMe()},this))),this.trigger("marker:click")},_scrollToMe:function(){this.$el.closest(".items-wrapper").scrollTo(this.$el,500,{easing:"linear"})},_setOpened:function(){this.isOpened=!0},_setClosed:function(){this.isOpened=!1},onRender:function(){this.agentsView.render(),$(this.ui.agentscontainer).html(this.agentsView.$el),this.trigger("refresh")},onDestroy:function(){this._removeMarker()}})}),define("text!modules/map/templates/UiCompositeView.hbs",[],function(){return'<header>\n    <h1>MSNOS</h1>\n\n    <p>MSNOS is a library built in order to mantain and survive a microservice based architecture :) Every microservice will surface spontaneously in a cloud, without the need of any application configuration.\n    <p>Released under the MIT License.<br><a href="https://github.com/workshare/ms-nos">https://github.com/workshare/ms-nos</a></p>\n\n    <p style="font-size:smaller;">Source code for this interface<br><a href="https://github.com/albinotonnina/ms-nos-frontend">https://github.com/albinotonnina/ms-nos-frontend</a> </p>\n</header>\n<ul id="items" class="accordion"></ul>'
}),function(t){return t.fn.exists=function(t){this.length&&t.apply(this)},this}(jQuery),define("jquery.exists",function(){}),define("accordion",["jquery","jquery.exists"],function(t){"use strict";var e={DEFAULTS:{animationSpeed:300,naturalBehavior:!1},cacheElements:function(){this.$accordion=t(".accordion"),this.$accordion_content=t(".accordion-content"),this.$accordion_header=t(".accordion-header"),this.$accordion_opened=t(".accordion-opened")},init:function(t){e.cacheElements(),e.$accordion.exists(function(){e.setOptions(t),e.addARIAlabels(),e.setupAccordion(),e.bindEvents(),e.openAccordionViaClass(),e.openAccordionViaHash()})},destroy:function(){e.unBindEvents(),delete e.$accordion},bindEvents:function(){this.$accordion_header.on("click",e.onClick),this.$accordion_header.on("keydown",e.onKeyDown)},unBindEvents:function(){this.$accordion_header&&(this.$accordion_header.off("click",e.onClick),this.$accordion_header.off("keydown",e.onKeyDown))},onClick:function(i){i.preventDefault(),e.closeAll(t(this)),e.toggleAccordion(t(this))},onKeyDown:function(i){32===i.keyCode&&(i.preventDefault(),e.toggleAccordion(t(this)))},setOptions:function(i){this.options=t.extend({},e.DEFAULTS,i)},setupAccordion:function(){this.$accordion.attr("role","tablist"),this.$accordion_content.attr("aria-expanded","false").attr("role","tabpanel").hide(),this.$accordion_header.attr("role","tab").attr("tabindex","0").attr("aria-selected","false"),this.$accordion.each(function(){t(this).trigger("accordion.initialized")})},addARIAlabels:function(){this.$accordion.each(function(e){var i=t(this),n=i.find(".accordion-header").attr("id","accordion-"+e),r=i.find(".accordion-content").attr("id","accordion-"+e);n.each(function(e){var i=t(this);i.attr("id",i.attr("id")+"-header-"+e).next().attr("id",i.next().attr("id")+"-content-"+e),i.attr("aria-controls",i.next().attr("id"))}),r.each(function(){var e=t(this);e.attr("aria-labelledby",e.prev().attr("id"))})})},closeAll:function(t){var e=t.closest(".accordion").find(".accordion-active");this.options.naturalBehavior&&!e.is(t)&&this.closeAccordion(e)},openAccordion:function(t){var i=t.next();t.attr("aria-selected","true").addClass("accordion-active"),i.attr("aria-expanded","true").attr("aria-hidden","false"),i.slideDown(e.options.animationSpeed,function(){t.trigger("accordion.opened",[t,i])})},closeAccordion:function(t){var i=t.next();t.attr("aria-selected","false").removeClass("accordion-active"),i.attr("aria-expanded","false").attr("aria-hidden","true"),i.slideUp(e.options.animationSpeed,function(){t.trigger("accordion.closed",[t,i])})},toggleAccordion:function(t){"false"===t.attr("aria-selected")?this.openAccordion(t):this.closeAccordion(t)},openAccordionViaHash:function(){window.location.hash&&t(window.location.hash).prev().trigger("click")},openAccordionViaClass:function(){this.$accordion_opened.exists(function(){e.$accordion_opened.each(function(){window.location.hash!="#"+this.id&&t(this).prev().trigger("click")})})}};return{init:e.init,destroy:e.destroy}}),define("modules/map/views/UiCompositeView",["require","marionette","underscore","./UiChildView","text!./../templates/UiCompositeView.hbs","accordion"],function(t){"use strict";var e=t("marionette"),i=t("underscore"),n=t("./UiChildView");return e.CompositeView.extend({template:t("text!./../templates/UiCompositeView.hbs"),className:"items-wrapper",childView:n,childViewContainer:"#items",initialize:function(e){this.accordion=t("accordion"),this.controller=e.controller,this.map=e.map,this.listenTo(this,"childview:marker:click",i.bind(this._markerClick,this)),this.listenTo(this,"childview:refresh",i.bind(this._initAccordion,this))},onAddChild:function(t){var e=t.model.get("location").gps;e&&t.addMarker(this.map)},_markerClick:function(t){t.marker.setIcon(t.markerActiveIcon),this.lastMarker&&this.lastMarker.setIcon(t.markerIcon),this.lastMarker=t.marker},onShow:function(){this._initAccordion()},_initAccordion:function(){setTimeout(i.bind(function(){this.accordion.destroy(),this.accordion.init({naturalBehavior:!0})},this),1)}})}),define("text!modules/map/templates/MapView.hbs",[],function(){return'<div id="map_canvas" class="mapView"></div>'}),define("modules/map/views/MapView",["require","marionette","leaflet","text!./../templates/MapView.hbs"],function(t){"use strict";var e=t("marionette"),i=t("leaflet");return e.ItemView.extend({template:t("text!./../templates/MapView.hbs"),className:"map-wrapper",ui:{map_canvas:"#map_canvas"},onShow:function(){this._initMap()},getMapObject:function(){return this.map||{}},_initMap:function(){this.map=i.map(this.ui.map_canvas.get(0),{center:[0,30],zoom:2,scrollWheelZoom:!1,worldCopyJump:!0}),i.tileLayer("https://{s}.tiles.mapbox.com/v4/{mapId}/{z}/{x}/{y}.png?access_token={token}",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',subdomains:["a","b","c","d"],mapId:"msnos.m3mi291g",token:"pk.eyJ1IjoibXNub3MiLCJhIjoiODZWbjFDWSJ9.w3qIikxygzbnPUiglLrvpA"}).addTo(this.map)}})}),define("text!modules/map/templates/IndexLayout.hbs",[],function(){return'<div id="ui-region"></div>\n<div id="map-region"></div>'}),define("modules/map/views/IndexLayout",["require","marionette","text!./../templates/IndexLayout.hbs"],function(t){"use strict";var e=t("marionette");return e.LayoutView.extend({id:"indexLayoutMap",className:"indexLayout",template:t("text!./../templates/IndexLayout.hbs"),regions:{uiRegion:"#ui-region",mapRegion:"#map-region"},ui:{map_canvas:"#map_canvas"},initialize:function(t){this.controller=t.controller},onShow:function(){this.mapView=this.controller.getMapView(),this.mapRegion.show(this.mapView),this.uiView=this.controller.getUiView(this.mapView.getMapObject()),this.uiRegion.show(this.uiView)},onRender:function(){$("html,body").css({overflow:"visible",height:"100%"})}})}),define("modules/map/models/AgentModel",["require","backbone"],function(t){"use strict";var e=t("backbone");return e.Model.extend({initialize:function(){},defaults:{},clear:function(){this.destroy()}})}),define("modules/map/collections/AgentsCollection",["require","backbone","../models/AgentModel"],function(t){"use strict";var e=t("backbone"),i=t("../models/AgentModel");return e.Collection.extend({model:i,addAgent:function(t){var e=new i(t);this.add(e)}})}),define("modules/map/models/RingModel",["require","backbone","../collections/AgentsCollection"],function(t){"use strict";var e=t("backbone"),i=t("../collections/AgentsCollection");return e.Model.extend({initialize:function(){this.agentsCollection=new i,this.set("agents",this.agentsCollection)},defaults:{uuid:void 0,name:void 0,location:{country:{name:"Ring"},city:{name:"Somewhere"}},agents:void 0},setAgent:function(t){var e=this.agentsCollection.findWhere({uuid:t.agent.iden.uuid}),i={uuid:t.agent.iden.uuid,name:t.name,faulty:t.faulty.value,apis:t.apis,lastUpdated:t.lastUpdated.value,lastChecked:t.lastChecked.value};e?e.set(i):this.agentsCollection.addAgent(i)},clear:function(){this.destroy()}})}),define("modules/map/collections/RingsCollection",["require","backbone","underscore","../models/RingModel"],function(t){"use strict";var e=t("backbone"),i=t("underscore"),n=t("../models/RingModel");return e.Collection.extend({model:n,addRings:function(t){var e=[];i.each(t,i.bind(function(t){var i=this.findWhere({uuid:t.agent.ring.uuid});if(i)i.setAgent(t),e.push(i);else{var r=new n(this._getSanitizedResponse(t));r.setAgent(t),this.add(r),e.push(r)}},this)),this._removeInvalidAgents(t),this.remove(i.difference(this.models,e))},_getSanitizedResponse:function(t){var e=Math.floor(40*Math.random())+1;return e*=1==Math.floor(2*Math.random())?1:-1,{uuid:t.agent.ring.uuid,location:{country:t.agent.ring.location.country?t.agent.ring.location.country.name:"location",city:t.agent.ring.location.city?t.agent.ring.location.city.name:"Undisclosed",gps:t.agent.ring.location.gps?t.agent.ring.location.gps:{latitude:-84,longitude:e}}}},_removeInvalidAgents:function(t){this.agentsUUids=i.pluck(i.pluck(i.pluck(t,"agent"),"iden"),"uuid"),this.each(i.bind(function(t){t.get("agents").each(i.bind(function(e){-1===this.agentsUUids.indexOf(e.get("uuid"))&&t.get("agents").remove(e)},this))},this))}})}),define("modules/map/models/MicroservicesModel",["require","backbone"],function(t){"use strict";var e=t("backbone");return e.Model.extend({initialize:function(){},defaults:{},clear:function(){this.destroy()}})}),define("modules/map/collections/MicroservicesCollection",["require","backbone","../models/MicroservicesModel"],function(t){"use strict";var e=t("backbone"),i=t("../models/MicroservicesModel");return e.Collection.extend({url:function(){return this.baseUrl?decodeURIComponent(this.baseUrl)+"/admin/microservices":"admin/microservices"},model:i,fetchData:function(t){var e=$.Deferred();return this.baseUrl=t,this.fetch().done(e.resolve),e.promise()}})}),define("modules/map/controller",["require","marionette","underscore","./views/UiCompositeView","./views/MapView","./views/IndexLayout","./collections/RingsCollection","./collections/MicroservicesCollection"],function(t){"use strict";var e=t("marionette"),i=t("underscore"),n=t("./views/UiCompositeView"),r=t("./views/MapView"),o=t("./views/IndexLayout"),a=t("./collections/RingsCollection"),s=t("./collections/MicroservicesCollection");return e.Object.extend({initialize:function(t){this.app=t.app,this.logger=t.logger,this.microservicesCollection=new s,this.ringsCollection=new a},index:function(t){this.baseUrl=decodeURIComponent((new RegExp("[?|&]url=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null,t&&t.url&&(this.baseUrl=t.url),this._fetchData(this.baseUrl).done(i.bind(this._initCollections,this)),setInterval(i.bind(this._refreshCollections,this),1e4)},_fetchData:function(t){return this.microservicesCollection.fetchData(t)},_refreshCollections:function(){this._fetchData(this.baseUrl).done(i.bind(this._generateRingsModels,this))},_generateRingsModels:function(t){this.ringsCollection.addRings(t)},_initCollections:function(t){this.ringsCollection.addRings(t),setTimeout(i.bind(function(){this._initIndexLayout()},this),1e3)},_initIndexLayout:function(){var t=new o({controller:this});this.app.container.show(t)},getUiView:function(t){return this.uiView=new n({controller:this,collection:this.ringsCollection,map:t}),this.uiView},getMapView:function(){return this.mapView=new r({controller:this}),this.mapView}})}),define("modules/map/router",["require","marionette"],function(t){"use strict";var e=t("marionette"),i=e.AppRouter.extend({appRoutes:{map:"index"}});return i}),define("modules/map/module",["require","./controller","./router"],function(t){"use strict";var e=t("./controller"),i=t("./router");return function(t){t.module("map",function(){this.logger=t.lumberman.getLogger("map");var n=this.controller=new e({app:t,logger:this.logger}),r=this.router=new i({controller:this.controller});t.commands.setHandler("navigate:map",function(t){n.index(t),r.navigate("map")})})}}),define("autoload/modules",["require","modules/home/module","modules/map/module"],function(t){"use strict";return function(e){t("modules/home/module")(e),t("modules/map/module")(e)}}),define("app",["require","backbone","marionette","autoload/vendors","autoload/plugins","autoload/modules"],function(t){"use strict";var e=t("backbone"),i=t("marionette"),n=window.app=new i.Application;return t("autoload/vendors")(n),t("autoload/plugins")(n),t("autoload/modules")(n),n.addRegions({container:"#container"}),n.on("start",function(t){var i="home";window.location.hash&&(i=window.location.hash.substr(1)),e.history.start({pushState:t.pushState})||e.history.navigate(i,{trigger:!0})}),n}),require(["app"],function(t){"use strict";t.start(window.application)}),define("bootstrap",function(){});